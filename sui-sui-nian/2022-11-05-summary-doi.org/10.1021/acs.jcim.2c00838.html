<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>文献总结｜使用强化学习和基于图的深度生成模型进行从头药物设计</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="https://leonis.cc/sui-sui-nian/2022-11-05-summary-doi.org/10.1021/acs.jcim.2c00838.html" rel="canonical" />
  <!-- Feed -->
  <link href="https://leonis.cc/feed.xml" type="application/atom+xml" rel="alternate"
    title="Leo’s blog Full Atom Feed" />

  <link href="https://leonis.cc/theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- CSS specified by the user -->


  <link href="https://leonis.cc/theme/css/customize.css" type="text/css" rel="stylesheet" />


  <link href="https://leonis.cc/theme/css/plugins.css" type="text/css" rel="stylesheet" />


  <link href="https://leonis.cc/theme/css/lightgallery.min.css" type="text/css" rel="stylesheet" />


  <link href="https://leonis.cc/theme/css/bookshelf.css" type="text/css" rel="stylesheet" />


  <!-- font-awesome icons -->
  <link href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <!-- Custom fonts -->
  <link href="https://ik.imagekit.io/leonis/ChiuKongGothic-CL-w4/result.css?updatedAt=1700222744424" rel="stylesheet" />
  <link href="https://ik.imagekit.io/leonis/ChiuKongGothic-CL-w5/result.css?updatedAt=1700275749020" rel="stylesheet" />
  <link href="https://ik.imagekit.io/leonis/ChiuKongGothic-CL-w7/result.css?updatedAt=1700275854743" rel="stylesheet" />
  <link href="https://cdnjs.loli.net/ajax/libs/fontsource-fira-sans/5.0.19/400.min.css" rel="stylesheet" />
  <link href="https://cdnjs.loli.net/ajax/libs/fontsource-fira-sans/5.0.19/400-italic.min.css" rel="stylesheet" />
  <link href="https://cdnjs.loli.net/ajax/libs/fontsource-fira-sans/5.0.19/500.min.css" rel="stylesheet" />
  <link href="https://cdnjs.loli.net/ajax/libs/fontsource-fira-sans/5.0.19/500-italic.min.css" rel="stylesheet" />
  <link href="https://cdnjs.loli.net/ajax/libs/fontsource-fira-sans/5.0.19/700.min.css" rel="stylesheet" />
  <link href="https://cdnjs.loli.net/ajax/libs/fontsource-fira-sans/5.0.19/700-italic.min.css" rel="stylesheet" />
  <link href="https://cdnjs.loli.net/ajax/libs/fontsource-mononoki/5.0.7/400.min.css" rel="stylesheet" />
  <link href="https://cdnjs.loli.net/ajax/libs/fontsource-mononoki/5.0.7/400-italic.min.css" rel="stylesheet" />
  <link href="https://cdnjs.loli.net/ajax/libs/fontsource-mononoki/5.0.7/700.min.css" rel="stylesheet" />
  <link href="https://cdnjs.loli.net/ajax/libs/fontsource-mononoki/5.0.7/700-italic.min.css" rel="stylesheet" />
  <link href="https://cdnjs.loli.net/ajax/libs/fontsource-lato/5.0.19/400.min.css" rel="stylesheet" />
  <link href="https://ik.imagekit.io/leonis/AdvocateAncientSerifSC-Bold/result.css?updatedAt=1700289637334" rel="stylesheet" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->

  <script>
    var siteUrl = 'https://leonis.cc';
  </script>

  <script>
    var localTheme = localStorage.getItem('attila_theme');
    switch (localTheme) {
      case 'dark':
        document.documentElement.classList.add('theme-dark');
        break;
      case 'light':
        document.documentElement.classList.add('theme-light');
        break;
      default:
        break;
    }
  </script>







    <meta name="description" content="本文介绍于 2022 年发表在 Journal of Chemical Information and Modeling 上的一篇文章，文章原标题为 De Novo Drug Design Using Reinforcement Learning with...">

    <meta name="author" content="Leo">

    <meta name="tags" content="Literature Summary">
    <meta name="tags" content="CADD">
    <meta name="tags" content="GNN">
    <meta name="tags" content="RL">




<!-- Open Graph -->
<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="Leo’s blog"/>
<meta prefix="og: http://ogp.me/ns#" property="og:title" content="文献总结｜使用强化学习和基于图的深度生成模型进行从头药物设计"/>
<meta prefix="og: http://ogp.me/ns#" property="og:description" content="本文介绍于 2022 年发表在 Journal of Chemical Information and Modeling 上的一篇文章，文章原标题为 De Novo Drug Design Using Reinforcement Learning with..."/>
<meta prefix="og: http://ogp.me/ns#" property="og:locale" content="en_US"/>
<meta prefix="og: http://ogp.me/ns#" property="og:url" content="https://leonis.cc/sui-sui-nian/2022-11-05-summary-doi.org/10.1021/acs.jcim.2c00838.html"/>
<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article"/>
<meta prefix="og: http://ogp.me/ns#" property="article:published_time" content="2022-11-05 00:00:00+08:00"/>
<meta prefix="og: http://ogp.me/ns#" property="article:modified_time" content=""/>
<meta prefix="og: http://ogp.me/ns#" property="article:author" content="https://leonis.cc/author/leo.html">
<meta prefix="og: http://ogp.me/ns#" property="article:section" content="碎碎念"/>
<meta prefix="og: http://ogp.me/ns#" property="article:tag" content="Literature Summary"/>
<meta prefix="og: http://ogp.me/ns#" property="article:tag" content="CADD"/>
<meta prefix="og: http://ogp.me/ns#" property="article:tag" content="GNN"/>
<meta prefix="og: http://ogp.me/ns#" property="article:tag" content="RL"/>
<meta prefix="og: http://ogp.me/ns#" property="og:image" content="https://api.onedrive.com/v1.0/shares/s!AtseC45rsRhNwFfSnZ1Pc1osKbni/root/content">

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "文献总结｜使用强化学习和基于图的深度生成模型进行从头药物设计",
  "headline": "文献总结｜使用强化学习和基于图的深度生成模型进行从头药物设计",
  "datePublished": "2022-11-05 00:00:00+08:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Leo",
    "url": "https://leonis.cc/author/leo.html"
  },
  "image": "https://leonis.cc/https://api.onedrive.com/v1.0/shares/s!AtseC45rsRhNwFfSnZ1Pc1osKbni/root/content",
  "url": "https://leonis.cc/sui-sui-nian/2022-11-05-summary-doi.org/10.1021/acs.jcim.2c00838.html",
  "description": "本文介绍于 2022 年发表在 Journal of Chemical Information and Modeling 上的一篇文章，文章原标题为 De Novo Drug Design Using Reinforcement Learning with..."
}
</script>

<link href="https://npm.elemecdn.com/@waline/client@2.14.9/dist/waline.css" rel="stylesheet" />
<script src="https://npm.elemecdn.com/@waline/client@2.14.9/dist/waline.js"></script>

</head>









<body class="category-template">

<div class="nav-header">
  <nav class="nav-wrapper" aria-label="Main">
<ul>

    <li class="nav-Home " role="presentation"><a href="/"><span>Home</span></a></li>
    <li class="nav-碎碎唸 active" role="presentation"><a href="/category/sui-sui-nian.html"><span>碎碎唸</span></a></li>
    <li class="nav-故紙堆 " role="presentation"><a href="/category/gu-zhi-dui.html"><span>故紙堆</span></a></li>
    <li class="nav-在路上 " role="presentation"><a href="/category/zai-lu-shang.html"><span>在路上</span></a></li>
    <li class="nav-山牆邊 " role="presentation"><a href="/pages/shan-qiang-bian.html"><span>山牆邊</span></a></li>
    <li class="nav-破櫥簏 " role="presentation"><a href="https://neodb.social/users/Leo/"><span>破櫥簏</span></a></li>
    <li class="nav-Archives " role="presentation"><a href="/archives.html"><span>Archives</span></a></li>
    <li class="nav-Tags " role="presentation"><a href="/tags.html"><span>Tags</span></a></li>
    <li class="nav-About " role="presentation"><a href="/about.html"><span>About</span></a></li>

</ul>
<ul class="nav-meta">
    <li class="nav-search">
      <a aria-label="Search" href="/search.html" target="_blank">
        <i class="icon icon-search" aria-hidden="true"></i>
    <span>search</span></a></li>
    <li class="nav-foreverblog">
      <a aria-label="Foreverblog" href="https://www.foreverblog.cn/go.html" target="_blank">
        <i aria-hidden="true"><img src="https://img.foreverblog.cn/wormhole_2_tp.gif" alt="foreverblog" title="穿梭虫洞-随机访问十年之约友链博客"></i>
    <span>foreverblog</span></a></li>
    <li class="nav-travellings">
      <a aria-label="Travellings" href="https://www.travellings.cn/go.html" target="_blank">
        <i aria-hidden="true"><img src="https://www.travellings.cn/assets/w.png" alt="travellings" title="开往-友链接力" aria-hidden="true"></i>
    <span>travellings</span></a></li>
  <li class="nav-search" style="display: none;">
    <a title="Search">
      <i class="icon icon-search" aria-hidden="true"></i>
      <span>Search</span>
    </a>
  </li>
</ul>  </nav>

  <div class="nav-wrapper-control">
    <div class="inner">
      <a class="nav-menu" role="button"><i class="icon icon-menu" aria-hidden="true"></i>Menu</a>
      <a class="nav-search" title="Search" role="button" style="display: none;"><i class="icon icon-search" aria-hidden="true"></i></a>
    </div>
  </div>
</div>
<div class="nav-close" role="button" aria-label="Close"></div>
  <section id="wrapper" class="page-wrapper">
    <!-- Progressbar -->
    <div class="progress-container">
      <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="post-header  has-cover ">
      <div class="inner">
        <span class="post-info">
          <span class="post-type">Article</span>
          <span class="post-count">碎碎念</span>
        </span>
        <h1 class="post-title">文献总结｜使用强化学习和基于图的深度生成模型进行从头药物设计</h1>
        <div class="post-meta">
          <div class="post-meta-avatars">


            <figure class="post-meta-avatar avatar">
              <a class="author-avatar" href="https://leonis.cc/author/leo.html">
                <img class="author-profile-image" src="https://cravatar.cn/avatar/95e31f6808fafa1f8ef3313b6f0b10e6?s=800" alt="Leo" />
              </a>
            </figure>
          </div>

          <h4 class="post-meta-author">
            Leo
          </h4>
          <time datetime="2022年 11月05日">2022年 11月05日</time>
        </div>
          <div class="post-cover cover">
            <img src="https://api.onedrive.com/v1.0/shares/s!AtseC45rsRhNwFfSnZ1Pc1osKbni/root/content" alt="Category 碎碎念" />
          </div>
      </div>
    </header>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
          <div class="toc-nav">
            <div id="toc"><ul><li><a class="toc-href" href="#yin-yan" title="引言">引言</a></li><li><a class="toc-href" href="#fang-fa" title="方法">方法</a><ul><li><a class="toc-href" href="#fen-zi-sheng-cheng-mo-xing" title="分子生成模型">分子生成模型</a></li><li><a class="toc-href" href="#qiang-hua-xue-xi-kuang-jia" title="强化学习框架">强化学习框架</a></li><li><a class="toc-href" href="#da-fen-han-shu" title="打分函数">打分函数</a></li><li><a class="toc-href" href="#shu-ju" title="数据">数据</a></li></ul></li><li><a class="toc-href" href="#jie-guo_1" title="结果">结果</a><ul><li><a class="toc-href" href="#bu-tong-da-fen-han-shu" title="不同打分函数">不同打分函数</a></li><li><a class="toc-href" href="#ke-he-cheng-xing" title="可合成性">可合成性</a></li><li><a class="toc-href" href="#tao-lun" title="讨论">讨论</a></li></ul></li><li><a class="toc-href" href="#jie-lun_1" title="结论">结论</a></li></ul></div>
          </div>
        <div class="inner">
          <section class="post-content">
            <p><i class="fa-solid fa-arrow-up-right-from-square"></i> <a href="https://doi.org/10.1021/acs.jcim.2c00838" rel="noopener" target="_blank">doi.org/10.1021/acs.jcim.2c00838</a></p>
<p>本文介绍于 2022 年发表在 <em>Journal of Chemical Information and Modeling</em> 上的一篇文章，文章原标题为 De Novo Drug Design Using Reinforcement Learning with Graph-Based Deep Generative Models，文章借鉴了 REINVENT 模型的强化学习策略，将其用于基于图的分子生成模型，得到了较好的结果。</p>
<h2 id="yin-yan">引言</h2>
<p>强化学习是机器学习中常用的一种策略，强化学习通过奖惩函数确定某环境下执行相应行为的优劣，从而做出决策。强化学习常常用来 fine-tune 深度生成模型，使其生成的分子逐渐向具有目标特征的分子靠近。</p>
<p>GraphINVENT 是基于图神经网络的分子生成模型，REINVENT 是使用强化学习和 RNN 基于序列的分子生成模型。文章从这两个模型中受到启发，将 GraphINVENT 基于图的分子生成模型与 REINVENT 的强化学习策略相结合，提出了本文的模型。</p>
<h2 id="fang-fa">方法</h2>
<p><div class="lightgallery"><a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!7927?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"><img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!7927?authkey=ALYpzW-ZQ_VBXTU"/></a></div></p>
<p>文章中提出的模型主要由三个部分构成：</p>
<ol>
<li>基于图的分子生成模型；</li>
<li>具有记忆力感知损失函数（memory-aware loss）的强化学习框架；</li>
<li>打分模型。</li>
</ol>
<h3 id="fen-zi-sheng-cheng-mo-xing">分子生成模型</h3>
<p>分子生成模型来自于 GraphINVENT 模型，使用了门控图神经网络（GGNN）。GGNN 通过不断选取行为，从而修改输入的分子图。行为集合中包括 3 种可选的行为：添加原子、添加键和结束，将行为集合记作 <span class="math">\(\mathcal{A}\)</span>。那么生成分子图 <span class="math">\(\mathcal{G}\)</span> 的任务就可以描述为一个马尔可夫过程：代理模型依据一定的行为概率分布（action probability distributions, APD）不断选择行为，最终生成 <span class="math">\(\mathcal{G}\)</span>。行为概率分布由当前的状态决定，也就是说，通过前一步骤添加原子或键决定下一步可能的行为。</p>
<p>每个步骤的 APD 可以记作 <span class="math">\(\mathrm{APD}_i\)</span>，<span class="math">\(f:\mathcal{G}_i\rightarrow \mathrm{APD}_i\)</span>，GGNN 模型就是将在 <span class="math">\(i\)</span> 步骤生成的子图 <span class="math">\(\mathcal{G}_i\)</span> 映射到<span class="math">\(\mathrm{APD}_i\)</span> 的函数 <span class="math">\(f\)</span>，若用 <span class="math">\(a_i\)</span> 表示每个步骤的行为，那么完整的图生成过程就可以表示为</p>
<div class="math">$$\mathrm{G}_0\rightarrow a_0\sim\mathrm{APD}_0\rightarrow\mathcal{G}_1\rightarrow\cdots\rightarrow a_{n-1}\sim\mathrm{APD}_{n-1}\rightarrow\mathcal{G}_n$$</div>
<p>在 GGNN 训练中使用目标 <span class="math">\(\mathrm{APD}_\mathrm{t}\)</span> 与预测 <span class="math">\(\mathrm{APD}_\mathrm{p}\)</span> 的 KL 散度作为损失函数:</p>
<div class="math">$$D_\mathrm{KL}(\mathrm{APD}_\mathrm{t}||\mathrm{APD}_\mathrm{p})=\sum_{a\in\mathcal{A}}\mathrm{APD}_\mathrm{t}(a)\log\frac{\mathrm{APD}_\mathrm{t}(a)}{\mathrm{APD}_\mathrm{p}(a)}$$</div>
<h3 id="qiang-hua-xue-xi-kuang-jia">强化学习框架</h3>
<p>强化学习的目的是基于先验策略 <span class="math">\(\pi_\mathrm{prior}\)</span> 更新策略，使行为序列的预期打分增加，具体来说，就是在每个学习步骤中更新代理模型，保证其一直是最佳的代理模型。最佳代理模型提醒（the best agent reminder， BAR）损失函数定义为：</p>
<div class="math">$$J(\boldsymbol{\theta})=(1-\alpha)J_\mathbb{A}(\mathbb{A},\mathbb{P};\boldsymbol{\theta})+\alpha J_\tilde{\mathbb{A}}(\mathbb{A},\tilde{\mathbb{A}};\boldsymbol{\theta})$$</div>
<p>其中 <span class="math">\(\alpha\in[0,1]\)</span> 是设定的比例系数，<span class="math">\(\mathbb{P}\)</span> 是先验模型，<span class="math">\(\mathbb{A}\)</span> 与 <span class="math">\(\tilde{\mathbb{A}}\)</span> 分别是当前模型与最优模型（详见强化学习的策略梯度算法）。</p>
<h3 id="da-fen-han-shu">打分函数</h3>
<p>为了执行不同的优化任务，使用了不同的打分函数。</p>
<h4>增加或减少分子的大小</h4>
<p>为了改变生成分子的大小，提出了以下打分函数：</p>
<div class="math">$$\begin{equation}
    S_\mathrm{size}(A)=
    \begin{cases}
        0, &amp;\mathrm{if\ not\ \{PT,\ valid\ and\ unique\}}\\
        1-\frac{|n_\mathrm{nodes}-n^*_\mathrm{nodes}|}{\max_\mathrm{nodes}-n^*_\mathrm{nodes}}, &amp;\mathrm{otherwise}
    \end{cases}
\end{equation}$$</div>
<p>其中 <span class="math">\(n^*_\mathrm{nodes}\)</span> 是分子中目标重原子数量，若要增加分子大小，设定高 <span class="math">\(n^*_\mathrm{nodes}\)</span>，若要减小分子大小，设定低<span class="math">\(n^*_\mathrm{nodes}\)</span>。<span class="math">\(\max_\mathrm{nodes}\)</span> 是分子中最大节点数量，<span class="math">\(n_\mathrm{nodes}\)</span> 是分子中重原子数量，<span class="math">\(A\)</span> 指当前步骤的行为，<span class="math">\(\mathrm{PT}\)</span>  指结束构造分子的行为。</p>
<h4>增加分子类药性</h4>
<p>类药性使用 RDKit 的 QED 进行评估，打分函数定义为</p>
<div class="math">$$\begin{equation}
    S_\mathrm{QED}(A)=
    \begin{cases}
        0, &amp;\mathrm{if\ not\ \{PT,\ valid\ and\ unique\}}\\
        \mathrm{QED}(\mathrm{Mol}(A)), &amp;\mathrm{otherwise}
    \end{cases}
\end{equation}$$</div>
<h4>增加分子活性</h4>
<p>使用支持向量机模型预测分子对于 DRD2 的活性，打分函数定义为</p>
<div class="math">$$\begin{equation}
    S_\mathrm{QED}(A)=
    \begin{cases}
        1, &amp;\mathrm{if\ PT,\ valid,\ unique,}\\
        &amp;\quad \mathrm{QED}&gt;0.5\ \mathrm{and\ activity} &gt; 0.5\\
        0, &amp;\mathrm{otherwise}
    \end{cases}
\end{equation}$$</div>
<h3 id="shu-ju">数据</h3>
<p>训练模型的 DRD2 活性分子数据来自于 ChEMBL。</p>
<h2 id="jie-guo_1">结果</h2>
<h3 id="bu-tong-da-fen-han-shu">不同打分函数</h3>
<p><div class="lightgallery"><a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!7928?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"><img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!7928?authkey=ALYpzW-ZQ_VBXTU"/></a></div></p>
<p>从使用不同打分函数生成的分子数据中可以看出，在训练过程中，生成分子的均分不断提高，合法分子和 PT 分子的比例也不断升高，说明打分函数都能够正确地奖惩生成分子，可以用于分子生成模型的训练。另外，选择减小分子尺寸或提高分子类药性或提高活性的打分函数后，独特分子的比例有所下降，这主要是因为指定的打分函数使模型进入了一个更小的化学空间。</p>
<p><div class="lightgallery"><a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!7929?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"><img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!7929?authkey=ALYpzW-ZQ_VBXTU"/></a></div></p>
<p>文章分别从先验模型与单个 fine-tune 过的模型中选取 10000 个分子，在 10 个不同 fine-tune 过的模型中各选取 1000 个分子进行评估。针对平均 QED 这一指标，经过 fine-tune 的模型表现出了接近的数值且要高于先验模型。最重要的是，先验模型无法生成具有 DRD2 活性的分子，而在这一点上，经过 fine-tune 的模型生成的活性分子数量显著更高。最后，来自于 10 个不同模型的 10000 个分子中，活性分子与独特分子的占比都很高，说明 10 个模型间重叠程度小，将比单个模型更有潜力。</p>
<h3 id="ke-he-cheng-xing">可合成性</h3>
<p>文章使用 AiZynthFinder 分析分子的可合成性，AiZynthFinder 能通过循环树搜索的方式将分子通过化学反应分割为商用试剂分子。</p>
<p><div class="lightgallery"><a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!7930?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"><img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!7930?authkey=ALYpzW-ZQ_VBXTU"/></a></div></p>
<p>可以看出，预训练模型生成的可合成分子的比例要低于训练集，可以认为 GraphINVENT 模型没能学习到可合成性这一特征。在经过 fine-tune 的模型中，除了增大分子尺寸的模型以外，都生成了较多可合成分子。主要原因是，一方面，减小分子的尺寸就是在提高分子的可合成性，另一方面，具有高类药性与 DRD2 活性的分子大多具有相似的化学结构或片段，这也使得该类分子具有较高可合成性。</p>
<h3 id="tao-lun">讨论</h3>
<p>模型在训练过程中并没有使用任何真实活性分子的数据，fine-tune 之前的模型无法生成具有真实活性的分子，而经过 fine-tune 的模型能够生成一部分真实具有活性的分子，表明在实际药物发现中尚未发现真实活性分子情况下，文章中所使用的模型具有应用潜力。</p>
<p>文章中使用记忆力机制能够使模型在训练中更加平滑地偏向于最优代理模型，也能够使模型不会忘记生成较优分子的行为序列，从而引导模型更好地完成生成分子任务。文章使用的 BAR 损失函数能够很好完成多种分子生成任务。</p>
<h2 id="jie-lun_1">结论</h2>
<p>文章将策略梯度强化学习应用于基于图的从头药物设计工具，并且使用该模型生成了具有目标特征的分子。在该模型中所使用的 BAR 损失函数能够用于模型训练，并提升了分子生成模型的性能。此外，模型中使用的 4 种打分函数也完成了 4 种生成具有相应特征分子的任务。</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
          </section>


          <section class="post-footer" style="margin: 12rem 0 0;">
            <div class="post-share">
              <span class="post-info-label">Share</span>
                <a title="复制文章链接" aria-label="Share-link" class="share-link"
                  href="#" onclick='copyURL(event, "文献总结｜使用强化学习和基于图的深度生成模型进行从头药物设计 - Leo’s blog https://leonis.cc/sui-sui-nian/2022-11-05-summary-doi.org/10.1021/acs.jcim.2c00838.html");return false;'>
                  <i class="icon icon-link"
                  aria-hidden="true"></i><span class="hidden">Share-link</span>
                </a>
                <a title="嘟嘟到 Mastodon" aria-label="Mastodon" class="mastodon"
                  href="https://tootpick.org/#text=文献总结｜使用强化学习和基于图的深度生成模型进行从头药物设计 - Leo’s blog https://leonis.cc/sui-sui-nian/2022-11-05-summary-doi.org/10.1021/acs.jcim.2c00838.html" target="_blank" rel="noopener noreferrer">
                  <i class="fa-brands fa-mastodon"
                  aria-hidden="true"></i><span class="hidden">Mastodon</span>
                </a>
                <a title="分享到微博" aria-label="Weibo" class="weibo"
                  href="http://service.weibo.com/share/share.php?url=https://leonis.cc/sui-sui-nian/2022-11-05-summary-doi.org/10.1021/acs.jcim.2c00838.html&title=文献总结｜使用强化学习和基于图的深度生成模型进行从头药物设计&nbsp;-&nbsp;Leo’s blog"
                  target="_blank" rel="noopener noreferrer">
                  <i class="fa-brands fa-weibo"
                  aria-hidden="true"></i><span class="hidden">Weibo</span>
                </a>
                <a title="通过 Email 转发" aria-label="Email" class="email"
                  href="mailto:?subject=文献总结｜使用强化学习和基于图的深度生成模型进行从头药物设计&amp;body=https://leonis.cc/sui-sui-nian/2022-11-05-summary-doi.org/10.1021/acs.jcim.2c00838.html">
                  <i class="icon icon-mail"
                  aria-hidden="true"></i><span class="hidden">Email</span>
                </a>
              <div class="clear"></div>
            </div>

            <aside class="post-tags">
<a href="https://leonis.cc/tag/literature-summary.html"># Literature Summary</a><a href="https://leonis.cc/tag/cadd.html"># CADD</a><a href="https://leonis.cc/tag/gnn.html"># GNN</a><a href="https://leonis.cc/tag/rl.html"># RL</a>            </aside>

            <div class="clear"></div>

            <aside class="post-author">


                <figure class="post-author-avatar">
                  <img src="https://cravatar.cn/avatar/95e31f6808fafa1f8ef3313b6f0b10e6?s=800" alt="Leo" />
                </figure>
                <div class="post-author-bio">
                  <h4 class="post-author-name"><a href="https://leonis.cc/author/leo.html">Leo</a></h4>
                    <p class="post-author-about">A chemist who doesn’t know about classical literature isn’t a good programmer. Cool, huh?</p>
                    <span class="post-author-location">
                      <a rel="noopener" target="_blank" href="https://www.bing.com/maps?cp=39.116572%7E117.361669&lvl=10.1"
                      title="Tientsin">
                      <i class="fa-solid fa-earth-asia fa-fw"></i></a>
                    </span>
                  <!-- Social linkes in alphabet order. -->
                    <span class="post-author-mastodon">
                      <a rel="noopener" target="_blank" href="https://mast.dragon-fly.club/@leonis"
                      title="@leonis@dragon-fly.club">
                        <i class="fa-brands fa-mastodon fa-fw"></i></a>
                    </span>
                    <span class="post-author-github">
                      <a rel="noopener" target="_blank" href="https://github.com/Tseing"
                      title="@Tseing">
                        <i class="fa-brands fa-github fa-fw"></i></a>
                    </span>
                    <span class="post-author-email">
                      <a rel="noopener" target="_blank" href="mailto:im.yczeng@outlook.com"
                      title="im.yczeng@outlook.com">
                        <i class="fa-solid fa-envelope fa-fw"></i></a>
                    </span>
                    <span class="post-author-rss">
                      <a rel="noopener" target="_blank" href="/feed.xml"
                      title="RSS Feed">
                        <i class="fa-solid fa-rss fa-fw"></i></a>
                    </span>
                </div>
                <div class="clear"></div>
            </aside>

          </section>


          <aside class="post-nav">
            <a class="post-nav-next" href="https://leonis.cc/sui-sui-nian/2022-11-14-summary-doi.org/10.1039/d0sc03126g.html">
              <section class="post-nav-teaser">
                <i class="icon icon-arrow-left"></i>
                  <h2 class="post-nav-title">文献总结｜SyntaLinker：使用 Conditional Transformer 神经网络自动连接分子片段</h2>
                <p class="post-nav-excerpt">本文介绍于 2020 年发表在 Chemical Science 上的一篇文章，文章原标题为 SyntaLinker: automatic fragment linking...</p>
                <p class="post-nav-meta"><time datetime="2022年 11月14日">2022年 11月14日</time></p>
              </section>
            </a>
            <a class="post-nav-prev" href="https://leonis.cc/sui-sui-nian/2022-10-29-summary-doi.org/10.1021/acs.jmedchem.2c01179.html">
              <section class="post-nav-teaser">
                <i class="icon icon-arrow-right"></i>
                  <h2 class="post-nav-title">文献总结｜ChemistGA：用于实际药物发现的可合成分子生成算法</h2>
                <p class="post-nav-excerpt">本文介绍于 2022 年发表在 Journal of Medicinal Chemistry 上的一篇文章，文章原标题为 ChemistGA: A Chemical...</p>
                <p class="post-nav-meta"><time datetime="2022年 10月29日">2022年 10月29日</time></p>
              </section>
            </a>
            <div class="clear"></div>
          </aside>

<div id="waline"></div>
        </div>
      </article>
    </main>
    <div class="nav-footer">
      <nav class="nav-wrapper" aria-label="Footer">
        <span class="nav-copy">Leo’s blog &copy; 2024
        </span>
        <span class="nav-credits">



          Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a> &bull; Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a> &bull;
          <a class="menu-item js-theme" href="#" data-system="System theme" data-dark="Dark theme" data-light="Light theme">
            <span class="theme-icon"></span><span class="theme-text">System theme</span>
          </a>
        </span>
      </nav>
    </div>

  </section>

  <script src="https://cdnjs.loli.net/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <!-- code highlight -->
  <script src="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <script src="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/languages/django.min.js"></script>
  <script src="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/languages/dockerfile.min.js"></script>
  <script src="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/languages/markdown.min.js"></script>
  <script src="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/languages/nginx.min.js"></script>
  <script type="text/javascript" src="https://leonis.cc/theme/js/jquery.fitvids.js"></script>
  <script type="text/javascript" src="https://leonis.cc/theme/js/script.js"></script>

  <!-- lightbox -->
  <script type="text/javascript" src="https://leonis.cc/theme/js/lightgallery.min.js"></script>
  <script type="text/javascript" src="https://leonis.cc/theme/js/lg-zoom.min.js"></script>
  <script>
    var elements = document.getElementsByClassName("lightgallery");
    for(var i=0; i<elements.length; i++) {
       lightGallery(elements[i]);
    }
  </script>
    <!-- umami analytics -->
    <script async defer src="https://analytics.umami.is/script.js" data-website-id="b508982a-f7bf-4c24-a948-8de93b0cb81d"></script>


  <!-- 	The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in article.html, but it needs to be included down here, after jQuery has already loaded. -->

<script>
  $(document).ready(function () {
    var viewport = $(window);
    var post = $('.post-content');
    // Responsive videos with fitVids
    post.fitVids();

    var mdSelector="pre code";
    var rstSelector="pre code";
    var selector=mdSelector;
    // Format code blocks and add line numbers
    function codestyling() {
      $(selector).each(function(i, e) {
        // Code highlight
        hljs.highlightElement(e);
        // No lines for plain text blocks
        if (!$(this).hasClass('language-text')) {
          var code = $(this);
          // Calculate amount of lines
          var lines = code.html().split(/\n(?!$)/g).length;
          var numbers = [];
          if (lines > 1) {
            lines++;
          }
          for (i = 1; i < lines; i++) {
            numbers += '<span class="line" aria-hidden="true">' + i + '</span>';
          }
          code.parent().append('<div class="lines">' + numbers + '</div>');
        }
      });
    }

    // Format code blocks only
    function codestylingWithoutLineNumbers() {
      $(selector).each(function(i, e) {
        // Code highlight
        hljs.highlightElement(e);
      });
    }

    codestylingWithoutLineNumbers();
    // Reading progress bar on window top
    function readingProgress() {
      var postBottom = post.offset().top + post.height();
      var viewportHeight = viewport.height();
      var progress = 100 - (((postBottom - (viewport.scrollTop() + viewportHeight) + viewportHeight / 3) / (postBottom - viewportHeight + viewportHeight / 3)) * 100);
      $('.progress-bar').css('width', progress + '%');
      (progress > 100) ? $('.progress-container').addClass('complete'): $('.progress-container').removeClass('complete');
    }
    readingProgress();
    // Trigger reading progress
    viewport.on({
      'scroll': function() {
        readingProgress();
      },
      'resize': function() {
        readingProgress();
      },
      'orientationchange': function() {
        readingProgress();
      }
    });

  });

  Waline.init({
      el: '#waline',
      serverURL: "https://waline-1-d9689975.deta.app/",
      emoji: false,
      search: false,
      imageUploader: false,
      locale: {placeholder: "欢迎评论，填写邮箱可以获取头像和收到回复通知～"},
  });
</script>
</body>

</html>