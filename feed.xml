<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Leo's blog</title><link href="https://leonis.cc/" rel="alternate"></link><link href="https://leonis.cc/feed.xml" rel="self"></link><id>https://leonis.cc/</id><updated>2023-03-25T00:00:00+08:00</updated><subtitle>A nook to hoard my manuscripts.</subtitle><entry><title>文献总结｜通过连接感知模版挖掘实现从头生成分子</title><link href="https://leonis.cc/sui-sui-nian/2023-03-25-summary-doi.org/10.48550/arXiv.2302.01129.html" rel="alternate"></link><published>2023-03-25T00:00:00+08:00</published><updated>2023-03-25T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-03-25:/sui-sui-nian/2023-03-25-summary-doi.org/10.48550/arXiv.2302.01129.html</id><summary type="html">&lt;p&gt;本文介绍由中科大于 2023 年发布在 ICLR 2023 上的一篇文章，文章原标题为 De Novo Molecular Generation via Connection-aware Motif Mining，文章提出了一种从分子数据集中挖掘模版结构的算法，同时设计了一种通过组合模版结构实现分子生成的模型。&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;i class="fa fa-external-link"&gt;&lt;/i&gt; &lt;a href="https://doi.org/10.48550/arXiv.2302.01129" rel="noopener" target="_blank"&gt;doi.org/10.48550/arXiv.2302.01129&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本文介绍由中科大于 2023 年发布在 ICLR 2023 上的一篇文章，文章原标题为 De Novo Molecular Generation via Connection-aware Motif Mining，文章提出了一种从分子数据集中挖掘模版结构的算法，同时设计了一种通过组合模版结构实现分子生成的模型 MiCaM（Mined Connection-aware Motifs）。&lt;/p&gt;
&lt;h2 id="suan-fa"&gt;算法&lt;/h2&gt;
&lt;p&gt;文章中提出的连接感知模版挖掘能够从数据集中构建模版词汇，用于后续的分子生成，该算法包括两个主要步骤：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;合并操作（Merging-operation Learning Phase）&lt;/li&gt;
&lt;li&gt;构建模版词汇（Motif-vocabulary Construction Phase）&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="算法" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8702?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="算法" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8702?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h3 id="he-bing-cao-zuo"&gt;合并操作&lt;/h3&gt;
&lt;p&gt;数据集 &lt;span class="math"&gt;\(\mathcal{D}\)&lt;/span&gt; 中的每个分子都可以表示为图 &lt;span class="math"&gt;\(\mathcal{G(V,E)}\)&lt;/span&gt;，结点 &lt;span class="math"&gt;\(\mathcal{V}\)&lt;/span&gt; 表示原子，边 &lt;span class="math"&gt;\(\mathcal{E}\)&lt;/span&gt; 表示化学键。接着定义与之类似的 &lt;span class="math"&gt;\(\mathcal{G}^{(k)}_M(\mathcal{V}^{(k)}_M,\mathcal{E}^{(k)}_M)\)&lt;/span&gt; 表示第 &lt;span class="math"&gt;\(k\)&lt;/span&gt; 次合并后的分子，其中 &lt;span class="math"&gt;\(\mathcal{F}\in\mathcal{V}_M\)&lt;/span&gt; 表示分子的子结构，可以由一个原子构成，也可以由多个原子构成，那么边 &lt;span class="math"&gt;\(\mathcal{E}_M\)&lt;/span&gt; 相应就表示子结构之间的连接方式。显然 &lt;span class="math"&gt;\(\mathcal{G}^{(k)}_M\)&lt;/span&gt; 由 &lt;span class="math"&gt;\(\mathcal{G}\)&lt;/span&gt; 初始化得到，也就是 &lt;span class="math"&gt;\(\mathcal{G}^{(0)}_M(\mathcal{V}^{(0)}_M,\mathcal{E}^{(0)}_M=\mathcal{G(V,E)}\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;接下来介绍由 &lt;span class="math"&gt;\(\mathcal{G}^{(0)}_M\)&lt;/span&gt; 得到 &lt;span class="math"&gt;\(\mathcal{G}^{(k)}_M\)&lt;/span&gt; 的合并操作，文章将操作「&lt;span class="math"&gt;\(\oplus\)&lt;/span&gt;」定义将子结构合并为新的子结构，即 &lt;span class="math"&gt;\(\mathcal{F}_{ij}=\mathcal{F}_i\oplus\mathcal{F}_j\)&lt;/span&gt;，其中 &lt;span class="math"&gt;\(\mathcal{F}_{ij}\)&lt;/span&gt; 就包含了 &lt;span class="math"&gt;\(\mathcal{F}_i\)&lt;/span&gt; 与 &lt;span class="math"&gt;\(\mathcal{F}_j\)&lt;/span&gt; 中所有的结点与边。&lt;span class="math"&gt;\(\mathcal{G}^{(0)}_M\)&lt;/span&gt; 包含了边 &lt;span class="math"&gt;\(\mathcal{E}^{(0)}_M\)&lt;/span&gt;，边又连接了相应的子结构，所以对于通过边连接的子结构 &lt;span class="math"&gt;\((\mathcal{F}^{(0)}_i,\mathcal{F}^{(0)}_j)\in\mathcal{E}^{(0)}_M\)&lt;/span&gt; 计算 &lt;span class="math"&gt;\(\mathcal{F}^{(0)}_{ij}=\mathcal{F}^{(0)}_i\oplus\mathcal{F}^{(0)}_j\)&lt;/span&gt;，其中出现频率最高的 &lt;span class="math"&gt;\(\mathcal{F}^{(0)}_{ij}\)&lt;/span&gt; 就记作 &lt;span class="math"&gt;\(\mathcal{M}^{(0)}\)&lt;/span&gt;。再次遍历子结构 &lt;span class="math"&gt;\((\mathcal{F}^{(0)}_i,\mathcal{F}^{(0)}_j)\in\mathcal{E}^{(0)}_M\)&lt;/span&gt;，只要 &lt;span class="math"&gt;\(\mathcal{F}^{(0)}_i\oplus\mathcal{F}^{(0)}_j==\mathcal{M}^{(0)}\)&lt;/span&gt;，就将这两个子结构合并，完成后得到的所有新子结构就是 &lt;span class="math"&gt;\(\mathcal{V}^{(1)}_M\)&lt;/span&gt;，相应的新连接边就是 &lt;span class="math"&gt;\(\mathcal{E}^{(1)}_M\)&lt;/span&gt;，二者构成了经过 1 次合并的分子 &lt;span class="math"&gt;\(\mathcal{G}^{(1)}_M\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;以上合并操作可以推广，在第 &lt;span class="math"&gt;\(k\)&lt;/span&gt; 次合并中，可以从分子 &lt;span class="math"&gt;\(\mathcal{G}^{(k)}_M(\mathcal{V}^{(k)}_M,\mathcal{E}^{(k)}_M)\)&lt;/span&gt; 得到分子 &lt;span class="math"&gt;\(\mathcal{G}^{(k+1)}_M(\mathcal{V}^{(k+1)}_M,\mathcal{E}^{(k+1)}_M)\)&lt;/span&gt;。&lt;/p&gt;
&lt;h3 id="gou-jian-mo-ban-ci-hui"&gt;构建模版词汇&lt;/h3&gt;
&lt;p&gt;数据集中的所有分子在合并操作后都变为 &lt;span class="math"&gt;\(\mathcal{G}^{(K)}_M(\mathcal{V}^{(K)}_M,\mathcal{E}^{(K)}_M)\)&lt;/span&gt;，此时分子的已经大大简化，将分子中的结点分割开来，并添加上连接位置的标记 &lt;code&gt;*&lt;/code&gt;，就得到了分子结构模版。&lt;/p&gt;
&lt;h2 id="mo-xing_1"&gt;模型&lt;/h2&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="模型" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8703?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="模型" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8703?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;MiCaM 通过多个逐渐组合模版结构的步骤生成分子，这样的组成有两种方式，一种是直接在连接位置上连上另一个模版结构，另一种是分子中的两个连接位置相连（成环）。&lt;/p&gt;
&lt;p&gt;将第 &lt;span class="math"&gt;\(t\)&lt;/span&gt; 步得到的分子记作 &lt;span class="math"&gt;\(\mathcal{G}_t\)&lt;/span&gt;，用 &lt;span class="math"&gt;\(\mathcal{C}_{\mathcal{G}_t}\)&lt;/span&gt; 表示该分子的所有连接位置，使用序列 &lt;span class="math"&gt;\(\mathcal{Q}\)&lt;/span&gt; 记录 &lt;span class="math"&gt;\(\mathcal{C}_{\mathcal{G}_t}\)&lt;/span&gt; 中所有连接位置的顺序。在第 &lt;span class="math"&gt;\(t\)&lt;/span&gt; 步取出 &lt;span class="math"&gt;\(\mathcal{Q}\)&lt;/span&gt; 的首个元素 &lt;span class="math"&gt;\(v_t\)&lt;/span&gt;，也就是当前操作的连接位置，在该处连接或者成环后，就得到了新分子。新分子中可能具有新的连接位置，所以还使用 RDKit 更新序列 &lt;span class="math"&gt;\(\mathcal{Q}\)&lt;/span&gt;。分子生成步骤就是不断重复以上过程，直至 &lt;span class="math"&gt;\(\mathcal{Q}\)&lt;/span&gt; 为空，此时分子中的所有连接位置都被填满，就得到了输出分子。&lt;/p&gt;
&lt;p&gt;因为具有连接和成环两种组合方式，所以在每个生成步骤中还需要确定与当前操作的连接位置 &lt;span class="math"&gt;\(v_t\)&lt;/span&gt; 相连的位置与子结构。&lt;/p&gt;
&lt;p&gt;文章为此设计了以下步骤，首先使用 GNN&lt;sub&gt;pmol&lt;/sub&gt; 编码当前步骤得到的分子 &lt;span class="math"&gt;\(\mathcal{G}_t\)&lt;/span&gt; 和当前操作的连接位置 &lt;span class="math"&gt;\(v_t\)&lt;/span&gt;，分别得到相应的表示 &lt;span class="math"&gt;\(\boldsymbol{h}_{v_t}\)&lt;/span&gt; 与 &lt;span class="math"&gt;\(\boldsymbol{h}_{\mathcal{G}_t}\)&lt;/span&gt;，使用 GNN&lt;sub&gt;motif&lt;/sub&gt; 编码模版库中的所有结构模版，得到所有连接位置 &lt;span class="math"&gt;\(v\in\mathcal{C}_\mathrm{Vocab}\)&lt;/span&gt; 的表示 &lt;span class="math"&gt;\(\boldsymbol{h}_{v}\)&lt;/span&gt;。使用神经网络将相应的表示转换为向量，寻找与 query 向量最相似的 key 向量，也就是根据以下概率选择与当前操作的连接位置 &lt;span class="math"&gt;\(v_t\)&lt;/span&gt; 相连的位置：&lt;/p&gt;
&lt;div class="math"&gt;$$P_v=\mathop{\mathrm{softmax}}_{v\in\mathcal{C}_\mathrm{Vocab}\cup\mathcal{C}_{\mathcal{G}_t}\backslash\{v_t\}}(\mathrm{NN_{query}}([\boldsymbol{z},\boldsymbol{h}_{\mathcal{G}_t},\boldsymbol{h}_{v_t}])\cdot\mathrm{NN_{key}}(\boldsymbol{h}_v))$$&lt;/div&gt;
&lt;p&gt;若候选的连接位置 &lt;span class="math"&gt;\(v\in\mathcal{C}_\mathrm{Vocab}\)&lt;/span&gt;，则在模版库中取得相应的 &lt;span class="math"&gt;\(\mathcal{F}^*\)&lt;/span&gt;，并将其接入分子 &lt;span class="math"&gt;\(\mathcal{G}_t\)&lt;/span&gt;，完成连接；若 &lt;span class="math"&gt;\(v\in\mathcal{C}_{\mathcal{G}_t}\)&lt;/span&gt;，那么就合并 &lt;span class="math"&gt;\(v_t\)&lt;/span&gt; 与 &lt;span class="math"&gt;\(v\)&lt;/span&gt;，完成成环。&lt;/p&gt;
&lt;h2 id="jie-guo-yu-tao-lun"&gt;结果与讨论&lt;/h2&gt;
&lt;h3 id="fen-bu-xue-xi"&gt;分布学习&lt;/h3&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8704?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8704?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;文章在 QM9、ZINC 和 GuacaMol 三个数据集上分别训练了 MiCaM，并使用 MiCaM 生成分子，检查生成的分子集是否接近训练集的分布。实验结果如上表所示，在 QM9 和 GuacaMol 数据集上，MiCaM 生成分子的 Uniqueness 和 Novelty 低于 MoLeR 和 GP-VAE 等模型，但在 KL Div 和 FCD score 上，MiCaM 完全优于其他模型。KL Div 与 FCD score 都衡量了生成分子集与训练集分布的相似程度，也就是说，MiCaM 生成的分子最接近训练集的分布。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8705?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8705?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;在算法一节提到的参数 &lt;span class="math"&gt;\(K\)&lt;/span&gt; 决定了合并次数，文章在 QM9 数据集上测试了该参数对生成分子的影响。随着合并次数增加，KL Div 与 FCD score 都随之增加，而生成分子的 Novelty 却在下降。这是因为合并次数越多，分子简化程度越大，最后进入模版库中的模版结构也会更加复杂、更加接近训练集中的分子，最后使用这些模版结构构造的分子就会趋于与训练集分子「雷同」，这也一点程度解释了为什么 MiCaM 生成分子的 Uniqueness 和 Novelty 低于部分模型。&lt;/p&gt;
&lt;h3 id="die-dai-you-hua"&gt;迭代优化&lt;/h3&gt;
&lt;p&gt;文章还使用 MiCaM 进行了迭代目标增强（Iterative Target Augmentation, ITA）的分子生成。首先选出数据集中针对目标要求打分最高的 &lt;span class="math"&gt;\(N\)&lt;/span&gt; 个分子，接着使用模型在该训练集上微调并产生新分子，每次迭代过程中，在新分子与训练集中再选出打分最高的 &lt;span class="math"&gt;\(N\)&lt;/span&gt; 个分子，用作为下一次迭代的训练集。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8706?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8706?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;在文章设计的 5 种任务中，MiCaM 优于其他所有模型。&lt;/p&gt;
&lt;p&gt;最后文章展示了 MiCaM 生成分子的过程，经过 5 个步骤，MiCaM 就能生成相当复杂的分子，同时分子的各性质分数也相应提高。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8707?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8707?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h2 id="jie-lun_1"&gt;结论&lt;/h2&gt;
&lt;p&gt;文章提出了一种从分子数据中挖掘模版结构的算法，能够用于提取分子数据集中频繁出现的子结构并构建模版结构库，同时文章设计了基于该模版结构库的分子生成模型 MiCaM。MiCaM 通过逐步组合模版结构实现分子生成，很大程度解决了以往启发式分子生成随机性大、难以生成复杂结构的问题，使用模版结构组合生成的分子也更接近于现实中化学家对化合物改造的策略。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="碎碎念"></category><category term="Literature Summary"></category><category term="CADD"></category><category term="GNN"></category><category term="VAE"></category></entry><entry><title>春日漫步小记</title><link href="https://leonis.cc/zai-lu-shang/2023-03-24-spring-trip-in-tianjin.html" rel="alternate"></link><published>2023-03-24T00:00:00+08:00</published><updated>2023-03-24T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-03-24:/zai-lu-shang/2023-03-24-spring-trip-in-tianjin.html</id><summary type="html">&lt;p&gt;五六天前刚起了几阵沙尘暴，入眼的一切都是黄蒙蒙的。黄沙中的行人都拉紧着衣服、戴着口罩，可能是为了防沙，也可能是为了防病毒。唯一不避风沙的只有两旁的行道树，经冬之后满是枯枝，更添了几分萧索。就是在这样一片了无生气之中，竟在 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;五六天前刚起了几阵沙尘暴，入眼的一切都是黄蒙蒙的。黄沙中的行人都拉紧着衣服、戴着口罩，可能是为了防沙，也可能是为了防病毒。唯一不避风沙的只有两旁的行道树，经冬之后满是枯枝，更添了几分萧索。就是在这样一片了无生气之中，竟在几天之中气温陡升，绽开了桃花，催绿了柳梢，赶在春分前酝酿好了春天的氛围。我想，也只有中原与华北的气候能如此依时令而行，不误物候，也只有在这时，看着次第开放的春花，才深感只有北方的花如此重诺而能被称为「花信」。&lt;/p&gt;
&lt;p&gt;虽是在尘埃满扑之中，但桃红柳绿的色彩也使春光亮丽了起来，现出了新鲜的气象。自新冠管控放松之后，趁着东风，京津间的通勤也恢复如常了，于是与北京的好友几人约在周末沿海河散散步。&lt;/p&gt;
&lt;p&gt;海河是天津最有风采的景致，虽说不如长江黄河之于中国，但若是失了海河，天津的趣味就要大打折扣。此行的起点就在三岔河口前的丁字沽，北运河、子牙河与海河在此交汇，形成「丁」形，因而得名「丁字沽」。朋友看着路边介绍京杭大运河的牌子打趣这里该算天津的陆家嘴，运河虽是依旧却再难见到繁忙来往的船舶。&lt;/p&gt;
&lt;p&gt;丁字沽一带的桃花园与西沽公园是赏春的好去处，不用多言，其中最负盛名的自然是桃花。节临三月，占得春花头筹的就是桃花，连通往景点的路上也游人如织，非摩肩接朣不得过，也许是为了不打消游人赏花的兴致，原先告示的「预约入园」也成了君子协定，凡是到场即可入内，园中的人流便可以推测了。桃花园是北运河边的一条长堤，沿堤遍植桃树，因此没有「园」之实，称为桃花堤更为贴切。长堤上人头攒动，头顶上两边的桃树相互环合，拱成了一条花廊，游人在花廊下行走，而时不时几阵薰风吹过，就有几枚桃花脱了梢头，落入人流之中。人在花群中，花亦在人群中。&lt;/p&gt;
&lt;p&gt;花廊难以目力穷尽，只得顺人流向前。沿桃花堤前行，一旁的北运河也沿着桃花堤悠悠向前流淌。正当乱花迷眼而觉得乏味之时，桃花堤悄然南折，北运河也在此转而向南一路奔流汇注海河，我也在此转身向南。赫然映入眼中的是一株高三丈许的玉兰，玉兰的枝干上着满了白花，不杂一叶，开得是那样浓烈，温润洁白的玉兰浑如古玉，又是那样祥和。还不及细想缘何没有人驻足树下，才发觉前方有河北工业大学的匾额，同时提醒谢绝游人的参观。静静伫立在校园中，仅有的喧闹也只是汩汩的运河水与朗朗书声，悄悄花开花落，委心任乎去留，这株洁白的玉兰也变得更加洒脱起来。&lt;/p&gt;
&lt;p&gt;南折不远，便出了桃花堤，前方遥遥与之照应的是西沽公园。西沽公园与桃花堤不同，所占面积要大许多，所以尽管设置了巨大的广告牌招徕游客，园中也不至于像桃花堤那样拥挤。西沽公园中的游人更多是附近的居民，按天津人的闲致，家旁有如此山水湖林，自然免不了来此唱几句皮黄，园中也得以檀板丝弦不绝于耳，平添了生活气息。&lt;/p&gt;
&lt;p&gt;午后日光稍晻，沿海河一路步行至旧意租界。随着渐渐临近春分，东风解冻了海河，虽没有鸭子来试试水温，但漂浮在河面上随波逐流的海鸥也提示着春水已暖。海河曾是繁忙的航道，如今常见的船只也只有观光轮渡，安静下来的海河于是成了海鸥休憩觅食的场所。每有渡船经过，稍谨慎的扑翅腾空而上，盘旋数周待船只曳开的波澜平息后又落入水中，稍慵懒的也不动弹，宁随着艏波漂荡，一派春日融融的景象。&lt;/p&gt;
&lt;p&gt;与海河作别，进入旧意租界，眼见日头已经西颓，于是匆匆穿过条条欧式风情的街道寻觅晚餐，又匆匆送朋友往火车站，而后分别。一天的漫步果然让我收获了腰酸腿痛，但兴致、友人与良辰美景总是难以聚齐，难得能够这样共同游目聘怀，不仅幸甚，也算是不负如此韶光了。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="桃花堤" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8688?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="桃花堤" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8688?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p class="intro"&gt;&lt;i class="fa fa-angle-double-up"&gt;&lt;/i&gt; 游人如织的桃花堤&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="桃花堤" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8689?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="桃花堤" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8689?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="桃花堤" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8690?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="桃花堤" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8690?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="河北工业大学" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8691?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="河北工业大学" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8691?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p class="intro"&gt;&lt;i class="fa fa-angle-double-up"&gt;&lt;/i&gt; 河工大中独自盛开的玉兰&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="海河" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8694?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="海河" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8694?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p class="intro"&gt;&lt;i class="fa fa-angle-double-up"&gt;&lt;/i&gt; 海河中戏水的海鸥&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="海河" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8692?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="海河" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8692?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p class="intro"&gt;&lt;i class="fa fa-angle-double-up"&gt;&lt;/i&gt; 与骑手相伴而飞&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="海河" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8693?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="海河" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8693?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="但丁广场" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8695?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="但丁广场" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8695?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p class="intro"&gt;&lt;i class="fa fa-angle-double-up"&gt;&lt;/i&gt; 但丁握着哪部文集的稿子？&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="意式风情街" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8696?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="意式风情街" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8696?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p class="intro"&gt;&lt;i class="fa fa-angle-double-up"&gt;&lt;/i&gt; 某无人居住的故居，窗前桃花已开，主人归未？&lt;/p&gt;</content><category term="在路上"></category><category term="随笔"></category><category term="游记"></category><category term="摄影"></category></entry><entry><title>文献总结｜使用等变扩散模型进行基于结构的药物设计</title><link href="https://leonis.cc/sui-sui-nian/2023-03-17-summary-doi.org/10.48550/arXiv.2210.13695.html" rel="alternate"></link><published>2023-03-17T00:00:00+08:00</published><updated>2023-03-17T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-03-17:/sui-sui-nian/2023-03-17-summary-doi.org/10.48550/arXiv.2210.13695.html</id><summary type="html">&lt;p&gt;本文介绍由洛桑联邦理工学院等研究单位于 2022 年发布在 arXiv 上的一篇文章，文章原标题为 Structure-based Drug Design with Equivariant Diffusion Models，文章首次将等变扩散模型用于基于结构的药物设计，实现针对特定的蛋白靶点生成多样且具有高亲合力的的配体分子。&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;i class="fa fa-external-link"&gt;&lt;/i&gt; &lt;a href="https://doi.org/10.48550/arXiv.2210.13695" rel="noopener" target="_blank"&gt;doi.org/10.48550/arXiv.2210.13695&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本文介绍由洛桑联邦理工学院等研究单位于 2022 年发布在 arXiv 上的一篇文章，文章原标题为 Structure-based Drug Design with Equivariant Diffusion Models，文章首次将等变扩散模型用于基于结构的药物设计，实现针对特定的蛋白靶点生成多样且具有高亲合力的的配体分子。&lt;/p&gt;
&lt;p&gt;近年来，越来越多的深度学习模型被应于用基于结构的药物设计，但这些模型主要采用了序列生成的方式，这些方法所面临的一个重要问题是序列生成忽视了原子的几何顺序，可能并不能反映设计分子的真实原理，最后无法获取到目标分子的化学空间。&lt;/p&gt;
&lt;p&gt;针对于这个问题，文章考虑了分子中各原子的空间坐标，使用等变扩散模型完成了针对特定靶点的分子生成，称为 DiffSBDD（Equivariant Diffusion Model
for Structure-Based Drug Design），实验结果表明该模型能够获取指定蛋白活性口袋的信息并生成多样、具有类药性且具有高亲合力的分子。&lt;/p&gt;
&lt;h2 id="mo-xing"&gt;模型&lt;/h2&gt;
&lt;h3 id="qu-zao-sheng-kuo-san-gai-lu-mo-xing"&gt;去噪声扩散概率模型&lt;/h3&gt;
&lt;p&gt;去噪声扩散概率模型（Denoising Diffusion Probabilistic Models, DDPMs）是近年应用于多个领域的一类生成模型，DDPM 通过马尔可夫链逐次向样本数据上添加噪声，然后由神经网络学习该马尔可夫链的逆过程，实现从噪声中重建采样数据。&lt;/p&gt;
&lt;p&gt;就分子生成任务而言，样本数据是原子点云（简称分子） &lt;span class="math"&gt;\(\boldsymbol{z}_\mathrm{data}=[\boldsymbol{x},\boldsymbol{h}]\)&lt;/span&gt;，其中 &lt;span class="math"&gt;\(\boldsymbol{x}\in\mathbb{R}^{N\times3}\)&lt;/span&gt;，表示原子的空间坐标，&lt;span class="math"&gt;\(\boldsymbol{h}\in\mathbb{R}^{N\times d}\)&lt;/span&gt;，表示原子的特征。那么对原子点由 &lt;span class="math"&gt;\(t=0\)&lt;/span&gt; 至 &lt;span class="math"&gt;\(t=T\)&lt;/span&gt; 逐次加噪声的过程就可以表示为&lt;/p&gt;
&lt;div class="math"&gt;$$q(\boldsymbol{z}_t|\boldsymbol{z}_\mathrm{data})=\mathcal{N}(\boldsymbol{z}_t|\alpha_t\boldsymbol{z}_\mathrm{data},\sigma^2_t\boldsymbol{I})$$&lt;/div&gt;
&lt;p&gt;由 &lt;span class="math"&gt;\(t\)&lt;/span&gt; 至 &lt;span class="math"&gt;\(s&amp;lt;t\)&lt;/span&gt; 的去噪声的过程同是马尔可夫链，记作 &lt;span class="math"&gt;\(q(\boldsymbol{z}_s|\boldsymbol{z}_\mathrm{data},\boldsymbol{z}_t)\)&lt;/span&gt;，可以看出去噪声的过程依赖于样本数据 &lt;span class="math"&gt;\(\boldsymbol{z}_\mathrm{data}\)&lt;/span&gt;，即标签数据。&lt;/p&gt;
&lt;p&gt;但当使用模型进行预测时，由于预测的分子 &lt;span class="math"&gt;\(\boldsymbol{z}_\mathrm{data}\)&lt;/span&gt; 是未知的，该模型使用神经网络 &lt;span class="math"&gt;\(\phi_\theta\)&lt;/span&gt; 拟合得到 &lt;span class="math"&gt;\(\hat{\boldsymbol{z}}_\mathrm{data}\)&lt;/span&gt;。具体来说，加噪声后的分子可以表示为&lt;/p&gt;
&lt;div class="math"&gt;$$\boldsymbol{z}_t=\alpha_t\boldsymbol{z}_\mathrm{data}+\sigma_t\boldsymbol{\epsilon},\ \epsilon\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I})$$&lt;/div&gt;
&lt;p&gt;神经网络就是用于预测噪声 &lt;span class="math"&gt;\(\hat{\boldsymbol{\epsilon}}_\theta=\phi_\theta(\boldsymbol{z}_t,t)\)&lt;/span&gt;，那么显然有&lt;/p&gt;
&lt;div class="math"&gt;$$\hat{\boldsymbol{z}}_\mathrm{data}=\frac{1}{\alpha_t}\boldsymbol{z}_t-\frac{\sigma_t}{\alpha_t}\hat{\boldsymbol{\epsilon}}_\theta$$&lt;/div&gt;
&lt;p&gt;所以训练的目标也就是最小化神经网络预测值 &lt;span class="math"&gt;\(\hat{\boldsymbol{\epsilon}}_\theta\)&lt;/span&gt; 与真实值 &lt;span class="math"&gt;\(\boldsymbol{\epsilon}\)&lt;/span&gt; 间的差距，损失函数为&lt;/p&gt;
&lt;div class="math"&gt;$$\mathcal{L}_\mathrm{train}=\frac{1}{2}||\boldsymbol{\epsilon}-\phi_\theta(\boldsymbol{z}_t,t)||^2$$&lt;/div&gt;
&lt;h3 id="en-deng-bian-tu-shen-jing-wang-luo"&gt;&lt;em&gt;E(n)&lt;/em&gt; - 等变图神经网络&lt;/h3&gt;
&lt;p&gt;在使生成的分子与蛋白活性口袋配合的过程中，需要重新打乱原子生成新的结构，所以需要对原子点云做置换、旋转等变换。传统的图神经网络无法很好处理这类具有等变对称性质的特征，因而提出的一类改进后用于处理等变性质的图神经网络就被称为等变图神经网络。&lt;/p&gt;
&lt;h3 id="diffsbdd"&gt;DiffSBDD&lt;/h3&gt;
&lt;p&gt;结合以上两种模型，就得到了文章中所设计的 DiffSBDD，DiffSBDD 具有两种分子生成方式：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;蛋白口袋条件分子生成（Conditional generation）&lt;/li&gt;
&lt;li&gt;通过联合分布实现分子生成（Inpainting）&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8663?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8663?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h4&gt;Conditional generation&lt;/h4&gt;
&lt;p&gt;在 conditional generation 模式中，给模型的每个去噪声过程都指定了相同的蛋白口袋，简单来讲，就是在分子生成过程中，原子点云会不断发生置换、旋转等变换，而蛋白口袋不发生变化，使配体分子去「适配」蛋白口袋。&lt;/p&gt;
&lt;h3 id="inpainting"&gt;Inpainting&lt;/h3&gt;
&lt;p&gt;而在 inpainting 模式中，需要首先训练一个无指定条件的 DDPM 用于拟合配体分子与蛋白口袋的联合概率分布 &lt;span class="math"&gt;\(p(\boldsymbol{z}^{(L)}_\mathrm{data},\boldsymbol{z}^{(P)}_\mathrm{data})\)&lt;/span&gt;，该概率分布的主要用于从噪声数据中得到配合的配体分子与蛋白口袋对。&lt;/p&gt;
&lt;p&gt;在预测过程中，首先将加噪声后的样本 &lt;span class="math"&gt;\([\boldsymbol{z}^{(L)}_t,\boldsymbol{z}^{(P)}_t]\)&lt;/span&gt; 中的蛋白口袋掩盖掉，将得到其中的配体部分与加噪声后的蛋白口袋重新组合为 &lt;span class="math"&gt;\([\boldsymbol{z}^{(L)}_t,\boldsymbol{z}^{(P')}_t]\)&lt;/span&gt;，最后用已训练得到的联合概率分布 DDPM 为该组合去噪声，即生成目标分子。&lt;/p&gt;
&lt;h2 id="shu-ju_1"&gt;数据&lt;/h2&gt;
&lt;p&gt;文章分别使用了 CrossDocked 中 10 万个蛋白-配体对和 Binding MOAD 中 40354 个蛋白-配体对作为模型的数据集。&lt;/p&gt;
&lt;h2 id="jie-guo-yu-tao-lun"&gt;结果与讨论&lt;/h2&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8664?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8664?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;首先文章对生成分子进行了评估，可以看出不管使用哪一个数据集训练模型、使用哪一个模式生成分子，最终结果中只有很小一部分生成的分子不合法，生成分子中大部分都满足新颖、合法的要求。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8665?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8665?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;接着文章将分子生成结果与目前在基于结构的药物设计上表现最好的 3D-SBDD 和 Pocaket2Mol 两种模型比较。从表中的数据可以看出，在 Vina Score 上，DiffSBDD 与另外两种模型都比较接近，也就是模型都识别到了配体与蛋白口袋间的相互作用，生成了具有亲合力的分子。DiffSBDD 在 QED、Lipinski 这些分子性质上并没有实现优化，而是与测试集保持相似。其中，DiffSBDD 在 SA 上显著低于其他两种模型，文章认为 SA 在一定程度上并不能反映分子真实的合成难度，低 SA 反而说明 DiffSBDD 能够探索更大的化学空间，因此具有最高的 Diversity。最后，DiffSBDD 所需的计算时间远远少于另外两种模型，相比之下更加高效。&lt;/p&gt;
&lt;p&gt;文章展示了针对靶点 2jjg 和 3kc1 生成的分子，其中为 3kc1 生成的第二个分子具有三环结构，该分子也曾在传统的基于结构的药物设计中被设计出来，说明 DiffSBDD 具有应用潜力。在生成的许多分子，还可以找到大环、三元环化合物，这些分子很难合成，所以 DiffSBDD 可能还需要考虑分子的可合成性。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8667?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8667?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h2 id="jie-lun"&gt;结论&lt;/h2&gt;
&lt;p&gt;文章中所提出的 DiffSBDD 首次将等变扩散模型应用于基于结构的药物设计领域，实验证明了 DiffSBDD 在完成分子生成任务上不仅高效而且有效，能够针对给定的靶点生成多样且具有高亲合力的配体分子，该模型不需要再训练就可以直接应用于先导化合物优化等药物设计实践。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="碎碎念"></category><category term="Literature Summary"></category><category term="CADD"></category><category term="GNN"></category></entry><entry><title>为 Pelican 博客加入搜索功能</title><link href="https://leonis.cc/sui-sui-nian/2023-03-14-deploy-pelican-search.html" rel="alternate"></link><published>2023-03-14T00:00:00+08:00</published><updated>2023-03-14T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-03-14:/sui-sui-nian/2023-03-14-deploy-pelican-search.html</id><summary type="html">&lt;p&gt;博客上的文章越来越多了，靠文章 tag 来检索文章总是有些麻烦，不妨为博客配置一个搜索功能吧。在中文互联网上搜索不到半点配置 Pelican Search 的相关信息，希望这篇文章能帮到后来人。&lt;/p&gt;</summary><content type="html">&lt;p&gt;在目前的博客生态圈中，静态博客占了相当大的比例。静态博客因为足够轻量、便于备份和迁移而受到包括我在内的许多用户喜欢，但由于静态博客没有数据库，在组织内容上就不免有所不足，这就涉及到题中所说的搜索功能了。为静态博客部署搜索功能比较麻烦，一个稍简单的方法就是借于「必应」「谷歌」等搜索引擎的 API，用它们来搜索站内的内容，但是这种方法的效果并不好，如果网页还未被收录或是相应头键字在网页中的占比太小，就很难搜索到目标信息。另一种方法就是在站内建立本地的搜索，例如 Hexo 等博客框架都提供了相应的插件，在本地生成搜索匹配所需的文件，将其一并推送至服务器实现全站搜索，这种方法的兼容性、准确性都要更好，也是我选择的方案。&lt;/p&gt;
&lt;p&gt;Pelican 也有类似的搜索插件 &lt;a href="https://github.com/pelican-plugins/search" rel="noopener" target="_blank"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt; pelican-plugins/search&lt;/a&gt;，它主要是借助了 &lt;a href="https://stork-search.net/" rel="noopener" target="_blank"&gt;Stork&lt;/a&gt; 来实现搜索功能。Stork 在官方文档中指出，它可以用于为静态站点构建关速美观的搜索接口，所以理应可以用于所有类型的静态博客，我不了解其他博客框架是否使用了这个工具，但不得不提其搜索体验非常不错，十分值得一试。&lt;/p&gt;
&lt;h2 id="an-zhuang-stork"&gt;安装 Stork&lt;/h2&gt;
&lt;h3 id="an-zhuang-c-sheng-cheng-gong-ju"&gt;安装 C++ 生成工具&lt;/h3&gt;
&lt;p&gt;Stork 是基于 Rust 构建的工具，需要使用 Rust 的包管理器 Cargo 安装，若是在 macOS 或 Linux 系统上，直接按照官方文档给出的方法安装即可，而在 Windows 上就会比较麻烦，我在这里介绍一下 Windows 的操作方法。&lt;/p&gt;
&lt;p&gt;{note begin}后文所涉及的操作系统都是 Windows 10 系统，终端指的是 Windows 终端（Windows Terminal）。{note end}&lt;/p&gt;
&lt;p&gt;首先，在 Windows 上，Rust 需要某些 C++ 生成工具，可以选择安装 Visual Studio 或仅安装 Microsoft C++ 生成工具。安装 Visual Studio 的方法非常简单（推荐），按下不表，若仅安装 Microsoft C++ 生成工具，可以在终端中输入&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-sh"&gt;winget install Microsoft.VisualStudio.2022.BuildTools
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;由于 winget 下载速度感人，实在不推荐这种方法。&lt;/p&gt;
&lt;p&gt;在安装好 Visual Studio 后，在开始界面搜索并打开 Visual Studio Installer，选择 &lt;code&gt;修改&lt;/code&gt; - &lt;code&gt;使用 C++ 的桌面开发&lt;/code&gt;，等待安装完成。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="Visual Studio" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8654?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="Visual Studio" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8654?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h3 id="an-zhuang-rust"&gt;安装 Rust&lt;/h3&gt;
&lt;p&gt;Rust 也可以使用 winget 安装，命令很简单：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-sh"&gt;winget install rustup
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;但是不太好用，所以我还是选择到 &lt;a href="https://www.rust-lang.org/zh-CN/tools/install" rel="noopener" target="_blank"&gt;Rust 官网&lt;/a&gt;下载。下载完成后打开安装程序，弹出的是命令行窗口，默认安装在 &lt;code&gt;C:\Users&lt;/code&gt; 路径下的目录中，如果不需要额外的设置，键入 &lt;code&gt;1&lt;/code&gt; 后按回车即可。&lt;/p&gt;
&lt;p&gt;但由于 C 盘空间不太够了，我需要修改一下安装的路径，在目标路径下创建以下两个文件夹并新建环境变量：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-yaml"&gt;CARGO_HOME: E:\RUST\.cargo
RUSTUP_HOME: E:\RUST\.rustup
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在 &lt;code&gt;PATH&lt;/code&gt; 中添加变量 &lt;code&gt;%CARGO_HOME%&lt;/code&gt;、&lt;code&gt;%RUSTUP_HOME%&lt;/code&gt; 和 &lt;code&gt;%CARGO_HOME%\bin&lt;/code&gt;，然后再打开安装程序，默认路径就已经改变，键入 &lt;code&gt;1&lt;/code&gt; 按回车安装。&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-txt"&gt;Rustup metadata and toolchains will be installed into the Rustup
home directory, located at:

  E:\RustT\.rustup

This can be modified with the RUSTUP_HOME environment variable.

The Cargo home directory is located at:

  E:\Rust\.cargo

This can be modified with the CARGO_HOME environment variable.

The cargo, rustc, rustup and other commands will be added to
Cargo's bin directory, located at:

  E:\Rust\.cargo\bin
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;安装完成后，在终端中输入 &lt;code&gt;cargo --version&lt;/code&gt; 理应输出版本信息。&lt;/p&gt;
&lt;h3 id="tong-guo-cargo-an-zhuang-stork"&gt;通过 Cargo 安装 Stork&lt;/h3&gt;
&lt;p&gt;虽然安装好了 Cargo，但不出意外的话，与其他包管理器类似，从官方的源下载内容的速度非常之慢，所以需要修改配置使用镜像源。&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;.cargo&lt;/code&gt; 目录下创建文件 &lt;code&gt;config.toml&lt;/code&gt;，写入以下内容：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-toml"&gt;[source.crates-io]
replace-with = 'ustc'

[source.ustc]
registry = "git://mirrors.ustc.edu.cn/crates.io-index"
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;就使用了科大的镜像源，然后在终端中使用以下命令安装 Stork：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-sh"&gt;cargo install stork-search --locked
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最后可以使用 &lt;code&gt;stork --version&lt;/code&gt; 验证是否成功安装 Stork。&lt;/p&gt;
&lt;h2 id="bu-shu-pelican-search_1"&gt;部署 Pelican Search&lt;/h2&gt;
&lt;p&gt;安装好 Stork 后的步骤就很简单了，在 Pelican 的 Python 环境中安装插件：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-sh"&gt;python -m pip install pelican-search
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后在 Pelican 设置中的 &lt;code&gt;PLUGINS&lt;/code&gt; 引入 &lt;code&gt;search&lt;/code&gt;，在主题的模板文件（一般是 &lt;code&gt;base.html&lt;/code&gt;）中引入 Stork CSS 的 CDN（当然也可以改写后自己部署）：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-html"&gt;&amp;lt;link rel="stylesheet" href="https://files.stork-search.net/basic.css" /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;以及 JavaScript：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-html"&gt;&amp;lt;script src="https://files.stork-search.net/releases/v1.5.0/stork.js"&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script&amp;gt;
    stork.register("sitesearch", "{{ SITEURL }}/search-index.st")
&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最后就可以在设计的搜索区域通过以下方式调用 Stork 搜索了：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-html"&gt;Search: &amp;lt;input data-stork="sitesearch" /&amp;gt;
&amp;lt;div data-stork="sitesearch-output"&amp;gt;&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;{warn begin}以上 CSS 应在页面的头部，例如 &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; 中引入，而 JavaScript 则应在 &lt;code&gt;&amp;lt;body&amp;gt;&lt;/code&gt; 的尾部引入。这是因为 HTML 文件是自上至下顺序执行的，如果加载 JavaScript 的位置靠前，比如在 &lt;code&gt;&amp;lt;input data-stork="sitesearch" /&amp;gt;&lt;/code&gt; 元素之前引入，在执行时该元素还未生成，就会找不到匹配的搜索框，提示没有 &lt;code&gt;query selector `input[data-stork="sitesearch"]`&lt;/code&gt;，导致 &lt;code&gt;Uncaught StorkError&lt;/code&gt;。{warn end}&lt;/p&gt;
&lt;h3 id="pelican-search-de-she-zhi-xiang"&gt;Pelican Search 的设置项&lt;/h3&gt;
&lt;p&gt;pelican-search 的设置项只有两项，一项 &lt;code&gt;SEARCH_MODE&lt;/code&gt; 设定从 Markdown 文件建立索引还是从 HTML 建立索引，&lt;code&gt;SEARCH_HTML_SELECTOR&lt;/code&gt; 可以用于指定从 HTML 的哪些内容中建立索引。但 Stork 的设置项不止这些，将其整合进 pelican-search 应该也不太难，留到以后有精力的时候尝试一下。&lt;/p&gt;
&lt;p&gt;我浏览了一下 &lt;a href="https://stork-search.net/docs/config-ref" rel="noopener" target="_blank"&gt;Stork 官方文档&lt;/a&gt;中的内容，发现了很多很有意思的东西。例如 &lt;code&gt;minimum_indexed_substring_length&lt;/code&gt; 一项设置了建立索引的匹配项最短长度，默认值为 3，通俗来讲就是长于 3 的单词才会用于建立索引，那么在搜索时也需要起码键入 3 个字母才有结果。但这种做法对于中文来说就存在很大的问题，中文中最普遍的是双字词，所以文档中也提到 &lt;code&gt;minimum_index_ideographic_substring_length&lt;/code&gt; 一项设置，默认值是 1，对于 CJK 字符而言，长于 1 的词就可以建立索引。可惜在我的试验中这个设置貌似并没有效果，在我使用汉字搜索时，也必须输入 3 个汉字才有结果，若要搜索双字词，只好用两个汉字加上空格的方法将就一下。除了这个问题之外就是使用中文搜索的精度不高，很难找到匹配项，所以 Stork 的最大不足其实就在于对中文的支持不好。据作者的消息，他也很希望能够提高 Stork 在中文搜索上的表现，可以期待一下后续的更新。&lt;/p&gt;
&lt;p&gt;再来说说 Stork 的优点，那就是「快」。Stork 搜索的速度特别快，不论是汉字还是字母，击入三个字符秒出搜索结果，这一点的体验就特别好。另外 Stork 还支持包括英语在内的多种欧洲语言的词根检索，例如输入「get」，它亦能返回「getting」的检索结果，这个功能对于静态站点而言可谓强大。如果是英文语境下，Stork 搜索精度高、速度快、支持词根检索，简直是最为优雅的静态站点搜索插件，也期待一下后续它能否在中文搜索上也能提供如此流畅的体验。&lt;/p&gt;
&lt;p&gt;{note begin}不知是我的原因还是 Stork 的问题，生成的索引文件巨大，足足有 16 MB，完全不能在网页上使用。于是我花了一整天的时间升级 Nginx 并配置上了 Brotli 压缩传输，压缩后只有大约 900 KB 了，加载速度大大提升。{note end}&lt;/p&gt;
&lt;hr/&gt;
&lt;h2 id="references_1"&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://gist.github.com/maphew/95fb9e986edfab887e4ff36547d5da59" rel="noopener" target="_blank"&gt;Install Stork-search on Windows - GitHub Gist&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://learn.microsoft.com/zh-cn/windows/dev-environment/rust/setup" rel="noopener" target="_blank"&gt;在 Windows 上针对 Rust 设置开发环境 - Microsoft Learn&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.cnblogs.com/skzxc/p/12129353.html" rel="noopener" target="_blank"&gt;Win10 Rust 语言安装与环境变量配置(+VSCode) - 博客园&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://course.rs/first-try/slowly-downloading.html" rel="noopener" target="_blank"&gt;下载依赖太慢了？ - Rust语言圣经(Rust Course)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="碎碎念"></category><category term="Blog"></category><category term="Pelican"></category><category term="Rust"></category><category term="Windows"></category></entry><entry><title>文献总结｜为蛋白质口袋定制分子：用于基于结构药物设计的 Transformer 分子生成方法</title><link href="https://leonis.cc/sui-sui-nian/2023-03-11-summary-doi.org/10.48550/arXiv.2209.06158.html" rel="alternate"></link><published>2023-03-11T00:00:00+08:00</published><updated>2023-03-11T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-03-11:/sui-sui-nian/2023-03-11-summary-doi.org/10.48550/arXiv.2209.06158.html</id><summary type="html">&lt;p&gt;本文介绍由微软研究团队于 2022 年发布在 arXiv 上的一篇文章，文章原标题为 Tailoring Molecules for Protein Pockets: a Transformer-based Generative Solution for Structured-based Drug Design，文章使用 Transformer 构建了一种能够获取受体 3 维信息的分子生成模型 TamGent，其中分子生成部分使用了预训练模型，避免了训练数据有限的问题。&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;i class="fa fa-external-link"&gt;&lt;/i&gt; &lt;a href="https://doi.org/10.48550/arXiv.2209.06158" rel="noopener" target="_blank"&gt;doi.org/10.48550/arXiv.2209.06158&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本文介绍由微软研究团队于 2022 年发布在 arXiv 上的一篇文章，文章原标题为 Tailoring Molecules for Protein Pockets: a Transformer-based Generative Solution for Structured-based Drug Design，文章使用 Transformer 构建了一种能够获取受体 3 维信息的分子生成模型 TamGent，其中分子生成部分使用了预训练模型，避免了训练数据有限的问题。&lt;/p&gt;
&lt;p&gt;随着人工智能技术的发展，深度学习也进入到基于结构的药物设计（Structure Based Drug Design, SBDD）领域。SBDD 基于受体蛋白的结构设计与之适配的分子，是药物化学中的重要方法，而在深度学习辅助下的 SBDD 也将大大提升药物设计的效率，但目前这一方向还存在两个问题：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;用于训练模型的「靶点-药物分子对」有限；&lt;/li&gt;
&lt;li&gt;SBDD AI 模型还不能很好利用靶点活性口袋的 3 维信息。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;针对以上两个问题，文章首先使用分子数据预训练 Transformer 生成模型，使其学习到分子数据中更通用的特征，避免标签不足；其次，文章设计了一种变种的 Transformer encoder，通过 encoder 获得氨基酸序列中的 3 维结构信息，文章将最后得到的模型称为 TamGent（Target-aware molecule generator with Transformer）。&lt;/p&gt;
&lt;h2 id="fang-fa"&gt;方法&lt;/h2&gt;
&lt;h3 id="shu-ju"&gt;数据&lt;/h3&gt;
&lt;p&gt;文章使用来自于 PubChem 数据库中的 1000 万个分子的 SMILES 序列预训练用于分子生成的 Transformer decoder 模型，使用来源于文献（&lt;a href="https://arxiv.org/abs/2205.07249" rel="noopener" target="_blank"&gt;Luo et al.&lt;/a&gt;）的 12.3 万个靶点-配体对训练配体生成模型。&lt;/p&gt;
&lt;h3 id="mo-xing"&gt;模型&lt;/h3&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8650?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8650?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;使用 &lt;span class="math"&gt;\(\boldsymbol{a}=(a_1,a_2,\cdots,a_N)\)&lt;/span&gt; 表示氨基酸序列，其中 &lt;span class="math"&gt;\(a_i\)&lt;/span&gt; 为长度为 20 的 ont-hot 向量，可以用于表示 20 种氨基酸，使用 &lt;span class="math"&gt;\(\boldsymbol{r}=(r_1,r_2,\cdots,r_N)\)&lt;/span&gt; 表示相应的 3 维坐标，其中 &lt;span class="math"&gt;\(r_i\in\mathbb{R}^3\)&lt;/span&gt;。将配体分子的 SMILES 编码转化为向量 &lt;span class="math"&gt;\(\boldsymbol{y}=(y_1,y_2,\cdots,y_M)\)&lt;/span&gt;，那么模型训练的目标就是学习从 &lt;span class="math"&gt;\(\boldsymbol{x}=(\boldsymbol{a},\boldsymbol{r})\)&lt;/span&gt; 到 &lt;span class="math"&gt;\(\boldsymbol{y}\)&lt;/span&gt; 的映射。&lt;/p&gt;
&lt;p&gt;TamGent 的架构参考了变分自编码器的工作模式，也就是主要由活性口袋 encoder 和配体分子 decoder 构成，encoder 与 decoder 都使用了 Transformer 中的结构。&lt;/p&gt;
&lt;p&gt;配体分子 decoder 部分与 Transformer 完全一样，具有 self-attention 机制，能够根据生成的 toekn 生成下一个 token，完成分子生成，因此使用 1000 万个分子数据预训练该模型，使其能够根据数据集中分子的普遍特征生成分子。&lt;/p&gt;
&lt;p&gt;活性口袋 encoder 部分修改了其中的 attention 机制，文章中称为 distance-aware attention。具体来说，就是认为距离较远的氨基酸与配体的相互作用更小，所以将输入的氨基酸序列和坐标转化为特征矩阵后，再与 &lt;span class="math"&gt;\(\exp(-\mathrm{distance}^2/\tau)\)&lt;/span&gt; 相乘，距离越远的氨基酸的权重就会越小。&lt;/p&gt;
&lt;p&gt;在推断过程中，将氨基酸序列及其坐标输入模型，embedding 为特征矩阵后进入活性口袋 encoder 部分计算 distance-aware attention，得到活性口袋的表示，最后将其作为配体分子 decoder 部分中的 pocket-SMILES attention，生成分子得到预测的活性配体结果。&lt;/p&gt;
&lt;h2 id="jie-guo-yu-tao-lun_1"&gt;结果与讨论&lt;/h2&gt;
&lt;h3 id="sheng-cheng-fen-zi-jie-guo"&gt;生成分子结果&lt;/h3&gt;
&lt;p&gt;文章使用 DrugBank 数据库中 1641 个靶点-配体对的数据用于测试模型效果，随机抽取其中的 100 个靶点-配体对，使用 TamGent、3DGen 和 SECSE 三种模型针对每个靶点生成 20 个分子，对比生成效果。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8651?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8651?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;三种模型生成分子的对接打分中，TamGent 生成的分子明显更低，说明分子与靶点具有更好的亲和力，同时其平均值也与标签数据最为接近。对比三种模型生成的分子与标签分子的相似性，同样是 TamGent 具有更大的相似性，生成的分子最接近标签分子。同时，在 QED、MD 和 SA 几项的分子指标上，TamGent 也都高于其他两种模型，以上几点可以表明 TamGent 在 DrugBank 数据上根据靶点生成分子具有明显的优势。&lt;/p&gt;
&lt;h3 id="an-li-yan-jiu"&gt;案例研究&lt;/h3&gt;
&lt;p&gt;接下来文章使用 TamGent 针对于具体的靶点生成配体，分析模型表现。文章选择 SARS-CoV-2 主糖蛋白酶（&lt;em&gt;M&lt;/em&gt; &lt;sup&gt;pro&lt;/sup&gt;）作为靶点生成分子，收集了 415 个高分辨率结构后，使用模型生成了 4563 个分子，其中找到了先前报道过的一种 &lt;em&gt;M&lt;/em&gt; &lt;sup&gt;pro&lt;/sup&gt; 候选抑制剂（GC-376）和 6 个可能的先导化合物片段。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8652?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8652?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;上图展示了相应分子的二维分布，其中灰色表示在 PubChem 中随机选取的 3 万个分子，蓝色表示 TamGent 生成的分子，黄色表示在先前报道中提到了可能的 &lt;em&gt;M&lt;/em&gt; &lt;sup&gt;pro&lt;/sup&gt; 抑制剂。&lt;/p&gt;
&lt;p&gt;明显可以看出 TamGent 生成的分子与随机选取的分子具有不同的分布并且成簇聚集，主要分为 ① 和 ② 两簇。在第 ① 簇中，生成分子与 GC-376 的谷本相似度达到 0.82，并且此前报道的 6 种候选抑制剂都位于该簇中。但在第 ② 簇中没有找到对接分数较好的分子，只在分子中找到了一些可能的活性片段。&lt;/p&gt;
&lt;p&gt;最后文章选出了第 ① 簇中两个结构不同的分子与 &lt;em&gt;M&lt;/em&gt; &lt;sup&gt;pro&lt;/sup&gt; 对接，两种分子都能很好地填充活性口袋，对接分数分别为 -10.2 和 -9.5，而先前的 GC-376 是 -9.4，说明 TamGent 能够根据口性口袋生成具有良好活性的分子。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8653?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8653?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h2 id="jie-lun_1"&gt;结论&lt;/h2&gt;
&lt;p&gt;文章参考变分自编码器的结构使用 Transformer 构建了一种能够获取受体 3 维信息的分子生成模型 TamGent，其中分子生成部分使用了预训练模型，避免模型依赖于有限的「靶点-药物分子对」。在分子生成任务中，TamGent 生成分子的效果优于以往的两种模型，使用 TamGent 针对 SARS-CoV-2 主糖蛋白酶生成活性分子，甚至找到了比先前报道的候选抑制剂具有更好对接打分的分子，表现出 TamGent 的优异性能。&lt;/p&gt;
&lt;p&gt;对于 TamGent，文章提出了 3 点改进措施，第一是使用更多实验测试得到的「靶点-药物分子对」进一步优化模型，第二是在模型中整合考虑 ADMET 待药理性质，第三是在具体靶点上微调模型，使其帮助提升针对相应靶点的药物研发效率。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="碎碎念"></category><category term="Literature Summary"></category><category term="CADD"></category><category term="Transformer"></category><category term="VAE"></category></entry><entry><title>文献总结｜MolGPT：使用 Transformer 解码器模型实现分子生成</title><link href="https://leonis.cc/sui-sui-nian/2023-03-03-summary-doi.org/10.1021/acs.jcim.1c00600.html" rel="alternate"></link><published>2023-03-03T00:00:00+08:00</published><updated>2023-03-03T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-03-03:/sui-sui-nian/2023-03-03-summary-doi.org/10.1021/acs.jcim.1c00600.html</id><summary type="html">&lt;p&gt;本文介绍于 2022 年发表在 &lt;em&gt;Journal of Chemical Information and Modeling&lt;/em&gt; 上的一篇文章，文章原标题为 MolGPT: Molecular Generation Using a Transformer-Decoder Model，在 GPT 模型已经在自然语言处理领域得到了成功应用的背景下，这篇文章首次将 GPT 模型应用于完成分子生成的任务，实现了分子性质和结构两个方面的优化。&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;i class="fa fa-external-link"&gt;&lt;/i&gt; &lt;a href="https://doi.org/10.1021/acs.jcim.1c00600" rel="noopener" target="_blank"&gt;doi.org/10.1021/acs.jcim.1c00600&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本文介绍于 2022 年发表在 &lt;em&gt;Journal of Chemical Information and Modeling&lt;/em&gt; 上的一篇文章，文章原标题为 MolGPT: Molecular Generation Using a Transformer-Decoder Model，在生成预训练（Generative Pre-training, GPT）模型已经在自然语言处理领域得到了成功应用的背景下，这篇文章首次将 GPT 模型应用于完成分子生成的任务，实现了分子性质和结构两个方面的优化。&lt;/p&gt;
&lt;h2 id="fang-fa"&gt;方法&lt;/h2&gt;
&lt;h3 id="shu-ju"&gt;数据&lt;/h3&gt;
&lt;p&gt;分子数据来自于 MOSES 和 GuacaMol 的数据集，其中包括源于 Zinc 的 190 万个类先导化合物与源于 ChEMBL 的 160 万个分子，分子为 SMILES 形式，使用 RDKit 提取分子的骨架用于模型训练。&lt;/p&gt;
&lt;p&gt;此外，使用 RDKit 计算出分子的logP、SA、拓扑极性表面积（TPSA）和 QED，用于训练具有性质约束的模型。&lt;/p&gt;
&lt;h3 id="mo-xing"&gt;模型&lt;/h3&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8625?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8625?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;在得到原始分子的分子骨架与性质信息后，将分子性质与分子骨架序列连接在一起，称为「条件」，那么原始分子就成为需要 MolGPT 根据条件生成的「目标分子」。&lt;/p&gt;
&lt;p&gt;在训练过程中，将条件和目标分子序列一同送入 MolGPT，使模型建立条件与目标分子的关系。GPT 模型通过顺序读取每个 token，由当前 token 预测下一个 token，从而获得采样的权重。&lt;/p&gt;
&lt;p&gt;具体来说，分子 SMILES 词嵌入为 256 维的向量后，将性质条件和骨架条件也分别词嵌入为 256 维的向量，将其直接拼接在 SMILES 向量的起始端，就构成了实际输入模型的信息。&lt;/p&gt;
&lt;p&gt;在推理过程中，模型对训练集中的所有 token 根据权重随机取样得到第一个字符，接着模型就根据输入的条件（即目标性质与需要改造的分子骨架）和第一个字符生成下一个字符，直至生成整个分子。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8626?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8626?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;在 Transformer 中，encoder 模块对输入编码得到状态向量 &lt;span class="math"&gt;\(c\)&lt;/span&gt;，再由 decoder 模块对状态 &lt;span class="math"&gt;\(c\)&lt;/span&gt; 解码并运算产生输出，由于输入的情况是多种多样的，将其转化为等长的 &lt;span class="math"&gt;\(c\)&lt;/span&gt; 就有很大的局限性。GPT 模型减去了 Transformer 中的 encoder 模块，而保留了 Transformer 中例如 self-attention 在内的其他机制，具有更好的长文本处理能力。&lt;/p&gt;
&lt;h2 id="jie-guo-yu-tao-lun_1"&gt;结果与讨论&lt;/h2&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8632?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8632?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;首先使模型在不给定条件的情况下生成分子，即 MolGPT 根据从训练数据集中学习到的化学空间中的分子分布生成生成分子，生成的分子与训练集分子具有相似的特征。&lt;/p&gt;
&lt;p&gt;文章分析了 MolGPT 生成一个分子的过程，上图中的黑色横线表示当前步骤生成的字符（token），其他 token 上颜色的深浅表示了与生成该 token 之间的权重关系。&lt;/p&gt;
&lt;p&gt;可以看出，MolGPT 首先从已经学习到的分布中随机抽取出 &lt;code&gt;C&lt;/code&gt;，接着根据它继续生成后续 token，每个 token 都是由先前生成的 token 决定。同时还可以发现 MolGPT 在生成分子的过程中具有一定的「化学知识」，例如第一行中生成 &lt;code&gt;O&lt;/code&gt; 时，明显由前面的 &lt;code&gt;=&lt;/code&gt; 与 &lt;code&gt;N&lt;/code&gt; 决定，所以 MolGPT 不仅能够在双键上连接氧原子，还会构建酰胺结构使分子更稳定。&lt;/p&gt;
&lt;h3 id="xing-zhi-tiao-jian"&gt;性质条件&lt;/h3&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8627?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8627?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;文章接着只使用性质条件作为输入分子的条件，测试模型是否能按照要求生成满足约束的分子，结果如上图所示，与训练集中分子的性质分布不同，生成的分子集中在设定的性质条件（黑线）两侧，评估生成分子，各组分子的 validity、unique 和 novelty 都在0.97 以上，具有很好的效果。&lt;/p&gt;
&lt;p&gt;此外文章还同时使用多种性质约束作为模型条件，在保持较高的 validity、unique 和 novelty 条件下，生成的分子散落在设置性质条件的周围，所以模型对也能很好地处理多性质约束的分子生成。&lt;/p&gt;
&lt;h3 id="xing-zhi-yu-gu-jia-tiao-jian"&gt;性质与骨架条件&lt;/h3&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8628?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8628?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;接下来文章测试了将性质与分子骨架同时作为模型的生成条件，分析了生成分子的性质分布以及生成分子与设定分子骨架的谷本相似度。与仅性质条件的结果相比，额外加入分子骨架条件后生成分子的性质虽然有一些偏移（如上图 g），但仍然能大致满足性质约束。同时生成的分子与设定的分子骨架具有极高的相似性，从这两个可以证明 MolGPT 可以用于对给定的分子骨架进行指定性质的优化。&lt;/p&gt;
&lt;p&gt;最后文章展示了使用 MolGPT 实现分子骨架优化的例子：&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8631?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8631?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h2 id="jie-lun_1"&gt;结论&lt;/h2&gt;
&lt;p&gt;文章使用 GPT 构建了分子生成模型 MolGPT，MolGPT 生成的分子具有很高的 validity 和 uniqueness，在对 MolGPT 生成分子过程中的权重分析发现，MolGPT 能够很好学习到 SMILES 中所包含的化学语义。在实际应用上，MolGPT 可以根据指定的多种分子性质和（或）指定的分子骨架生成目标的分子，生成的分子能够很好满足预先设定的要求，有助于指导化合物优化的方向。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="碎碎念"></category><category term="Literature Summary"></category><category term="CADD"></category><category term="Transformer"></category><category term="GPT"></category></entry><entry><title>文献总结｜在大数据集中有效识别匹配分子对（MMPs）的算法</title><link href="https://leonis.cc/sui-sui-nian/2023-02-25-summary-doi.org/10.1021/ci900450m.html" rel="alternate"></link><published>2023-02-25T00:00:00+08:00</published><updated>2023-02-25T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-02-25:/sui-sui-nian/2023-02-25-summary-doi.org/10.1021/ci900450m.html</id><summary type="html">&lt;p&gt;本文介绍于 2010 年发表在 &lt;em&gt;Journal of Chemical Information and Modeling&lt;/em&gt; 上的一篇文章，文章原标题为 Computationally Efficient Algorithm to Identify Matched Molecular Pairs (MMPs) in Large Data Sets，文章介绍了一种在大规模数据中识别匹配分子对的算法，这种算法也就是目前用于生成匹配分子对的最常用方法。&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;i class="fa fa-external-link"&gt;&lt;/i&gt; &lt;a href="https://doi.org/10.1021/ci900450m" rel="noopener" target="_blank"&gt;doi.org/10.1021/ci900450m&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本文介绍于 2010 年发表在 &lt;em&gt;Journal of Chemical Information and Modeling&lt;/em&gt; 上的一篇文章，文章原标题为 Computationally Efficient Algorithm to Identify Matched Molecular Pairs (MMPs) in Large Data Sets，文章介绍了一种在大规模数据中识别匹配分子对的算法，这种算法也就是目前用于生成匹配分子对的最常用方法。&lt;/p&gt;
&lt;p&gt;匹配分子对（Matched Molecular Pairs, MMP）是指化合物 A 与化合物 B 之间只在单一位置具有结构差异的一对分子，所以 MMP 中的分子可以很容易地从一个化合物改变为另一个化合物。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8602?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8602?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;在面对先导化合物优化等问题时，传统且主流的做法仍然是依靠化学团队的经验。然而目前已经拥有化合物优化的海量数据，如果能得到其中蕴藏的经验和知识，将给予化学家很大的帮助并加快化合物优化的效率。MMP 就提供了从一批分子中获取化合物优化知识的一种方法，所以针对于识别分子数据集中 MMP 的算法，文章提出了两个要求：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;应当能识别数据集中所有的 MMP；&lt;/li&gt;
&lt;li&gt;计算效率高，能够适用于具有大量分子的数据集。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="fang-fa"&gt;方法&lt;/h2&gt;
&lt;p&gt;文章中提出的识别 MMP 算法可以归纳为以下几步：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;每次在一个化合中一处两个非氢原子间的非环单键处切断，在每个切断位点执行该操作，直至将数据集中所有分子分割为所有可能的片段。&lt;/li&gt;
&lt;li&gt;每次切断后，都要索引两个片段。具体来说，分子 &lt;span class="math"&gt;\(\rm{A&amp;mdash;B}\)&lt;/span&gt; 切断为 &lt;span class="math"&gt;\(\rm{A*}\)&lt;/span&gt; 与 &lt;span class="math"&gt;\(\rm{* B}\)&lt;/span&gt; 后，需要建立 &lt;span class="math"&gt;\(\{\rm{key:value}\}\)&lt;/span&gt; 的索引，即 &lt;span class="math"&gt;\(\{\rm{A*:* B}\}\)&lt;/span&gt; 和 &lt;span class="math"&gt;\(\{\rm{* B:A*}\}\)&lt;/span&gt;。&lt;/li&gt;
&lt;li&gt;下一次切断得到的片段若与已建立索引的 &lt;span class="math"&gt;\(\rm{key}\)&lt;/span&gt; 相同，就更新到相应的字典中。例如又得到了 &lt;span class="math"&gt;\(\rm{A* }\)&lt;/span&gt; 与 &lt;span class="math"&gt;\(\rm{* C}\)&lt;/span&gt;，那么索引就会更新为 &lt;span class="math"&gt;\(\{\rm{A*:* B,* C}\}\)&lt;/span&gt;，新增 &lt;span class="math"&gt;\(\{\rm{* C: A*}\}\)&lt;/span&gt;，保留 &lt;span class="math"&gt;\(\{\rm{* B: A*}\}\)&lt;/span&gt;。&lt;/li&gt;
&lt;li&gt;在处理完所有分子后，相同 &lt;span class="math"&gt;\(\rm{key}\)&lt;/span&gt; 索引中的片段就揭示了 MMP 的化学转化，例如 &lt;span class="math"&gt;\(\rm{*B\rightarrow*C}\)&lt;/span&gt;，将键值对重新组合后同时也得到了目标的 MMP，例如 &lt;span class="math"&gt;\([\rm{A&amp;mdash;B,A&amp;mdash;C}]\)&lt;/span&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这种方法还可以推广到在同一分子中多次切断，识别单次切断可能会遗漏的 MMP。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8603?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8603?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;对于化学家而言，例如 &lt;span class="math"&gt;\(\rm{*B\rightarrow*C}\)&lt;/span&gt; 的转化规则，若该结构太大，那么通过这种转化得到的 MMP 也是没有实际意义的。所以为了避免用于替换的子结构过大，还可以设定只切断不超过 n 个非氢原子的子结构。&lt;/p&gt;
&lt;h2 id="jie-guo-yu-tao-lun"&gt;结果与讨论&lt;/h2&gt;
&lt;p&gt;文章所使用的分子数据库包含有 333332 个化合物，通过该算法使用单核 CPU 经过约 850 min 后，得到了 5310964 对 MMP。&lt;/p&gt;
&lt;p&gt;在得到的 MMP 中也存在一些问题，例如羧酸到酰胺是一类常见的结构转化，但在得到的结果中，羧酸到酰胺的转化的结果也会混入到醇到胺的转化中，因为这两种结构转化从分子表示上来看都是将羟基替换为氨基，而这两种结构转化的性质截然不同，就会导致下游的分子性质预测、结构改造任务出现问题。&lt;/p&gt;
&lt;p&gt;一种妥善的解决方法就是在切断步骤中，不切断官能团间的单键，保证 MMP 中的分子都具有相同的官能团，不互相混淆。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8604?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8604?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;另一个问题是一些化学转化是在环结构上进行结构改造，由于切断的操作只会在单键之间执行，所以对于这一类的化学转化，MMP 必须找到单键切下整个环结构。而对于一些稠环结构，很容易就超出了设定的 n 个非氢原子的约束，无法获得这一类化学转化。&lt;/p&gt;
&lt;p&gt;一个改进的方向就是设定若切下的子结构为纯粹的环结构，那么不计算原子数量直接建立索引，这样既获得到环结构上的化学转化，又避免了混入超过 n 原子的无意义转化。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8605?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8605?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;最后，文章只将在一个分子中切断 1 次的操作推广到了 3 次。实验结果发现，在一个分子中切断 3 次后，就可以找到数据集中几乎全部的 MMP，切断次数越多，效果提升越少，计算开销越大，所以在实际使用中，3 次切断就已经是可行的。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8606?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8606?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h2 id="jie-lun"&gt;结论&lt;/h2&gt;
&lt;p&gt;文章提出了一种适用于在较大的分子数据集中识别 MMP 的算法，这种算法能够帮助人们从过去所累积的分子改造数据中获取化学改造的知识，结合分子的各种实际评估数据，这种方法能够更全面地构建出药物分子的构效关系，解决实际中先导化物优化方面的问题。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="碎碎念"></category><category term="Literature Summary"></category><category term="CADD"></category><category term="Algorithm"></category></entry><entry><title>为 Pelican 博客写插件——在文章中插入豆瓣图书</title><link href="https://leonis.cc/sui-sui-nian/2023-02-22-create-pelican-plugin.html" rel="alternate"></link><published>2023-02-22T00:00:00+08:00</published><updated>2023-02-22T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-02-22:/sui-sui-nian/2023-02-22-create-pelican-plugin.html</id><summary type="html">&lt;p&gt;突然想把豆瓣图书信息插入到文章中，便于在博客里记录阅读笔记。寻找了一圈无果，只好自己动手写个插件，也正好研究了下 Pelican 插件的工作方式。&lt;/p&gt;</summary><content type="html">&lt;p&gt;在博客上记录读书笔记是一件寻常事，但是怎么在文章中插入图书信息却是件恼人的事。直接用书名号引出？不不不，这也太不够美观了。参考一下国内图书信息最全面的豆瓣：&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8594?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8594?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;错不了，就要像这样把图书封面、出版社还有 ISBN 等等全部展示出来，才能让人满意。但是一个个截图也太麻烦了，而且信息没法更新，将这些信息都嵌入在网页中才是最好的实现方式。比较流行的博客框架例如 Hexo 和 WordPress 都有实现类似功能的插件，而我使用的是比较小众的 Pelican，只好自己动手了。&lt;/p&gt;
&lt;h2 id="mu-biao"&gt;目标&lt;/h2&gt;
&lt;p&gt;我在博客上写作的流程是 &lt;code&gt;撰写 Markdown&lt;/code&gt; ⇨ &lt;code&gt;使用 Pelican 生成 HTML&lt;/code&gt;，为了实现在文章中插入豆瓣图书，比较方便的方法是在 Markdown 写作时，在需要插入图书的地方写下 &lt;code&gt;{GET BOOK URL}&lt;/code&gt;，其中 &lt;code&gt;BOOK&lt;/code&gt; 填写书籍名称，&lt;code&gt;URL&lt;/code&gt; 填写书籍链接。当 URL 无效时，保留这条指令，避免遗失原来的信息；当从 URL 成功获取了图书元数据后，就将该条命令转换为 HTML 格式的图书信息，就顺利插入文章中了。&lt;/p&gt;
&lt;p&gt;本文介绍的代码可以在 &lt;a href="https://github.com/Tseing/pelican-bookshelf" rel="noopener" target="_blank"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt; Tseing/pelican-bookshelf&lt;/a&gt;  上找到。&lt;/p&gt;
&lt;h2 id="pelican-mo-kuai"&gt;Pelican 模块&lt;/h2&gt;
&lt;p&gt;先从 Pelican 插件的原理讲起，Pelican 插件使用了信号机制，所谓信号机制就是在工作流程中，完成特定任务后就会给出特定信号，可以使用这种信号触发插件，完成正常工作流程以外额外的工作。那么在正式写插件之前，还需要了解一下 Pelican 的正常工作模块，具体可以分为以下 3 种：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Writers：负责写文件的模块，例如生成 HTML、RSS 等，Writers 模块需要创建对象，并将其传递给 Generators 模块。&lt;/li&gt;
&lt;li&gt;Readers：用于读文件的模块，读取文件并返回元数据（作者、日期等）和用于生成 HTML 网页的内容。&lt;/li&gt;
&lt;li&gt;Generators：产生各种各样的输出，是工作流程中的最后部分。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;回头考虑我的目标，我所要编写的插件显然是一个 Reader 模块，当读取到 Markdown 中的图书指令时开始工作，并将替换的内容传递给 Generators 模块生成最终页面。&lt;/p&gt;
&lt;p&gt;但是由于 Pelican 文档中给出的相关介绍太少，再读了几遍源码之后仍觉得无从下手，最后我并没有使用官方推荐的方法，用了更简单粗暴的办法，可能以后有精力了会尝试再改成 Reader 模块。&lt;/p&gt;
&lt;h2 id="dou-ban-pa-chong"&gt;豆瓣爬虫&lt;/h2&gt;
&lt;p&gt;从指定的 URL 获取图书信息就要用爬虫了，网上关于爬虫的介绍多如牛毛，我只简单讲述一下我的设计过程。爬网解析 HTML 页面可以使用 Beautiful Soup 和 lxml 两个库，因为我需要使用的这个爬虫将在 Pelican 生成网页的过程中调用，虽然 Beautiful Soup 的功能强大也更好上手，但它的性能是不如 lxml 的，所以最后我还是选择使用 lxml。&lt;/p&gt;
&lt;p&gt;爬虫并不复杂，通过 request 获取 HTML 信息后，使用 Xpath 定位到目标信息的节点，例如目标信息的结构为&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-html"&gt;&amp;lt;div id="info" class=""&amp;gt;
    &amp;lt;span&amp;gt;
      &amp;lt;span class="pl"&amp;gt; 作者&amp;lt;/span&amp;gt;:
            &amp;lt;a class="" href="/author/4550936"&amp;gt;海子&amp;lt;/a&amp;gt;
    &amp;lt;/span&amp;gt;&amp;lt;br/&amp;gt;
    &amp;lt;span class="pl"&amp;gt;出版社:&amp;lt;/span&amp;gt;
      &amp;lt;a href="https://book.douban.com/press/2145"&amp;gt;江西人民出版社&amp;lt;/a&amp;gt;
    &amp;lt;br&amp;gt;
    &amp;lt;span class="pl"&amp;gt;出品方:&amp;lt;/span&amp;gt;
      &amp;lt;a href="https://book.douban.com/producers/10"&amp;gt;果麦文化&amp;lt;/a&amp;gt;
    &amp;lt;br&amp;gt;
    &amp;lt;span class="pl"&amp;gt;出版年:&amp;lt;/span&amp;gt; 2017-10&amp;lt;br/&amp;gt;
    &amp;lt;span class="pl"&amp;gt;页数:&amp;lt;/span&amp;gt; 193&amp;lt;br/&amp;gt;
    &amp;lt;span class="pl"&amp;gt;定价:&amp;lt;/span&amp;gt; 42.00元&amp;lt;br/&amp;gt;
    &amp;lt;span class="pl"&amp;gt;装帧:&amp;lt;/span&amp;gt; 精装&amp;lt;br/&amp;gt;
    &amp;lt;span class="pl"&amp;gt;丛书:&amp;lt;/span&amp;gt;
    &amp;lt;a href="https://book.douban.com/series/43038"&amp;gt;果麦经典&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;
    &amp;lt;span class="pl"&amp;gt;ISBN:&amp;lt;/span&amp;gt; 9787210097136&amp;lt;br/&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;获取出版社信息的脚本就可以这么写：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-py"&gt;def get_press(meta, selector):
    regex = '//div[@id="info"]/child::span[contains(text(), "出版社")]/following-sibling::*[1]/text()'
    match = selector.xpath(regex)
    if match:
        meta["出版社"] = str(match[0])
    else:
        meta["出版社"] = "暂无"
    return meta
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;regex&lt;/code&gt; 是需要匹配的 Xpath 路径，&lt;code&gt;//div[@id="info"]&lt;/code&gt; 为全文查找属性为 &lt;code&gt;id="info"&lt;/code&gt; 的 &lt;code&gt;&amp;lt;div&amp;gt;&lt;/code&gt; 节点。&lt;code&gt;child::span[contains(text(), "出版社")]&lt;/code&gt; 为在其子节点查找包含「出版社」文字的 &lt;code&gt;&amp;lt;span&amp;gt;&lt;/code&gt; 节点，在这个节点之后的一个节点就是出版社信息了。&lt;/p&gt;
&lt;p&gt;用类似的方法就可以得到全部的出版信息，我把所有 Xpath 路径列在下方，随时可以取用，但是注意如果豆瓣更改了网页结构可能就会失效。&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-python"&gt;# 封面图片
regex = '//img[@rel="v:photo"]/@src'
# 作者
regex = '//div[@id="info"]/span[child::span[@class="pl"][contains(text(), "作者")]]//text()'
# 出版社、出品方、丛书等 &amp;lt;a&amp;gt; 标签内容
tags = ["出版社", "出品方", "丛书"]
regex = f'//div[@id="info"]/child::span[contains(text(), "{tag}")]/following-sibling::*[1]/text()'
# 其他非 &amp;lt;a&amp;gt; 标签出版信息
tags = ["出版年", "页数", "定价", "装帧", "ISBN"]
regex = f'//text()[preceding-sibling::span[1][contains(text(),"{tag}")]][following-sibling::br[1]]'
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id="he-xin-dai-ma"&gt;核心代码&lt;/h2&gt;
&lt;p&gt;在解决了爬虫之后剩下的就是替换文本的一个简单任务了，由于爬虫的速度相对较慢，如果每次生成网页都要把所有 URL 都重新爬一遍，一来会大大降低生成速度，二来如此大量的请求很容易被网页反爬，所以我将原来的目标分成了两个功能。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;生成网页后，将 HTML 文件中所有 &lt;code&gt;{GET BOOK URL}&lt;/code&gt; 字段替换为图书信息。&lt;/li&gt;
&lt;li&gt;如果指定了 &lt;code&gt;SAVE_TO_MD&lt;/code&gt;，那么除生成的网页之外，原始的 Markdown 文件也会被修改，下一次生成网页时就不需要重新爬虫。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这两个功能的具体操作相同，所以用同一个函数实现即可：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-py"&gt;def replace(path, context=None):
    suffix = os.path.splitext(str(path))[-1]
    if suffix != ".html" and suffix != ".md":
        pass
    elif suffix == ".md" and not BOOKSHELF_SETTING["SAVE_TO_MD"]:
        pass
    else:
        pattern = r"\{GET\s\S+\s[a-zA-z]+://[^\s]*\}"
        with open(str(path), 'r', encoding="utf-8") as f:
            s = f.read()
            search_target = re.search(pattern, s)
            while search_target is not None:
                _, book, url = search_target.group().strip("{}").split()
                html = get_page(url)
                time.sleep(BOOKSHELF_SETTING["WAIT_TIME"])
                if html is not None:
                    meta = parse_page(html)
                    s = s.replace(search_target.group(), generate_bookshelf(meta, book))
                    search_target = re.search(pattern, s)
                else:
                    search_target = re.search(pattern, s)
                    continue
        with open(str(path), 'w', encoding="utf-8") as f:
            f.write(s)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;代码也十分简单，就是根据路径打开文件，通过反复通过正则表达式搜索匹配的内容并用生成的 HTML 片段替换。在每次爬虫请求之后，我加入了一个 2 秒钟的延时，否则太容易被豆瓣屏蔽了。&lt;/p&gt;
&lt;h2 id="zhu-ce-cha-jian"&gt;注册插件&lt;/h2&gt;
&lt;p&gt;就像上文所说的，这是因为 Pelican 可以通过信号像管道一样将插件接入正常的工作流中，这里介绍两个信号：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;content_object_init(content_object)&lt;/code&gt;：在读取完所有文件后，准备通过 Generators 模块生成 HTML 时的信号。这个信号传递的参数是 &lt;code&gt;content_object&lt;/code&gt;，也就是目前读取完文件的对象，使用 &lt;code&gt;str(content_object)&lt;/code&gt; 能直接将文件转换为文件路径，将其传递给 &lt;code&gt;replace&lt;/code&gt; 函数就能将修改原始的 Markdown 文件，但由于文件已经读取完成了，所以不会影响输出文件中的内容。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;content_written(path, context)&lt;/code&gt;：Generators 模块输出文件后的信号，每输出一个文件就会引发一次该信号。信号传递的参数是 &lt;code&gt;path&lt;/code&gt; 和 &lt;code&gt;context&lt;/code&gt;，&lt;code&gt;path&lt;/code&gt; 是输出文件的路径，&lt;code&gt;context&lt;/code&gt; 是例如修改日期等的其他信息，所以 &lt;code&gt;replace&lt;/code&gt; 函数同样接受 &lt;code&gt;path&lt;/code&gt; 参数进行处理，Pelican 每生成一个文件，&lt;code&gt;replace&lt;/code&gt; 函数就检查是否有匹配的命令并替换，而不会改变原始 Markdown 文件。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;最后通过以下方式将 &lt;code&gt;replace&lt;/code&gt; 注册到相应的信号上，就可以使用了。&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-py"&gt;def register():
    pelican.signals.initialized.connect(init_config)
    pelican.signals.content_object_init.connect(replace)
    pelican.signals.content_written.connect(replace)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;当然插件的功能只是在文件中插入了 HTML 片段，以下是个样例；&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-html"&gt;&amp;lt;div class="bookshelf"&amp;gt;
  &amp;lt;div class="book"&amp;gt;
    &amp;lt;img src="https://img2.doubanio.com/view/subject/s/public/s29610741.jpg" referrerPolicy="no-referrer"/&amp;gt;
    &amp;lt;div class="infos"&amp;gt;
      &amp;lt;a class="title" href="https://book.douban.com/subject/27154094/"&amp;gt;海子的诗&amp;lt;/a&amp;gt;
      &amp;lt;div class="作者"&amp;gt;作者：海子&amp;lt;/div&amp;gt;
      &amp;lt;div class="出版社"&amp;gt;出版社：江西人民出版社&amp;lt;/div&amp;gt;
      &amp;lt;div class="出版年"&amp;gt;出版年：2017-10&amp;lt;/div&amp;gt;
      &amp;lt;div class="页数"&amp;gt;页数：193&amp;lt;/div&amp;gt;
      &amp;lt;div class="定价"&amp;gt;定价：42.00元&amp;lt;/div&amp;gt;
      &amp;lt;div class="ISBN"&amp;gt;ISBN：9787210097136&amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;只要编写好 CSS 样式再套上去，就能得到很不错的效果啦。&lt;/p&gt;
&lt;h2 id="demo"&gt;Demo&lt;/h2&gt;
&lt;p&gt;最后看一看插件的效果吧 :）&lt;/p&gt;
&lt;div class="bookshelf"&gt;
&lt;div class="book"&gt;
&lt;img referrerpolicy="no-referrer" src="https://img2.doubanio.com/view/subject/s/public/s29610741.jpg"&gt;
&lt;div class="infos"&gt;
&lt;a class="title" href="https://book.douban.com/subject/27154094/"&gt;海子的诗&lt;/a&gt;
&lt;div class="作者"&gt;作者：海子&lt;/div&gt;
&lt;div class="出版社"&gt;出版社：江西人民出版社&lt;/div&gt;
&lt;div class="出版年"&gt;出版年：2017-10&lt;/div&gt;
&lt;div class="页数"&gt;页数：193&lt;/div&gt;
&lt;div class="定价"&gt;定价：42.00元&lt;/div&gt;
&lt;div class="ISBN"&gt;ISBN：9787210097136&lt;/div&gt;
&lt;/div&gt;
&lt;/img&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id="zi-ji-de-hua"&gt;自己的话&lt;/h2&gt;
&lt;p&gt;其实我之前从未用过爬虫，写这个插件也是一时兴起，最后花了 2 天时间简单地完成了。虽然国内使用 Pelican 的人非常少，甚至在国际上使用的人也不多，但正因为这是一个如此小的社区，并没有丰富的插件，所以我也能自豪地参与其中并为它做贡献。&lt;/p&gt;
&lt;p&gt;关于上文所提到的目标，最好的实现方式并不是爬虫，因为爬虫速度慢、发起的大量请求对服务器也并不友善，更好的方式是使用官方的 API。使用官方 API 发起的请求与对网页的请求不是同一个入口，不会影响网站的正常访问，而且需要的数据都在 JSON 中，不用费力不讨好地去解析 HTML。&lt;/p&gt;
&lt;p&gt;然而遗憾的是，四五年前豆瓣就并闭了它的 API，原来使用 API 的「互联网难民」也转向了使用爬虫，面对于海量的爬虫，豆瓣与网友之间最终陷入到了反爬虫与爬虫的零和博弈。我相信不用多久，文章中提到的爬虫方式就会无法使用，又不得不继续参加到这场博弈中去。不知在哪看到的一句话：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;cite&gt;中国互联网公司之间，是没有 API 的，通用的 API 就是硬爬。&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;不禁苦笑，真是「萧瑟秋风今又是，换了人间」，我们正在见证着互联网走向封闭，明天又会是什么样呢？&lt;/p&gt;</content><category term="碎碎念"></category><category term="Blog"></category><category term="Pelican"></category><category term="Python"></category><category term="XPath"></category></entry><entry><title>文献总结｜通过大规模化学语言表示捕获分子结构和性质</title><link href="https://leonis.cc/sui-sui-nian/2023-02-17-summary-doi.org/10.1038/s42256-022-00580-7.html" rel="alternate"></link><published>2023-02-17T00:00:00+08:00</published><updated>2023-02-17T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-02-17:/sui-sui-nian/2023-02-17-summary-doi.org/10.1038/s42256-022-00580-7.html</id><summary type="html">&lt;p&gt;本文介绍于 2022 年发表在 &lt;em&gt;Nature Machine Intelligence&lt;/em&gt; 上的一篇文章，文章原标题为 Large-scale chemical language representations capture molecular structure and properties，文章使用大量来自 PubChem 和 ZINC 的分子训练了基于 Transformer 的化学语言模型，该模型将原始的 SMILES 序列转化为向量，文章结果表明，使用这种方式实现的分子词嵌入在许多任务上都表现优异。&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;i class="fa fa-external-link"&gt;&lt;/i&gt; &lt;a href="https://doi.org/10.1038/s42256-022-00580-7" rel="noopener" target="_blank"&gt;doi.org/10.1038/s42256-022-00580-7&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本文介绍于 IBM 研究中心于 2022 年发表在 &lt;em&gt;Nature Machine Intelligence&lt;/em&gt; 上的一篇文章，文章原标题为 Large-scale chemical language representations capture molecular structure and properties，文章使用大量来自 PubChem 和 ZINC 的分子训练了基于 Transformer 的化学语言模型，该模型将原始的 SMILES 序列转化为向量，文章结果表明，使用这种方式实现的分子词嵌入在许多任务上都表现优异。&lt;/p&gt;
&lt;p&gt;在深度学习领域，SMILES 是最为常用的分子表示形式，但越来越多研究结果表明，SMILES 无法反映分子的拓扑结果，在许多任务上都有局限性。这使得许多研究人员转向使用基于图的分子表示方式，然而由于缺少用于训练的标记数据，研究这一类模型也具有很大挑战。&lt;/p&gt;
&lt;p&gt;预训练语言模型是近年 NLP 领域中的热点，先使用大量语料训练语言模型，再微调该预训练模型并用于解决具体任务。借鉴这一概念，文章的目标就是使用庞大的分子数据集（11 亿个分子）训练化学语言模型，让该模型能够捕获分子的深层特征，并用它来完成各种分子预测的下游任务。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8580?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8580?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h2 id="fang-fa"&gt;方法&lt;/h2&gt;
&lt;h3 id="mo-xing"&gt;模型&lt;/h3&gt;
&lt;p&gt;文章所使用的模型称为 MoLFormer，该模型通过对 Transformer 改造得到，减小了计算开销，适用于处理大量数据。在 Transformer 中，输入序列中的每个位置上的 token 都会通过位置嵌入将位置信息加入到词向量中。由于 self-attention 机制，Transformer 在每个位置 &lt;span class="math"&gt;\(m\)&lt;/span&gt; 上需要计算：&lt;/p&gt;
&lt;div class="math"&gt;$$\mathrm{Attention}_m(Q,K,V)=\frac{\sum_{n=1}^N\exp(\langle q_m,k_n\rangle)v_n}{\sum_{n=1}^N\exp(\langle q_m,k_n\rangle)}$$&lt;/div&gt;
&lt;p&gt;指数计算的计算开销很大，可以用核函数近似的方法简化计算（Vanilla Transforme），得到线性注意力：&lt;/p&gt;
&lt;div class="math"&gt;$$\mathrm{Attention}_m(Q,K,V)=\frac{\sum_{n=1}^N\langle\varphi(q_m),\varphi(k_n)\rangle v_n}{\sum_{n=1}^N\langle\varphi(q_m),\varphi(k_n)\rangle}$$&lt;/div&gt;
&lt;p&gt;此外，文章还引入了旋转位置嵌入（Rotary Position Embeddings, RoPE）替换了原来的位置嵌入方式。RoPE 是一种新的位置编码技术，旨在理解文本中单词的顺序表示，在化学语言模型中，它可能能够更好地捕捉 token 之间的内在关系，表示出分子的拓扑结构。&lt;/p&gt;
&lt;p&gt;在训练上，文章使用了掩码语言模型方法，选出 15% 的 token 作为噪声，其中 80% 的 token 将随机地被 &lt;code&gt;[MASK]&lt;/code&gt; 代替，10% 随机替换为其他 token，其他 10% 不变。通过这种方法可以强迫模型不依赖于 token，而是依赖于上下文做出判断，增强模型的稳健性。&lt;/p&gt;
&lt;h3 id="shu-ju"&gt;数据&lt;/h3&gt;
&lt;p&gt;来自 PubChem 的 1.1 亿个分子和来自 ZINC 的 10 亿个分子构成了训练数据，所有分子经过 RDKit 规范化后用于分词，总共得到 2357 个不重复的 token，设置 202 token 为模型输出的最长序列。&lt;/p&gt;
&lt;h2 id="jie-guo_1"&gt;结果&lt;/h2&gt;
&lt;p&gt;MoLFormer 作为一种通用的预训练模型，在经过大数据集的训练后，再使用不同的标准分子数据集微调模型，完成 MoleculeNet 中的分类与回归任务，并将其结果与多种基线模型的表现对比，验证 MoLFormer 的编码效果。在 AUC-ROC 数据中，MoLFormer 在 6 组数据集上获得了 3 组最优表现，显著优于其他基线模型。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8581?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8581?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;除此之外，文章还对比了 MoLFormer 和与之类似的预训练模型 ChemBerta 编码分子的能力。文章从 PubChem 数据集中随机挑选 10000 对分子，计算每对分子指纹相似性与预训练模型得到的词嵌入相似性之间的相关系数，计算每对分子最大公共子图（Maximum Common Subgraph, MCS）中原子数量与两词嵌入欧氏距离之间的相关系数。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8591?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8591?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;实验结果中，在两个对比的指标上，MoLFormer 都具有更大的相关性，说明通过它得到的词嵌入能够更好地反映分子结构特征，即两分子的分子指纹相似性越高，表示两分子的向量也越相似；两分子的共有结构越大，表示两分子向量之间的距离也更小。&lt;/p&gt;
&lt;p&gt;最后，文章分析了 MoLFormer 学习到的注意力矩阵。随机选取分子，绘制各原子间的化学键连接矩阵和 3D 距离矩阵，与相应的 MoLFormer 全注意力矩阵和线性注意力矩阵对比，可以看出，线性注意力矩阵与分子的化学键连接矩阵和 3D 距离矩阵具有部分相似的权重，这可能解释了 MoLFormer 编码后为什么能保留分子的结构特征。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8592?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8592?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h2 id="jie-lun"&gt;结论&lt;/h2&gt;
&lt;p&gt;文章使用大规模数据训练了基于 Transformer 的化学语言模型，经过实验对比，这种通用的预训练模型可以很好地通过微调迁移到其他数据集上完成包括分类、回归在内的任务，并且取得了优异的表现。此外，文章还确定了通过该模型得到的词嵌入能够反映分子的结构，同时比以往类似模型具有更好效果。&lt;/p&gt;
&lt;p&gt;文章主要对 Transformer 中的注意力机制做了改造，使用线性注意力减少计算开销，大大加快了训练速度，因此才能在 11 亿个分子的大规模数据上完成学习过程。文章还使用 RoPE 提高模型识别上下文的效果，这可能也是该模型具有更优表现的原因。目前预训练的通用语言模型如 GPT 和 Bart 等在 NLP 领域大放异彩，而对于这一类化学语言模型的研究还很少，它具有助力完成下游分子预测等任务的潜力。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="碎碎念"></category><category term="Literature Summary"></category><category term="CADD"></category><category term="Transformer"></category></entry><entry><title>Pelican + Nginx 在服务器上搭载静态博客</title><link href="https://leonis.cc/sui-sui-nian/2023-02-13-deploy-pelican-by-nginx.html" rel="alternate"></link><published>2023-02-13T00:00:00+08:00</published><updated>2023-02-13T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-02-13:/sui-sui-nian/2023-02-13-deploy-pelican-by-nginx.html</id><summary type="html">&lt;p&gt;去年购置了一个服务器，由于后来太忙，一直没有时间折腾，终于有一段空闲的时间了，就尝试把我的 Pelican Blog 从 GitHub Pages 搬迁到服务器上，再通过 Nginx 部署我的站点。&lt;/p&gt;</summary><content type="html">&lt;p&gt;去年黑色星期五低价购置了一个海外服务器，由于后来太忙，一直没有时间折腾，终于有一段空闲的时间了。想到的我博客一直部署在 GitHub Pages 上，访问速度慢不说，还会由于各种的原因时常无法连接，所以动手把它搬到自己的服务器上吧。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8514?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8514?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;上图是我的部署方案，首先使用 Pelican（或其他静态博客生成器）在本地生成静态网页，再将静态网页 push 到 GitHub 仓库，这两步也是在 GitHub Pages 上部署、更新博客的步骤，所以对我而言没有额外的负担。&lt;/p&gt;
&lt;p&gt;接着在服务器上 pull 静态网页，然后使用 Nginx 作为 HTTP 服务器就可以通过域名或是公网 IP 访问到网站了。虽然 Pelican 也自带有 HTTP 服务器，可以不使用 Nginx，但我觉得它的性能和通用性方面不够好，而且我主要在 PC 上写文章，在服务器上安装 Pelican 并在服务器上生成静态网页未免太繁琐。&lt;/p&gt;
&lt;p&gt;最后为了便于管理服务器上的文件和排查问题，可以使用 SFTP 直接上传和下载服务器文件。&lt;/p&gt;
&lt;p&gt;{warn begin}在境内服务器上部署网站必须经过 TCP 备案，否则会被拦截或是限流，引起非常多的麻烦。{warn end}&lt;/p&gt;
&lt;h2 id="pei-zhi-nginx"&gt;配置 Nginx&lt;/h2&gt;
&lt;p&gt;在 Debian 系统上可以使用以下命令安装 Nginx：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;# Debian
$ sudo apt install nginx
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;安装完成后可 &lt;code&gt;nginx -v&lt;/code&gt; 检查 Nginx 的版本。使用 &lt;code&gt;http://服务器 IP&lt;/code&gt; 访问 Web 服务器，不出意外的话，会出现如下页面，提示已经成功安装了 Nginx：&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8515?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8515?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;如果没有出现 Nginx 的欢迎页面，就需要检查服务器防火墙的设置，由于各个系统的防火墙设置不同，这里就不给出设置的方法了。&lt;/p&gt;
&lt;p&gt;然后需要在 &lt;code&gt;/etc/nginx/sites-available&lt;/code&gt; 中建立我们站点的 Nginx 配置:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;$ cd /etc/nginx/sites-available
$ sudo touch blog
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在 Nginx 设计中，在 &lt;code&gt;sites-available&lt;/code&gt; 目录下存放站点的配置文件，并将其链接到 &lt;code&gt;sites-enabled&lt;/code&gt; 目录下。&lt;code&gt;sites-enabled&lt;/code&gt; 目录下存放了启用站点的配置，若要关闭该站点的配置，删除该链接即可。&lt;/p&gt;
&lt;p&gt;通过以下命令进入 &lt;code&gt;sites-enabled&lt;/code&gt; 并建立软链接：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;$ cd /etc/nginx/sites-enabled
$ ln -s /etc/nginx/sites-available/blog /etc/nginx/sites-enabled/blog
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;接着再回到 &lt;code&gt;sites-available&lt;/code&gt; 中，使用 &lt;code&gt;vim blog&lt;/code&gt; 编辑配置，粘贴以下内容：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-nginx"&gt;server {
    listen       80;
    server_name  _;
    root         /home/Leo/web/blog;

    location / {
    };
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其中 &lt;code&gt;listen 80&lt;/code&gt; 指监听 80 端口，也就是 HTTP 服务的端口，&lt;code&gt;server_name&lt;/code&gt; 是网站的 url 地址，如果需要通过域名访问，例如填入 &lt;code&gt;example.com&lt;/code&gt; 即可，&lt;code&gt;root&lt;/code&gt; 是静态站点的文件目录，在该目录下存放了站点的 HTML 和 CSS 文件，&lt;code&gt;location&lt;/code&gt; 设置了网站路由，不需要修改。&lt;/p&gt;
&lt;p&gt;最后需要将同一文件夹内 &lt;code&gt;default&lt;/code&gt; 文件中的所有内容都注释掉。&lt;/p&gt;
&lt;h2 id="cong-github-pull-jing-tai-wang-ye"&gt;从 GitHub pull 静态网页&lt;/h2&gt;
&lt;p&gt;在本地电脑上，使用 Pelican（或其他静态网页生成器）生成静态网页，Pelican 的命令是 &lt;code&gt;pelican content -s publishconf.py&lt;/code&gt;，然后就会生成 &lt;code&gt;output&lt;/code&gt; 文件夹，只需要将该文件夹 push 到 GitHub 仓库中，这里的操作十分简单，也不展开介绍了。&lt;/p&gt;
&lt;p&gt;在服务器中进入 &lt;code&gt;root&lt;/code&gt; 文件夹，也就是 &lt;code&gt;/home/Leo/web/blog&lt;/code&gt; 中，&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;git init
git remote add origin https://github.com/Tseing/tseing.github.io.git
git pull origin master
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;使用 &lt;code&gt;sudo git init&lt;/code&gt; 初始化后，从链接的 GitHub 仓库中 pull 静态文件。最后使用 &lt;code&gt;sudo nginx -s reload&lt;/code&gt; 重启 Nginx 服务，在 &lt;code&gt;http://服务器 IP&lt;/code&gt; 上就能看到博客页面啦。&lt;/p&gt;
&lt;p&gt;可以把在服务器上发布文章的流程总结为以下几步：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;在本地使用 Markdown 撰写文章；&lt;/li&gt;
&lt;li&gt;使用 Pelican 生成静态网页；&lt;/li&gt;
&lt;li&gt;将生成的静态网页 push 至 GitHub 仓库；&lt;/li&gt;
&lt;li&gt;连接服务器，在相应目录下 pull GitHub 仓库中的更新。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这样的流程比较繁琐，每次更新都需要连接到服务器上操作，要简化这样的流程并实现自动化部署就需要借助 webhook 的功能。简单来说，在 GitHub 仓库设置中开启 webhook，用户对仓库执行每个动作（这里为 push）后，仓库都会向目标服务器发送一段 JSON 报文（回调），那么服务器只需要一直运行着监听该报文的脚本，一旦收到 push 成功的报文就执行 pull 操作。这样就简化了工作流程，push 静态网页后，服务器上的内容也会自动更新。&lt;/p&gt;
&lt;p&gt;webhook 脚本可以使用不同语言实现，例如 PHP、JavaScript 和 Python 等等。但是考虑了服务器的性能，我不打算在服务器上配置过于重的环境。于是我选择了基于 Go 语言的 &lt;a href="https://github.com/adnanh/webhook" rel="noopener" target="_blank"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt; adnanh/webhook&lt;/a&gt;，十分轻量，配置的方法也很简单，可以参考&lt;a href="https://www.cnblogs.com/pingyeaa/p/12777626.html" rel="noopener" target="_blank"&gt;这篇文章&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;{warn begin}旧版 webhook 存在一些令人困恼的 bug，例如无法读取相对路径，请使用最新版本。{warn end}&lt;/p&gt;
&lt;h2 id="guan-bi-github-pages"&gt;关闭 GitHub Pages&lt;/h2&gt;
&lt;p&gt;在一切部署工作都完成之后，也是时候和 GitHub Pages 说再见了。避免搜索引擎抓取数据时出现大量重复网页，所以就关闭原来 GitHub Pages 上的博客吧。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8516?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8516?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;p class="cite"&gt;Hello world!&lt;/p&gt;&lt;br/&gt;
&amp;mdash;&amp;mdash; &lt;em&gt;From my server&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr/&gt;
&lt;h2 id="references"&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.jianshu.com/p/87e26e644a5a" rel="noopener" target="_blank"&gt;使用 Nginx 搭建静态网站 - 简书&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.cnblogs.com/jenkin1991/p/8301983.html" rel="noopener" target="_blank"&gt;nginx 配置详解 - 博客园&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="碎碎念"></category><category term="Blog"></category><category term="Pelican"></category><category term="Nginx"></category><category term="Linux"></category></entry><entry><title>文献总结｜通过深度神经网络捕获化学家的直觉实现分子优化</title><link href="https://leonis.cc/sui-sui-nian/2023-02-11-summary-doi.org/10.1186/s13321-021-00497-0.html" rel="alternate"></link><published>2023-02-11T00:00:00+08:00</published><updated>2023-02-11T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-02-11:/sui-sui-nian/2023-02-11-summary-doi.org/10.1186/s13321-021-00497-0.html</id><summary type="html">&lt;p&gt;本文介绍于 2021 年发表在 &lt;em&gt;Journal of Cheminformatics&lt;/em&gt; 上的一篇文章，文章原标题为 Molecular optimization by capturing chemist’s intuition using deep neural networks，文章使用通过 MMP 算法生成的分子对数据和分子性质数据训练了 Transformer 和 seq2seq 等模型，这些模型能够通过结构改造得到具有目标性质的分子。&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;i class="fa fa-external-link"&gt;&lt;/i&gt; &lt;a href="https://doi.org/10.1186/s13321-021-00497-0" rel="noopener" target="_blank"&gt;doi.org/10.1186/s13321-021-00497-0&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本文介绍于 2021 年发表在 &lt;em&gt;Journal of Cheminformatics&lt;/em&gt; 上的一篇文章，文章原标题为 Molecular optimization by capturing chemist&amp;rsquo;s intuition using deep neural networks，文章使用通过 MMP 算法生成的分子对数据和分子性质数据训练了 Transformer 和 seq2seq 等模型，这些模型能够通过结构改造得到具有目标性质的分子。&lt;/p&gt;
&lt;h2 id="fang-fa"&gt;方法&lt;/h2&gt;
&lt;h3 id="xun-lian-shu-ju"&gt;训练数据&lt;/h3&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8505?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8505?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;分子使用 SMILES 编码，原始分子的数据来自 ChEMBL，使用 MMP 算法对原始分子做化学改造，得到改造后的分子，也是训练模型时的目标分子，使用分子性质预测模型计算原始分子与目标分子的 LogD、溶解度以及 ADMET 性质。根据化学改造前后分子性质的变化，在原始分子前加上相应的性质标记，处理得到的两个分子构成一对 source-target 分子，作为训练集。&lt;/p&gt;
&lt;h3 id="mo-xing"&gt;模型&lt;/h3&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8507?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8507?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;文章中所使用的 Transformer 和 seq2seq 都是在机器翻译领域取得了优异成绩的模型，机器翻译的任务中，需要将一段文本转换为另一段文本，将其应用在分子优化中，就是将原始分子序列优化为目标分子序列的任务视作为机器翻译，让模型找到原始分子与目标分子间的关系。&lt;/p&gt;
&lt;p&gt;将 MMP 处理得到的分子对记作 &lt;span class="math"&gt;\(\{X,Y,Z\}\)&lt;/span&gt;，其中 &lt;span class="math"&gt;\(X\)&lt;/span&gt; 表示原始分子，&lt;span class="math"&gt;\(Y\)&lt;/span&gt; 表示目标分子，&lt;span class="math"&gt;\(Z\)&lt;/span&gt; 表示从 &lt;span class="math"&gt;\(X\)&lt;/span&gt; 到 &lt;span class="math"&gt;\(Y\)&lt;/span&gt; 发生的性质改变，模型的训练过程就是要建立 &lt;span class="math"&gt;\((X,Z)\rightarrow Y\)&lt;/span&gt; 的映射。&lt;/p&gt;
&lt;p&gt;Transformer 与 seq2seq 两种模型的原理不同，seq2seq 模型具有编码器-解码器的构造，编码器将输入序列编码为变量，解码器通过该变量与前一时刻中的输出一起给出当前输出，直至序列结束，完成翻译过程，编码器-解码器的内部使用 RNN 实现。由于  RNN 结构的长期依赖问题，seq2seq 在处理长文本序列时能力有限。Transformer 也具有编码器-解码器的构造，但 Transformer 没有使用 RNN 并引入了 self-attention 机制，具有比 seq2seq 更强的文本处理能力。&lt;/p&gt;
&lt;h3 id="ping-gu-zhi-biao"&gt;评估指标&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;目标 1：评估模型是否对指定的三个分子性质进行了优化&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;考虑到性质预测模型的误差，三个性质都在以下范围内的分子视为完成了性质优化：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class="math"&gt;\(|\log D_\mathrm{generated}-\log D_\mathrm{target}|\leq 0.4\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(\mathrm{solubility_{low}}\leq 2.3\ \mathrm{or}\ \mathrm{solubility_{high}}\geq 1.1\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(\mathrm{clearance}=1.3\pm0.35\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;目标 2：评估模型是否基于 MMP 对分子做了化学改造&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;使用 MMP 分析生成分子，检查分子结构是否符合要求。&lt;/p&gt;
&lt;p&gt;为了评估模型生成分子的效果，文章制作了以下三个测试集：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Test-Original：从数据集中取出 10% 作为该测试集，但其中所有组合 &lt;span class="math"&gt;\((X,Z)\)&lt;/span&gt; 都未在训练集中出现过。&lt;/li&gt;
&lt;li&gt;Test-Molecule：Test-Origina 的子集，其中所有数据的分子都未在训练集中出现过，即 &lt;span class="math"&gt;\(\{(X,Z)_\mathrm{test}|X\notin \mathcal{X}_\mathrm{train}\}\)&lt;/span&gt;。&lt;/li&gt;
&lt;li&gt;Test-Property：由 Test-Original 中具有特定性质要求的组合构成，性质要求为 &lt;code&gt;LogD_change_=(-1.1,-0.9]&lt;/code&gt;、&lt;code&gt;Solubility_low&amp;rarr;high&lt;/code&gt; 和 &lt;code&gt;CLint_high&amp;rarr;low&lt;/code&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="jie-guo_1"&gt;结果&lt;/h2&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8508?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8508?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;使用三种测试集在不同模型上生成分子的结果如上图所示，首先可以看出，仅使用 MMP 算法对分子进行改造，也能得到一定数量具有目标特征的分子，说明 MMP 算法能够较好处理分子优化的问题，但 MMP 仅是对测试分子做没有方向性的、随机的改造，所以在生成分子的结果中，MMP 算法得到满足要求的分子也最少。&lt;/p&gt;
&lt;p&gt;相比 MMP 算法，深度学习模型 HierG2G、seq2seq 和 Transformer 具有更好的效果，生成了更多满足要求的分子。其中 seq2seq 和 Transformer 具有比较接近的结果，且表现都优于 HierG2G，这可能是由于 HierG2G 是一种基于图的模型，对于「序列到序列」这一类型的任务表现不如专门用于文本处理的 seq2seq 和 Transformer。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8509?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8509?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;统计各个模型生成的分子，在满足目标性质与基于 MMP 对分子进行改造两方面的目标上，Transformer 生成分子中满足要求的分子都在高于另外两种模型，更好地完成了分子优化任务。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8510?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8510?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;考察训练集与使用不同测试集通过 Transformer 生成分子集中分子对之间的化学改造方式，上图展示了出现频率最高的 20 种改造方式。可以看出，在训练集、从 Test-Original 和 Test-Molecule 生成的分子集中，出现频率较高的几种分子改造方式都比较接近，这可以说明 Transformer 从训练集中学习到了 MMP 改造方式并将其应用于测试集从而生成分子。&lt;/p&gt;
&lt;p&gt;Test-Property 中的分子改造方式与其他三种数据集中的方式差别较大，这是因为 Test-Property 数据集指定了特定的性质优化要求，在给定的性质单一优化方向下，Transformer 在学习到的 MMP 改造方式中选择最合适的方式，使生成分子的性质符合目标要求。这种工作方式与化学家改造分子的方式类似。&lt;/p&gt;
&lt;p&gt;文章中使用模型所生成的分子如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8511?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8511?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h2 id="jie-lun"&gt;结论&lt;/h2&gt;
&lt;p&gt;文章使用 MMP 算法构建分子对数据集，MMP 算法模拟了现实中对单键切断并替换官能团的分子改造方式，因此可以训练得到与现实相似的分子改造模型。文章还考虑了分子改造的性质变化，现实中的分子改造大多是为了获得特定的性质，因此在结合了分子改造与性质变化后，文章构造了一种能够针对目标性质进行结构优化的模型，类似于现实中化学家对分子的优化。在试验的多种模型中，Transformer 获得了最佳的效果。但模型仍有许多改善的空间，例如只能对单点进行结构改造，能够指定的分子性质约束太少等等。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="碎碎念"></category><category term="Literature Summary"></category><category term="CADD"></category><category term="Transformer"></category><category term="RNN"></category></entry><entry><title>CS224n 自然语言处理第二节: 词向量与词义感知</title><link href="https://leonis.cc/sui-sui-nian/2023-02-08-cs224n-lecture2.html" rel="alternate"></link><published>2023-02-08T00:00:00+08:00</published><updated>2023-02-08T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-02-08:/sui-sui-nian/2023-02-08-cs224n-lecture2.html</id><summary type="html">&lt;p&gt;CS224n Lecture 2: Word Vectors, Word Senses, and Neural Classifiers&lt;/p&gt;</summary><content type="html">&lt;h2 id="word2vec-de-ji-suan"&gt;word2vec 的计算&lt;/h2&gt;
&lt;p&gt;在前一节中，介绍了 word2vec 的 Skip-grams 模式，即通过中心词预测上下文词的工作方式，接下来使用该方式计算词向量，具体步骤包括&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;初始化词向量（普遍使用 one-hot 编码）&lt;/li&gt;
&lt;li&gt;计算每个词的条件概率
   &lt;div class="math"&gt;$$P(o|c)=\frac{\exp(u_o^Tv_c)}{\sum_{w\in V}\exp(u_w^Tv_c)}$$&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;通过迭代优化的方法（梯度下降、随机梯度下降），改变词向量的值，最小化损失函数
   &lt;div class="math"&gt;$$J(\theta)=-\frac{1}{T}\log L(\theta)=-\frac{1}{T}\prod^T_{t=1}\prod_{\substack{-m\leq j\leq m\\j\neq0}}P(w_{t+j}|w_t;\theta)$$&lt;/div&gt;
   最终得到基于分布式语义的词向量结果。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="fu-cai-yang"&gt;负采样&lt;/h3&gt;
&lt;p&gt;计算 &lt;span class="math"&gt;\(\sum_{w\in V}\exp(u_w^Tv_c)\)&lt;/span&gt; 具有巨大的开销，负采样是一种优化词向量计算效率的一种方法，负采样的思路是将由中心词预测多个上下文词的多分类问题转化为二分类问题，即判断目标词是否为中心词。&lt;/p&gt;
&lt;p&gt;首先定义 &lt;span class="math"&gt;\(D\)&lt;/span&gt; 为词对 &lt;span class="math"&gt;\((c,o)\)&lt;/span&gt; 的集合（中心词 center，上下文 outside），那么对于任意词对 &lt;span class="math"&gt;\((c,w)\)&lt;/span&gt;，它们之间互为上下文的概率为&lt;/p&gt;
&lt;div class="math"&gt;$$P(D=1|c,w)=\sigma(u_w^\mathrm{T}v_c)$$&lt;/div&gt;
&lt;p&gt;其中 &lt;span class="math"&gt;\(\sigma(x)=\frac{1}{1+e^{-x}}\)&lt;/span&gt;，又称为 Sigmoid 函数，根据 Sigmoid 函数的性质，当 &lt;span class="math"&gt;\(c\)&lt;/span&gt; 与 &lt;span class="math"&gt;\(w\)&lt;/span&gt; 相似程度大时，二者为上下文概率高，当相似程度低时，互为上下文概率低，同样是分布式语义的思想。&lt;/p&gt;
&lt;p&gt;全部正样本的似然函数为&lt;/p&gt;
&lt;div class="math"&gt;$$\prod_{(c,w)\in D}P(D=1|c,w)$$&lt;/div&gt;
&lt;p&gt;全部负样本的似然函数为&lt;/p&gt;
&lt;div class="math"&gt;$$\prod_{(c,w)\notin D}P(D=1|c,w)$$&lt;/div&gt;
&lt;p&gt;优化目标是使正样本尽可能多，负样本尽可能少，所以优化目标可以写作&lt;/p&gt;
&lt;div class="math"&gt;$$\max \prod_{(c,w)\in D}P(D=1|c,w)\prod_{(c,w)\notin D}P[1-(D=1|c,w)]$$&lt;/div&gt;
&lt;p&gt;取对数并整理后可以得到&lt;/p&gt;
&lt;div class="math"&gt;$$J(\theta)=-\log\sigma(u^\mathrm{T}_ov_c)-\sum_{j\in \mathrm{NEG}(w)}\log\sigma(-u^\mathrm{T}_jv_c)$$&lt;/div&gt;
&lt;p&gt;也就是说负采样需要从文本中抽取若干个词组成负样本集 &lt;span class="math"&gt;\(\mathrm{NEG}(w)\)&lt;/span&gt;，并迭代最小化损失函数得到词向量，这也是「负采样」一名的含义。通常将文本中各词的频率 &lt;span class="math"&gt;\(f(w)\)&lt;/span&gt; 缩放为 &lt;span class="math"&gt;\(f(w)^{3/4}\)&lt;/span&gt; ，以此作为概率从文本中抽取词组成负样本集，避免忽略低频词。&lt;/p&gt;
&lt;h2 id="gong-xian-ju-zhen_1"&gt;共现矩阵&lt;/h2&gt;
&lt;p&gt;与 word2vec 利用概率预测得到词向量不同，共现矩阵是一种通过直接计数得到词向量的方法。设定一个大小为 &lt;span class="math"&gt;\(m\)&lt;/span&gt; 的窗口，让该窗口经过语料中的所有中心词，并统计所有中心词所属窗口中不同上下文词的数量，将结果列为表格，就是一个 &lt;span class="math"&gt;\(|W|\times |W|\)&lt;/span&gt; 的矩阵，称为共现矩阵， &lt;span class="math"&gt;\(|W|\)&lt;/span&gt; 为语料中的词汇数量。在共现矩阵中，元素 &lt;span class="math"&gt;\(x_{ij}\)&lt;/span&gt; 就表示词 &lt;span class="math"&gt;\(w_j\)&lt;/span&gt; 作为中心词 &lt;span class="math"&gt;\(w_i\)&lt;/span&gt; 上下文词的数量。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I like deep learning.&lt;br/&gt;
I like NLP.&lt;br/&gt;
I enjoy flying.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;例如以上三句话构成的语料，设定窗口大小为 1，可以得到以下共现矩阵：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;I&lt;/th&gt;
&lt;th&gt;like&lt;/th&gt;
&lt;th&gt;enjoy&lt;/th&gt;
&lt;th&gt;deep&lt;/th&gt;
&lt;th&gt;learning&lt;/th&gt;
&lt;th&gt;NLP&lt;/th&gt;
&lt;th&gt;flying&lt;/th&gt;
&lt;th&gt;.&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;I&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;like&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;enjoy&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;deep&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;learning&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NLP&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;flying&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;共现矩阵是一个对称矩阵，从共现矩阵中也可以得到词向量，如 &lt;span class="math"&gt;\(w^\mathrm{T}(\mathrm{I})=(0\ 2\ 1\ 0\ 0\ 0\ 0\ 0)\)&lt;/span&gt;。共现矩阵得到的向量普遍较为稀疏，通过奇异值分解可以将共现矩阵转化为更为稠密的特征矩阵，从而得到稠密的词向量。&lt;/p&gt;
&lt;h3 id="gong-xian-gai-lu"&gt;共现概率&lt;/h3&gt;
&lt;p&gt;共现矩阵通过计数获取中心词与上下文词的关系，因此词频对共现矩阵有着很大影响，例如以下这个例子：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;span class="math"&gt;\(x=\mathrm{solid}\)&lt;/span&gt;&lt;/th&gt;
&lt;th&gt;&lt;span class="math"&gt;\(x=\mathrm{gas}\)&lt;/span&gt;&lt;/th&gt;
&lt;th&gt;&lt;span class="math"&gt;\(x=\mathrm{water}\)&lt;/span&gt;&lt;/th&gt;
&lt;th&gt;&lt;span class="math"&gt;\(x=\mathrm{random}\)&lt;/span&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;span class="math"&gt;\(P(x\vert\mathrm{ice})\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;large&lt;/td&gt;
&lt;td&gt;small&lt;/td&gt;
&lt;td&gt;large&lt;/td&gt;
&lt;td&gt;small&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;span class="math"&gt;\(P(x\vert\mathrm{steam})\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;small&lt;/td&gt;
&lt;td&gt;large&lt;/td&gt;
&lt;td&gt;large&lt;/td&gt;
&lt;td&gt;small&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;span class="math"&gt;\(\frac{P(x\vert\mathrm{ice})}{P(x\vert\mathrm{steam})}\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;large&lt;/td&gt;
&lt;td&gt;small&lt;/td&gt;
&lt;td&gt;~1&lt;/td&gt;
&lt;td&gt;~1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;依据直觉判断，「冰（ice）」与「固体（solid）」存在着很强的相关性，「蒸汽（steam）」与「气体（gas）」存在着很强的相关性，基于计数得到的 &lt;span class="math"&gt;\(P(x|\mathrm{ice})\)&lt;/span&gt; 与 &lt;span class="math"&gt;\(P(x|\mathrm{steam})\)&lt;/span&gt; 确实能反映这一关系。但在遇到高频词与低频词时就有了麻烦，表中用的例子是 「water」 和 「random」，我们不妨考虑更极端的情况，考虑高频词为冠词 「the」，低频词为很难见到的「thou」，结果会怎样呢？&lt;span class="math"&gt;\(P(x|\mathrm{ice})\)&lt;/span&gt; 与 &lt;span class="math"&gt;\(P(x|\mathrm{steam})\)&lt;/span&gt; 对于高频词都有着较大值，对低频词都有着较小值，无法判断相关性了。&lt;/p&gt;
&lt;p&gt;为了避免高频词与低频词的影响，更加真实地反映词义，通常会使用共现概率（co-occurrence probabilities）进行词义分析，即表中的 &lt;span class="math"&gt;\(\frac{P(x\vert\mathrm{ice})}{P(x\vert\mathrm{steam})}\)&lt;/span&gt; ，共现概率通过除法消除了共有高频词与低频词的影响，只有与中心词有着较强语义关联的词才会具有较大值。&lt;/p&gt;
&lt;h2 id="glove_1"&gt;GloVe&lt;/h2&gt;
&lt;p&gt;基于计数的共现矩阵与基于概率预测的 word2vec 各有优缺点，而 GloVe 则结合了二者的优点。GloVe 全称为 Global Vectors，GloVe 得到的词向量既能像基于计数的方法一样全面利用信息，又能像基于概率预测的方法一样表示比相关性更多更复杂的关系。&lt;/p&gt;
&lt;p&gt;GloVe 首先通过对共现概率建立模型，具有如下形式：&lt;/p&gt;
&lt;div class="math"&gt;$$F(w_i,w_j,\tilde{w_k})=\frac{P_{ik}}{P_{jk}}$$&lt;/div&gt;
&lt;p&gt;其中 &lt;span class="math"&gt;\(w_i\)&lt;/span&gt; 与 &lt;span class="math"&gt;\(w_j\)&lt;/span&gt; 是比较的目标词，例如上表中的「ice」与「steam」，&lt;span class="math"&gt;\(\tilde{w}\)&lt;/span&gt; 为上下文词，即上表中的「solid」与「gas」等，&lt;span class="math"&gt;\(P_{ij}=P(j|i)\)&lt;/span&gt; 表示由计数得到的共现概率。&lt;/p&gt;
&lt;p&gt;接着参考 word2vec 中相似向量具有相同语义的思想，我们会希望 GloVe 得到的相似词向量具有强相关性，也就是较大的 &lt;span class="math"&gt;\(P_{ij}\)&lt;/span&gt;，向量的数量积是衡量向量相似性的自然方法，那么模型的形式可以改为&lt;/p&gt;
&lt;div class="math"&gt;$$F(w_i^\mathrm{T}\tilde{w}_k,w_j^\mathrm{T}\tilde{w}_k)=\frac{P_{ik}}{P_{jk}}$$&lt;/div&gt;
&lt;p&gt;然后要让模型 &lt;span class="math"&gt;\(F\)&lt;/span&gt; 中的左侧的向量运算能够表示右侧概率的比值，GloVe 的假设是使用向量的差，也就是&lt;/p&gt;
&lt;div class="math"&gt;$$F(w_i^\mathrm{T}\tilde{w}_k-w_j^\mathrm{T}\tilde{w}_k)=F[(w_i-w_j)^\mathrm{T}\tilde{w}_k]=\frac{P_{ik}}{P_{jk}}$$&lt;/div&gt;
&lt;p&gt;最后求解该模型，在保证对称性等要求下得到 GloVe 模型为&lt;/p&gt;
&lt;div class="math"&gt;$$J=\sum_{i,j=1}^Vf(X_{ij})(w_i^\mathrm{T}\tilde{w}_j+b_i+\tilde{b}_j-\log X_{ij})^2$$&lt;/div&gt;
&lt;p&gt;具体推导过程可以参考&lt;a href="https://zhuanlan.zhihu.com/p/60208480" rel="noopener" target="_blank"&gt;CS224N笔记(二)：GloVe&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id="ci-xiang-liang-zhong-de-duo-zhong-yu-yi"&gt;词向量中的多重语义&lt;/h2&gt;
&lt;p&gt;在自然语言中，一个词具有多重的语义，由于语境不同而具有不同的意思，例如汉语中的多音字「省」，那么词向量该如何处理这种状况呢？&lt;/p&gt;
&lt;p&gt;要明确的是，词向量是基于语料中的分布式语义得到的，虽然这种分布与语境还存在一定差异，但二者具有很大的相似性。正如当我们看到文章中的「省」字时不会像词典一样列举出所有含义，而是根据上下文或是最常见的义项做出判断，词向量也是如此。&lt;/p&gt;
&lt;p&gt;词向量可以看作多个语义的线性组合，因此词向量也具有多重语义，可以表示为&lt;/p&gt;
&lt;div class="math"&gt;$$w(省)=\alpha_1w(省_1)+\alpha_2w(省_2)$$&lt;/div&gt;
&lt;p&gt;其中权值 &lt;span class="math"&gt;\(\alpha\)&lt;/span&gt; 由语料中词汇的频率 &lt;span class="math"&gt;\(f\)&lt;/span&gt; 决定，可以表示为&lt;/p&gt;
&lt;div class="math"&gt;$$\alpha_1=\frac{f_1}{f_1+f_2}$$&lt;/div&gt;
&lt;hr/&gt;
&lt;h2 id="references"&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://web.stanford.edu/class/archive/cs/cs224n/cs224n.1214/" rel="noopener" target="_blank"&gt;CS224n: Natural Language Processing with Deep Learning&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://zhuanlan.zhihu.com/p/33799633" rel="noopener" target="_blank"&gt;全面理解 word2vec - 知乎&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://zhuanlan.zhihu.com/p/60208480" rel="noopener" target="_blank"&gt;CS224N笔记(二)：GloVe - 知乎&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="碎碎念"></category><category term="NLP"></category><category term="CS224n"></category></entry><entry><title>RDKit 入门：基于子结构修改分子</title><link href="https://leonis.cc/sui-sui-nian/2023-02-06-rdkit-modify-substructure.html" rel="alternate"></link><published>2023-02-06T00:00:00+08:00</published><updated>2023-02-06T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-02-06:/sui-sui-nian/2023-02-06-rdkit-modify-substructure.html</id><summary type="html">&lt;p&gt;介绍使用 RDKit 修改分子的子结构，包括删除、替换、切割等操作以及对分子片段的处理。&lt;/p&gt;</summary><content type="html">&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="删除子结构"&gt;删除子结构&lt;a class="anchor-link" href="#删除子结构"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rdkit&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rdkit.Chem&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;AllChem&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;删除分子中的子结构需要用到 &lt;code&gt;DeleteSubstructs(m, patt)&lt;/code&gt;，参数为需要修改的分子与分子片段，可选参数包括&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;onlyFrags=False&lt;/code&gt;：是否当匹配片段为单独片段时才删除，默认为只要匹配一致即删除&lt;/li&gt;
&lt;li&gt;&lt;code&gt;useChirality=False&lt;/code&gt;：是否匹配片段的手性&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'OCCc1c2ccncn2cc1'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[2]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;patt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmarts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'CCO'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;patt_display&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'CCO'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;patt_display&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[3]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcIAAACWCAIAAADCEh9HAAAABmJLR0QA/wD/AP+gvaeTAAAUgklEQVR4nO3deVAUdx4F8DeAKIc3ivcVJJ5RFFGUoERcY5wkm9rFyiaB3c1aJq7ZmSHigjEJaNQCNWGIrltUWdZOzG6qSCqpYrSiYfCWS5QgKnjjDYJ4cIiI9P7RyKBROWaY3xzvU/7RyHT3S0UePT3d31ZIkgQiImovJ9EBiIhsG2uUiMgkrFEiIpOwRomITMIaJSIyCWuUiMgkrFEiIpOwRomITMIaJSIyCWuUiMgkrFEiIpOwRomITMIaJSIyCWuUiMgkrFEiIpOwRomITMIaJSIyCWuUOlxJScnChQu3bNmyfPnyyspK0XGIzEzBh4hQx7l//75Wq12zZk1lZWXXrl0rKyv79++/du3aiIgIJyf+Cic7wX/K1FH0ev3YsWNjYmIqKytDQ0O3bt0aFBR0/fr1v/71rwEBAQcPHhQdkMhMJCJzKyoqmjdvnvwP7MUXX9yxY4f89w0NDSkpKUOHDgWgUCjCwsKKi4vFRiUyHWuUzKmiokKlUrm4uADo2bNnfHz8/fv3n3hNdXV1bGysm5sbAHd39+jo6MrKSiFpicyCNUrm8eDBg+Tk5D59+gBwcXFZtGjRjRs3nvP6y5cvh4eHKxQKAIMGDdLpdA0NDRZLS2RGrFEyg/T09PHjx8vv4l955ZX8/PxWrrh3796JEyfKK06dOjUrK6tDcxJ1BNYomeTMmTNhYWFyD/r4+KSkpLR1Cw8fPtTpdN7e3gCcnJzCw8NLSko6IipRB+EFT9RO1dXV69evT0hIqK2t9fDwiIqKiomJ6dKlS/u2VlVVtWHDBvlcqqen59KlS5cvX965c2fzZibqEKJ7nGxPQ0ODTqfr168fAIVCER4efv36dbNs+fTp003HtiNHjmzHsS2R5bFGqW1ycnICAwPlppsyZUpGRobZd5GWljZu3Dh5F6GhoQUFBWbfBZEZsUapta5cudL02frAgQM79LP1urq65ORkLy8vPPrcv6ysrIP2RWQi1ii1rKamJj4+vmvXrgDc3Nyio6Pv3r1rgf3evHlTpVI5OzsD6NWrl1arra+vt8B+idqENUotSE1NHTZsmPwWW6lUnj9/3sIBTp48OXfuXDnA6NGjd+7caeEARM/HGqVnOnr0aHBwsNxffn5++/btExgmNTV1xIgRTW1+7tw5gWGImmON0lOUl5c3vZvu3bu3lbybludFyecWXF1dVSrVnTt3RIciYo3S4+rq6rRabffu3QF06tRJpVLdvn1bdKjHXL16ddGiRfKcvQEDBiQnJz98+FB0KHJorFEySktLGzNmTNOVRsePHxed6JkOHz48ffp0Oaq/v/+hQ4dEJyLHxRolSZKkU6dOzZ8/X24lX1/f7du3i07UMnns3pAhQ/Bo7N7FixdFhyJHxBp1dLdu3YqOjnZ1dQXQo0ePp462s2by2D35JlR3d/fY2Nh79+6JDkWOhTXquOSZIH379sWjmSClpaWiQ7XTpUuXwsPD5aPpwYMH63Q60YnIgbBGHdTu3btfeukluXdmzZr166+/ik5kBnv27JkwYYKd/UeR9WONOhz7PnCzp0NsshWsUQdSVVXlIKcRbf2EL9kW1qhDcMwPtW3x8gOyRaxR++fgl1impaWNHTvWJi6GJRvFGrVnvOFHZv23ZpFNY43ap9/efm6Z0XbWzDoHBZAdYI3aodTU1OHDh3MY0lNZ1dgqsg+sUbvC0Zyt9MRvGssPUSV7whq1ExwU31aiRvqT/WGN2rzmjy3q1KkTH1vUJpZ8wBTZK9aobXviah4+RLN9LPC4U7JjrFFbdfr0aaVSyUe6m0tDQ4NOp+vXr598h0J4ePj169dFhyLbwBq1PfKdjp07dwbg6ekZGxtbW1srOpSdaH6/rIeHhx3fL0tmxBq1JfLcDW9v76a5GyUlJaJD2aEzZ86EhYXJR/ovvPACj/Tp+VijNmPv3r0TJ06Uf7ZnzpyZl5cnOpGdS09Pb5ol+Morr+Tn54tORFaKNWoDLl++3PRp8qBBg/hpssU8ePAgOTm5T58+TYf/N27cEB2KrA5r1KrJT8hwc3NrGm1XU1MjOpTDqaioUKlULi4uAHr27Mmxe/QE1qiVkkfbDR06tGm0XXFxsehQDq2oqOi1116T3+O/+OKLO3bsEJ2IrAVr1Brl5ubOmDFD/omdPHnygQMHRCeiRmlpaaNHj266UPfkyZOiE5F4rFHrcu3atabRdv3793fY0XbWTB67161bN47dIxlr1FrIo+2a/3DeuXNHdCh6prKyMo7dI5lCkiSQaHq9XqPRnD9/HoBSqdRqtS+88ILoUNSy3NxctVqdkZHhpFCU/v73XkuX4tHZGHIcrFHBioqKIiMjd+7cCWDUqFFfffXVvHnzRIeiNpAk6bvvvpO+++7d7duhUODtt5GQgMGDReciy2GNClNRUbFy5crNmzfX19f36tXr888/X7JkiXxVDdmemhps3IjVq1FVBXd3/OMf+PRTeHqKjkWWwBoVoL6+fuvWrStWrCgvL3dxcXn//fdXr14tX+NNtu3KFXzyCb79FpKEgQOxdi3Cw6FQiI5FHYs1amnp6emRkZEFBQUAZs+enZiYOH78eNGhyKxycqBWIysLAAICkJSEadNEZ6IO5CQ6gAM5e/bsggUL5KmgPj4+KSkpBoOBHWqHAgJw6BB0Onh7IycHM2YgIgIlJaJjUUfh0aglVFdXr1+/Xr6J0MPDIyoqavny5fKkO7Jn1dVYvx7x8bh/Hx4eiIrC8uXg/3e7wxrtWA0NDd9+++0///nP0tJShULx3nvvrVu3Tp4NTI7izBmsWIHvvwcAHx+sXYtHU/jIPrBGO1BOTo5arc7KygIQEBCQlJQ0jefIHFZ6OjQaHD8OALNnIzERPJ9jL3hutENcvXo1IiJi2rRpWVlZ8oPSsrKy2KEObfZs5OUhORleXkhPx6RJ+OADlJeLjkVmwKNRM6upqdm4cePq1aurqqrc3NxUKtWnn37qyesHqUlFBVauxObNqK9Hr174/HMsWQJeL2zLWKPmpNfrVSpVcXExAKVSuXHjxmHDhgnORNapqAiRkdi5EwBGjUJiIl59VXQmaie+qTePo0ePBgcHv/HGG8XFxZMmTdq/f79er2eH0jONGoWff0ZqKkaMQFER5s3D66/j3DnRsag9WKOmunnzplqtDggIOHDggDzpJycn5+WXXxadi2zB66+jsBBaLbp1w/btGD0aajXu3hUdi9qGb+rb78GDB5s3b46Njb1z506nTp0WL168atWq7t27i85FNuj6dcTFYcsWNDSgf3/ExWHhQjjxKMc2sEbbyWAwqFSqwsJCAKGhoUlJSWPGjBEdimzckSNQq3HoEABMngytFkFBojNRy/jrrs1OnTo1f/78OXPmFBYWys/kSUtLY4eSGUyejAMHkJKCoUNx5AiCg7FgAS5eFB2LWsCj0Ta4detWQkJCYmJiXV1dz549o6OjIyMjXV1dReciu1NTg3XrsG4d7t2DuzuWLUN0NNzcRMeip2ONtop8T2dUVFRZWZmTk9O777775ZdfcrQddazmY/cGDcKaNRy7Z51Yoy3bvXt3ZGTksWPHAISEhGi12pdeekl0KHIY+/ZBrUZ+PgDMnAmtFhMnis5Ej+G50ec5d+7cggULZs+efezYscGDB+t0ut27d7NDyaJmzsTRo41j9/btw+TJiIhAaanoWGTEo9Gnk0fbJSQk1NbWyqPtYmJiunTpIjoXObDbtxEfD60W9++jRw/ExECj4dg9a8AafZIkSdu2bYuOji4pKVEoFH/84x+//PLLwXxCGVmJ06exdCm2bweAkSOxZg3H7gnHGn3M4cOH1Wp1ZmYmgClTpiQlJQUGBooORfQbBgM0Gpw4AQChodBqMXas6EyOi+dGG8mj7aZOnZqZmTlgwACdTpednc0OJSsVGoq8PGi16NEDBgP8/Dh2TyAejeLevXtff/31mjVrKisr5dF2K1as6Nq1q+hcRK0gj93717/w8GHj2L2PPoKzs+hYjsXRa1Sv16vV6gsXLgBQKpVff/318OHDRYciaqPCQkRGYtcuABg9GomJmDtXdCYH4rg1mpeXp9Fo9u/fD8DPz0+r1QYHB4sORWQCvR5qNS5cAAClEklJGDFCdCaH4IjnRuXRdlOmTNm/f7882u7w4cPsULJ5r7+OoiJoteja1Th2r7JSdCz751hHoxxtRw7h2jWsXNk4dm/AAMTGcuxeh3KgGjUYDBqN5sSJEwBCQ0O1Wu1YXiNCdiw3F2o1MjIAwN8fSUmYPl10JvvkEL+gTp8+rVQq58yZc+LECV9fX71en5aWxg4lO+fvj4MHkZKCIUOQm4ugICxYgEuXRMeyQ3Z+NHr79u34+Hh5tF2PHj1iYmI42o4cTnU11q9HQgJqa+HhgagoxMSAdzabj93WqDzabtmyZTdu3JBH223YsKFv376icxEJcvkyVqzAtm0AMHgwVq9GRIToTHbCPmt07969Go0mPz8fwKxZs7Ra7YQJE0SHIrICe/ZAo8GxYwAQEoLERPBHw2T2dm708uXLERERISEh+fn58mi7PXv2sEOJGoWEIC8POh369sWePZg0CRERuHFDdCzbZj9HozU1NevWrZNH27m7uy9btoyj7Yie6dYtJCQgMRF1dY1j9yIjwY8N2sUealSSpB9++CEqKurSpUvyaLsNGzYMGTJEdC4iq3fqFJYuxY4dAODri6++wvz5ojPZHpuv0dzcXLVanZGRAcDf31+r1c6YMUN0KCKbYjBArcbJkwAQGoqkJPBJt21hw+dGr1279sEHH0ydOjUjI2PAgAHJycnZ2dnsUKI2Cw3Fr79Cq0X37jAYMHEi1GrcuSM6ls2wyaPRurq6f//735999lllZaWrq+uHH374xRdfdOvWTXQuIht38yZWrWocu9e7Nz77zAxj9yor0amTfV+mans1qtfrNRrN+fPnASiVyqSkpBEcY0NkRnl50Giwfz8A+PlBq0WbBvfk5+Pnn/HLLzh1CuXlqKsDAE9PeHsjIAC/+x1eew3PuoK7uBjh4Y3Ls2bhiy9au9N33228QcvJCfv2tSGtWUi24+TJk3MfTVEcPXr0zp07RScisl+pqdKwYRIgAZJSKZ0/3/IqBQVSWFjjKs/54+oqLVoklZY+ZQvHjxtf9oc/tCGtr2/jWgpFG9YyE9uo0Zs3b6pUKmdnZwC9evXSarX19fWiQxHZu+pqKS5OcneXAOmNN1p48fr1kkLRcoc2/fH2lnJzn9wIa7Qj1NXVJScne3l5AXBxcVm0aFFZWZnoUESO5NIl6Z13pBMnnveapUsfq8guXaSwMOk//5EOHZJOnZIKCiSDQVqzRvL3f+xlnp6SwfDYdlijZpeWljZu3Dj5Xfzs2bMLCgpEJyKi39i27bFyfPNN6cKFZ774xx+lgQONL/bykq5eNX7XNmvUSi94OnPmzIIFC+bMmXP8+PGRI0empKQYDIamSiUia3HxIj76yPjl4sX48UcMG/bM17/1Fg4cQNMTz8rL8f77HRrQAqyuRquqquLi4saPH//99997enrGxsYWFBSEhYWJzkVET7NunfEK08BAbNrU8pj94cPx00/o1Knxy127cOBABybseFZUow0NDd98842Pj8/KlSsfPHgQHh5+9uzZuLi4zp07i45GRE9z927j5D0ACgW2bGnto0omTIBabfxy40bzZ7Mga6nR7Ozs6dOn//nPfy4tLZVvTPrmm2+8vb1F5yKiZ/vxR+Mj84KD23YL6d//buzcn37C3btmzmZB4mv0ypUrERERgYGB2dnZgwYN0ul0mZmZU6dOFZ2LiFpy6JBx+e2327bu8OEIDGxcrq9HTo7ZUlmcyBqtqamJi4vz9fXdtm2bm5tbdHR0YWFhRESEQqEQmIqIWkt+Xp4sIKDNqzc/WsrMNEMeQVyE7FWSpB9++GHZsmUXL14EoFQqN23aNHToUCFhiKg9JAmnTzcuOzujHc+InDjRuFxUZJ5UIgio0SNHjmg0moMHDwKYNGlSUlJSUFCQ5WMQkUnu3kV9feNy9+5ox0fBzT/8uHXrye8ePIhHN3+37MqVNu/dfCxdowaDYe7cuQ0NDf3791+7dm1ERIRTKz/aIyKrcvu2cbl989W6dzcu/7ZGS0vxyy/t2azFWbpGQ0JC/Pz8ZsyYwdF2RLbt/n3jcvuuSmw+Pa+21tQ84li6Rp2dnbOzs51NnGBIRMI1PwyqqmrPFppf5NSjx5PfHTsW77zT2k0lJqK8vD0ZzEHAuVF2KJE96NnTuNx09WibNK/R5luTjRqFTz5p7aZ0OoE1yvOSRNQunTvDw6Nx+e5dVFS0eQvFxcZlLy+zhBKCNUpE7eXnZ1zOz2/z6nl5xuVJk8yQRxDWKBG117RpxuXml+K3UvOboJpvytawRomovWbONC7/979tW/fwYeMl9717w5bHYLJGiai9Xn0Vgwc3LhcWtu0yT63WuPy3v8FFzB2VZsEaJaL2cnHBokXGL5cswb17rVrRYMD//te47OyMxYvNn82CWKNEZILISPj4NC6fPYu33mq5SfPy8Kc/Gb/8+OPnTcu3BaxRIjKBhwe2bjVODt21C0FByMp6+ovr67FpE2bNMl7jOW4cVq2yRM6OZMPnI4jIKrz8MpKT8eGHePgQAI4exfTpmDYN8+djzBj07YvaWpSUIDMTej0uXTKuOGIEfvrpsVtCbRNrlIhMtnAh+vTBe+813hUqScjMbGGEqL8/9Hr062eZgB2Kb+qJyBzefBMXLiA6uuUxJQMHIjkZmZn20aHg0SgRmY2XF+Lj8fHH+OUX7NqFkydRVoayMri6ol8/9O2LwEC8+iqCguDq+vQt9O4NjaZxecKENuz6L3/BjRsAWvtMPbNSSJJk+b0SEdkNvqknIjIJa5SIyCSsUSIik7BGiYhMwholIjIJa5SIyCSsUSIik7BGiYhMwholIjIJa5SIyCSsUSIik7BGiYhMwholIjIJa5SIyCSsUSIik7BGiYhMwholIjIJa5SIyCT/B+WHUBmZw461AAAAZHpUWHRyZGtpdFBLTCByZGtpdCAyMDIyLjAzLjUAAHice79v7T0GIOBlgABGIGYGYiYgbmBkY0gAiTFDaCYmDgifkRuojpGJQYRBXA+qBwyYH7ot2w/Ut48BAexBBFDcHiYuBgC5zgzgoywxYQAAAKh6VFh0TU9MIHJka2l0IDIwMjIuMDMuNQAAeJyNUEEKwzAMu+cV+kCD61BYjk1SxhhNYMv2h933f+ZQ0rSHldo+yEIywgqlHuH++WItDkoBdDDWWrwNEakZBcBN11uEz6OrjE+vmJ8wYHFI75VjTnNlenh0vWZryVzQkeZBLotFEy2gKlmUjdUD/dEZJJw6OMWwi7KEcymGFq40twSywGz9W3XZ6xMEqx8lM0Ng1ZqjHQAAAD96VFh0U01JTEVTIHJka2l0IDIwMjIuMDMuNQAAeJxzdvZXqNHQNdQzsrQ0MNHRNdAzMtWxNtAx0ANSqKKaNQDatAlfP9lmOwAAAABJRU5ErkJggg=="/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;子结构（分子片段）最好使用 SMART 形式导入，SMILES 的功能有限，很难准确表达分子片段，容易引起预料以外的错误。由于 RDKit 绘制 SMART 分子片段的效果不好，这里另外新建了一个 SMILES 形式的分子展示片段的结构。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;rm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;AllChem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DeleteSubstructs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;patt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;rm&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[4]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;含有两个碳的侧链被删去，分子仅剩下母核，需要注意在侧链与母核的连接处没有留下 &lt;code&gt;[*]&lt;/code&gt; 标记的断点，这是删除与切割操作不同的地方。&lt;/p&gt;
&lt;p&gt;{note begin}原分子未被修改，&lt;code&gt;DeleteSubstructs()&lt;/code&gt; 返回一个新分子。{note end}&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="替换子结构"&gt;替换子结构&lt;a class="anchor-link" href="#替换子结构"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;替换操作所使用的函数为 &lt;code&gt;ReplaceSubstructs(m, patt, ，replerepl)&lt;/code&gt;，可选参数包括&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;replaceAll=False&lt;/code&gt;：是否将一个分子中所有符合条件的片段都替换为替换片段，默认情况下，当分子中存在多个匹配项时，返回仅替换一个片段的多个分子（列表）。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;replacementConnectionPoint=0&lt;/code&gt;：手动指定替换片段与母核的成键位置。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;useChirality=False&lt;/code&gt;：是否匹配片段的手性&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;repl&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'SC'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;rms&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;AllChem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceSubstructs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;patt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;repl&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;rms&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[5]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;在替换时容易生成较为奇怪的分子，可以使用 &lt;code&gt;SanitizeMol()&lt;/code&gt; 检查并修正分子结构。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SanitizeMol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rms&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;rms&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[6]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;rms&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;AllChem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceSubstructs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;patt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;repl&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;replacementConnectionPoint&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;rms&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[7]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;{note begin}原分子同样未被修改，&lt;code&gt;ReplaceSubstructs()&lt;/code&gt; 返回一个新分子的列表。{note end}&lt;/p&gt;
&lt;h2 id="切割子结构"&gt;切割子结构&lt;a class="anchor-link" href="#切割子结构"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;&lt;h3 id="切除侧链"&gt;切除侧链&lt;a class="anchor-link" href="#切除侧链"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;从分子中切除侧链，剩下分子母核，需要知道母核的 SMILES 序列，即在知道分子剩余部分 SMILES 序列的情况下，使用 &lt;code&gt;replaceSidechains(m, core)&lt;/code&gt; 函数。&lt;/p&gt;
&lt;p&gt;{note begin}勿被函数名中的「侧链」与「母核」迷惑，这里说的「侧链」与「母核」只是指代不同的两个部分，称其为「甲」与「乙」亦可，与化学概念上的「侧链」「母核」不同。使用 &lt;code&gt;replaceSidechains()&lt;/code&gt; 可以切除「甲」部分，当然也可以切除「乙」部分。{note end}&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;core&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'c1cc2ccncn2c1'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m_cut&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceSidechains&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolToSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m_cut&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;m_cut&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;[1*]c1ccn2cnccc12
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[8]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="切除母核"&gt;切除母核&lt;a class="anchor-link" href="#切除母核"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;从分子中切除母核，剩下分子侧链，需要知道母核的 SMILES 序列，即在知道分子切除部分 SMILES 序列的情况下，使用 &lt;code&gt;ReplaceCore(m, core)&lt;/code&gt; 函数。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;core&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmarts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'CCO'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m_cut&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceCore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolToSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m_cut&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;m_cut&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;[1*]c1ccn2cnccc12
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[9]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;虽然 &lt;code&gt;ReplaceSidechains()&lt;/code&gt; 能实现与 &lt;code&gt;ReplaceCore()&lt;/code&gt; 相同的操作，但 &lt;code&gt;ReplaceCore()&lt;/code&gt; 具有额外更多的功能。&lt;code&gt;ReplaceCore()&lt;/code&gt; 的可选参数包括&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;replaceDummies=True&lt;/code&gt;：切除时是否包括子结构中的虚拟原子&lt;/li&gt;
&lt;li&gt;&lt;code&gt;labelByIndex=False&lt;/code&gt;：是否根据母核原子的索引指定片段虚拟原子的编号&lt;/li&gt;
&lt;li&gt;&lt;code&gt;requireDummyMatch=False&lt;/code&gt;：是否仅当侧链连接在虚拟原子上才执行操作&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;从以下分子中切除吡咯环将得到两条片段：&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[10]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;core&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'c1cNcc1'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolToSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceCore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceCore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;[1*]CCO.[2*]:ccnc:[3*]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[11]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rdkit.Chem.Draw&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;rdMolDraw2D&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;IPython.display&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SVG&lt;/span&gt;

&lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rdMolDraw2D&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolDraw2DSVG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;450&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;150&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;do&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drawOptions&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;do&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;addAtomIndices&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DrawMolecule&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FinishDrawing&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;SVG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetDrawingText&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[12]:&lt;/div&gt;
&lt;div class="output_svg output_subarea output_execute_result"&gt;
&lt;svg baseprofile="full" height="150px" version="1.1" viewbox="0 0 450 150" width="450px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:rdkit="http://www.rdkit.org/xml" xmlns:xlink="http://www.w3.org/1999/xlink"&gt;
&lt;!-- END OF HEADER --&gt;
&lt;rect height="150.0" style="opacity:1.0;fill:#FFFFFF;stroke:none" width="450.0" x="0.0" y="0.0"&gt; &lt;/rect&gt;
&lt;path class="bond-0 atom-0 atom-1" d="M 280.3,75.0 L 241.7,21.9" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-0 atom-0 atom-1" d="M 263.8,74.8 L 236.8,37.6" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-1 atom-1 atom-2" d="M 241.7,21.9 L 215.1,30.5" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-1 atom-1 atom-2" d="M 215.1,30.5 L 188.4,39.2" style="fill:none;fill-rule:evenodd;stroke:#0000FF;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-2 atom-2 atom-3" d="M 179.2,53.6 L 179.2,80.7" style="fill:none;fill-rule:evenodd;stroke:#0000FF;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-2 atom-2 atom-3" d="M 179.2,80.7 L 179.2,107.8" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-3 atom-3 atom-4" d="M 179.2,107.8 L 241.7,128.1" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-3 atom-3 atom-4" d="M 192.7,98.4 L 236.4,112.6" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-4 atom-4 atom-0" d="M 241.7,128.1 L 280.3,75.0" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="atom-2" d="M 155.4 32.9 L 157.9 32.9 L 157.9 40.8 L 167.4 40.8 L 167.4 32.9 L 169.9 32.9 L 169.9 51.5 L 167.4 51.5 L 167.4 42.9 L 157.9 42.9 L 157.9 51.5 L 155.4 51.5 L 155.4 32.9 " fill="#0000FF"&gt;&lt;/path&gt;
&lt;path class="atom-2" d="M 175.1 32.9 L 181.2 42.7 Q 181.8 43.7, 182.8 45.5 Q 183.8 47.2, 183.8 47.3 L 183.8 32.9 L 186.3 32.9 L 186.3 51.5 L 183.7 51.5 L 177.2 40.7 Q 176.4 39.5, 175.6 38.0 Q 174.8 36.6, 174.6 36.1 L 174.6 51.5 L 172.2 51.5 L 172.2 32.9 L 175.1 32.9 " fill="#0000FF"&gt;&lt;/path&gt;
&lt;path class="note" d="M 291.2 79.8 Q 289.5 79.8, 288.6 78.6 Q 287.8 77.3, 287.8 75.1 Q 287.8 72.8, 288.6 71.6 Q 289.5 70.3, 291.2 70.3 Q 292.9 70.3, 293.8 71.6 Q 294.6 72.8, 294.6 75.1 Q 294.6 77.3, 293.7 78.6 Q 292.9 79.8, 291.2 79.8 M 291.2 78.8 Q 292.2 78.8, 292.8 77.8 Q 293.3 76.9, 293.3 75.1 Q 293.3 73.2, 292.8 72.3 Q 292.2 71.4, 291.2 71.4 Q 290.2 71.4, 289.7 72.3 Q 289.1 73.2, 289.1 75.1 Q 289.1 76.9, 289.7 77.8 Q 290.2 78.8, 291.2 78.8 " fill="#000000"&gt;&lt;/path&gt;
&lt;path class="note" d="M 242.8 15.1 L 244.8 15.1 L 244.8 8.2 L 242.5 8.9 L 242.2 8.1 L 245.1 6.8 L 246.0 7.0 L 246.0 15.1 L 247.9 15.1 L 247.9 16.2 L 242.8 16.2 L 242.8 15.1 " fill="#000000"&gt;&lt;/path&gt;
&lt;path class="note" d="M 167.2 19.4 Q 167.6 18.5, 168.4 18.0 Q 169.2 17.5, 170.3 17.5 Q 171.7 17.5, 172.5 18.3 Q 173.3 19.0, 173.3 20.4 Q 173.3 21.7, 172.3 23.0 Q 171.3 24.3, 169.2 25.8 L 173.5 25.8 L 173.5 26.9 L 167.2 26.9 L 167.2 26.0 Q 168.9 24.8, 170.0 23.9 Q 171.0 22.9, 171.5 22.1 Q 172.0 21.3, 172.0 20.4 Q 172.0 19.5, 171.5 19.0 Q 171.1 18.5, 170.3 18.5 Q 169.6 18.5, 169.1 18.8 Q 168.6 19.1, 168.2 19.8 L 167.2 19.4 " fill="#000000"&gt;&lt;/path&gt;
&lt;path class="note" d="M 171.7 114.1 Q 172.6 114.3, 173.1 114.9 Q 173.5 115.5, 173.5 116.4 Q 173.5 117.2, 173.1 117.8 Q 172.7 118.4, 172.0 118.8 Q 171.3 119.1, 170.3 119.1 Q 169.3 119.1, 168.6 118.8 Q 167.8 118.4, 167.3 117.7 L 168.0 116.9 Q 168.6 117.6, 169.1 117.8 Q 169.6 118.1, 170.3 118.1 Q 171.2 118.1, 171.7 117.6 Q 172.2 117.1, 172.2 116.4 Q 172.2 115.5, 171.7 115.0 Q 171.1 114.6, 170.0 114.6 L 169.3 114.6 L 169.3 113.7 L 169.9 113.7 Q 170.9 113.7, 171.5 113.2 Q 172.0 112.8, 172.0 111.9 Q 172.0 111.3, 171.5 111.0 Q 171.1 110.6, 170.3 110.6 Q 169.6 110.6, 169.1 110.9 Q 168.6 111.2, 168.2 111.9 L 167.3 111.4 Q 167.7 110.6, 168.4 110.1 Q 169.2 109.6, 170.3 109.6 Q 171.7 109.6, 172.5 110.2 Q 173.3 110.9, 173.3 111.9 Q 173.3 112.7, 172.9 113.2 Q 172.5 113.8, 171.7 114.1 " fill="#000000"&gt;&lt;/path&gt;
&lt;path class="note" d="M 247.5 140.0 L 248.6 140.0 L 248.6 141.0 L 247.5 141.0 L 247.5 143.2 L 246.3 143.2 L 246.3 141.0 L 241.5 141.0 L 241.5 140.2 L 245.5 133.9 L 247.5 133.9 L 247.5 140.0 M 243.0 140.0 L 246.3 140.0 L 246.3 134.7 L 243.0 140.0 " fill="#000000"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolToSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceCore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labelByIndex&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceCore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labelByIndex&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;*CCO.[1*]:ccnc:[2*]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[13]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;指定参数 &lt;code&gt;labelByIndex=True&lt;/code&gt;，片段中虚拟原子 &lt;code&gt;[*]&lt;/code&gt; 编号就能与母核上的原子索引一致。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[14]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rdkit.Chem&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Draw&lt;/span&gt;

&lt;span class="n"&gt;core&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmarts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'[*]CO'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;display&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceCore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;replaceDummies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceCore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;replaceDummies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;

&lt;span class="n"&gt;Draw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolsToGridImage&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;molsPerRow&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;subImgSize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;150&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[14]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAACWCAIAAACNeWFmAAAABmJLR0QA/wD/AP+gvaeTAAAgAElEQVR4nO3dd1xT5/4H8G8SCMuwRDGgIEsQXCyVotSFo4CIirU/Ra0VLhbFdSvYq6Vqq+i1Gq0LtVXqLA4UERW0BQGrCIoouFgOBBlC2JDx/P44NpcihBCSnIzn/eqrr5Y8OefjgG/OMykIIcAwDMMwVUUlOwCGYRiGkQkXQgzDMEyl4UKIYRiGqTRcCDEMwzCVhgshhmEYptJwIcQwDJO8hoaGyspKPp9PdhCsa7gQSkV1dTWXy62vryc7CIZhslZXV7d7925ra+uFCxc6OjqWlpaSnQjrAi6EkpeUlOTg4ODr6+vs7PzgwQOy42AYJiOVlZXr168fMGDAypUry8rK0tLScnJypkyZUlVVRXY0TBhcCCWpubk5NDR0ypQppaWl6enpz58//+STT/bt20d2LgzDpKu8vPz777+3srL68ccf2Wy2u7t7XFxcQUGBg4PDo0ePJk2aVF1dTXZGrHMIk5Dc3Nzhw4cDgLq6ekRERENDQ2hoKPGb7OvrW1VVRXZADMMkr7i4ODQ0VEtLi/hmnzRp0u3btwWvvnv3zs7ODgDc3Nzq6upIzIkJgQuhBPD5/KioKG1tbQCws7PLysoSvBQbG2tgYAAAAwYMSEtLIzEkhmGSVVBQEBQUpK6uDgBUKtXb2zsjI+PjZq9evRo4cCAATJgwoampSfY5sS7hQthT5eXl3t7exIfBgICA+vr6dg1evnzp7u4OAGpqahERETwej5ScGIZJSk5OTkBAAI1GI0qgv79/Xl6ekPYvXrwwMTEBgMmTJzc3N8ssJyYiXAh7JDExkclkAoC+vv6ZM2c6a8bhcCIiIqhUKvGp8O3bt7IMiWGYpDx48MDf359CoQAAnU4PCAh4/vy5KG98+vSpsbExAPj5+XE4HGnnxLoFF0IxNTU1hYWFCWrbmzdvunzLjRs3+vXrBwB9+/a9du2aDEJiGCYpqampgr4fDQ2NoKCg169fd+sK2dnZhoaGRNcR7hmSK7gQiiM3N3fEiBFi9Ha+e/du8uTJAEChUEJDQ1tbW6WaE8OwnktNTZ04cSJRAnv16hUaGip2p86dO3cYDAYALF68mM/nSzYnJjZcCLun7bwYW1vbtvNiRL8Ci8UiBthHjRpVWFgojZwYhvUQn8+Pi4sbOXIkUQJ79+4dERHR8+nfaWlpOjo6ABAaGiqRnFjP4ULYDeXl5T4+PoJ5MT2ZDJ2SkmJqagoAenp6MTExEgyJYVgP8Xi8uLg4Jycn4pu9b9++ERERNTU1krp+YmKihoYGAGzYsEFS18R6AhdCUbWdF3P69OmeX7CiooIYciC6SfFcMgwjXWtra3R0tK2tLVECzczMWCxWY2OjxG8UGxurpqYGAFu2bJH4xbHuwoWwa2LMixER0U1Kp9MBwMnJ6cWLF5K6MoZh3dLc3BwVFTVgwACiBFpYWLBYLKl+PD179iyxAGPHjh3SuwsmClwIu5CXlyfevBjRZWZmWltbAwCDwThx4oTEr49hmBB1dXUsFotY5wcADg4O0dHR4q1w4PF4Fy5cWLVqlYjtjx49SqVSKRRKVFSUGLfDJAUXQmGio6PFmBfD4XCuX7/erRvV1NTMmTMHAPT09FesqGxo6H5WDMO6ic1mR0ZGEksaAGD48OHR0dFcLleMS7UbVuxwi5kO/fzzz8Sq/JMnT4pxX0wicCHsmNjzYoqLi8eOHUuhUK5cudLdmx48eNDD4zwAcnBAjx93990YhomqvLw8IiJCX1+f+B4n9sgWbz1Dz4cVt27dSvQ5xcenihEA6zlcCDuQlJRE9JN0d17MyZMn9fT0AKB///4pKSli3DovDw0digCQpiZiscS4AIZhwpSVlYWFhRE9PYISKN6lOhxWFG830fXr148cOZ3BaI6PFy8L1iO4EP5Dc3OzYF7M+PHjRd85gs1mBwUFEd8PM2fOrKysFDtDYyMKDUUACADNnImqq8W+EoZh/1NUVBQaGqqpqUlM1fb29r5z5454l5LgsKLAmjU8AKSlhf78syeXwcSBC+H/iD0v5u7du8RsFy0tLZaEnuPOnkX6+ggAmZujv/6SyCUxTEXl5+cHBQURyxWIYyIyMzPFu5QEhxXb4fPR0qUIAOnooFTcRSpbuBB+IJgXY2Fh0fY4MeG4XG5kZCSxTYyLi8uzZ88kGKmoCI0ejQCQmhqKiEB4b0IM666HDx8KjolQV1cPCAh48uSJeJeS4LBiZ/h89NVXCADp6SFxKzUmDlwIxZ8X8/LlSw8PD8GK+JaWFolna25GoaGIQkEAyMcH9aDDFcNUS3p6ure3d9tjIsRepyvBYcUucblo7lwEgIyM8Iw52VH1QiiYF6Onp3fq1CnR33j27FnixN1+/fpdvXpVegkRQpcuIUNDBID690e3bkn1Vhim8NoeE6GjoxMaGir2JhgSHFYUXWsr8vZGAMjYGD19Ku27YQipciEUe15MbW2tYF6Mn59fT+bFiO7VKzRmDAJANBqKiECSGJIgTUNDQ3p6+u7duwMCAi5fvvzw4UOyE2FKIikpafTo0cT3JoPBCA0NLS0tFe9SEhxWFENLC5o6FQGgAQNQUZHMbqu6VLQQtpsXI/pYtzTmxYiIw0EREYhKRQBo/HhUUiLLm/cIh8N5/PhxdHR0aGiou7s7saUcoV+/fr17936KP/diPVNaWkp8RwNAnz59fvzxR7H3yJbgsGJPNDQgDw8EgKytFembXUGpYiGMjo4mjkERe16Ms7OzZOfFiO7mTcRkIgDUpw9KSCAlQtc4HE52dvaRI0eCg4NdXFzaVj7iw8fw4cO/+uqr/fv3e3p6En8QYn9yxzCE0NGjR3v37t27d+/IyMj6+nrxLiLBYUWJYLORqysCQLa2qKyMxCDKT7UKYXl5+fTp0+VzXozoyss/dJtQKCg0FMnJ4b4lJSUxMTHEM59gWoEAk8n09/dnsVipqakNbXaQa2xs/OSTTwDAycmpJ8daYSpu2rRpAHDu3Dnx3i7BYUXJqq5Gjo4IAA0fjnp8EiLWKRUqhD2fF2NsbCzteTEi4vMRi4XU1REAcnVFBQUIIZSXh4KCUFAQ6vAp98IFFBSEzp+XWIYXL4rOnDmzZs2aTz/9lDh0uy1ra+u5c+fu2LEjOTm5trZWyHUqKiqI7akmTJhA7icMTHGFhIQAwM6dO7v7RgkOK0rJu3do8GAEgEaPRkK/kzDxqUQhVKx5MaJLTUUDBiAAZGCA/voLJSZ+2I9m0CD08ekx4eEIAIWFiX+7khIUF4ciIpC3N+rTB40e/d92z3ze3t4RERFxcXHl5eXdunJBQYGxsTEAzJs3T7ILszAVsXPnTgBYtmyZiO2JPbJdXFyIv71GRkYRERHV8rqN0+vXyMICASB3dyRuvy8mjPIXwidPnjg6OooxLyYjI4OseTGiq6lB/v7IygrV1PyvEAKgzZvbtxSjEJaWosuXUUQE8vJCxsb/uzjxj7d3ho+Pz8aNG69cufLu3bse/kLu3bvXq1cvwGd2Y2K5dOkSAEybNq3LljweLyYmZvDgwUQJ7Nu3b2RkZIPcH/jy8iUyN0cAyNOzg4+5WA8peSFsOy8mPT1dxHfxeDwWi0XMixkyZMijR4+kGrKH+HxE9OUQhXDwYMRgIC0tlJ//j2aiFEI2G6WmIhYLBQQge/v2lU9PD7m7o9BQFB0tlaW+V65cIWar7927V/JXx5Ta48ePAWDQoEFC2vB4vAMHDlhYWBAl0MLC4sCBA1I9eleynj9H/fohADRjBurZtqZYe0pbCCsqKpRgXky3EIXw00/R998jADRlyj9e7bAQ1tb+o/IRW9gI/mEw/lH5ZNBneeTIEQCg0WixsbFSvxmmRBobGykUCp1OF97lQ8zMsrS0jIqKapWTaWbdkZODevdGAGj2bMVeTCxvlLMQ3rhxQ7x5MefOnSO20zU2Nk6Q29UJnRAUwsbGD70oZ87879W2hfDYMTR/PrKz+7AqUfCPjg5yd0crV6ITJ9DTp+Tsbvrdd98R3dGir2zBMIQQk8kEgOLiYiFtkpOTY2JiRN9PXw7dvYt0dREAOnSI7ChKRAkL4Q8//ECsBBo3btyrV69EfFfbeTEzZsyQt3kxohAUQoTQmTMIADGZSLCquG0hnDXrQ+VTV0f29iggALFYKDUVycPTL5/PX7x4MTF/gazFmpgiGjNmDADcvHmT7CBSd+sWCg5GXC4qKkKRkSgysuOhiuRkFBmJD3USibIVwvr6+pCQEBqN1t15MTY2NnI+L6ZLbQshQmjCBASABNPo2hbChAR08CDKypKXNYjtcLlcX19fogurDC8kxkSzcOFCADh8+DDZQWQnKenDJ1pn5w56StetQwBo7VoykikaKigXKpV67NgxPp+/ZMkSYpMk4fh8/u7du8eMGfPixYshQ4bcvXt3xYoVMsgpA3v3Ap0OBw5AZmb7l6ZNg3/9C5ycQF2dhGAIoZKSEiENaDTaqVOnRo8eXVhY6O3tXV9fL7NsmOKysrICgIKCArKDkCArC/btIzuEIlO2QqilpTV58mSE0OXLl7ts/Pr16wkTJqxcuZLD4YSGhmZmZg4dOlQGIWVj8GBYvRp4PFi+HBAiO83feDxecHCwo6Njfn6+kGba2tpxcXE2NjaZmZmff/45l8uVWUJMQalsIbSyAk1N2LABhH68xIRRtkIIAH5+fgAQGxsrvNnFixeHDRuWkpJiYmKSmJi4e/duDQ0NmQSUnfXrwcwM7tyBU6fIjvI3Pp9fXFxcUVExbdq08vJyIS379Olz9erVvn37JiQkLF26VGYJMQVlaWkJKlkITU1h2TKorYWVK8mOorDUyA4geT4+PnQ6PTk5ubq6mtgarUNaWlpsNnvGjBmHDx82MjKSZUKZ0dEBFgtmzoSwMJg1i+w0AACgrq5+7ty5Tz/99MGDBz4+Pn/88Qex0LNDVlZW8fHx48ePP3LkiJmZ2YYNG2QZFVMsKvtECAAbNsCJE3DuHMTHw997ppIDIVRTUwMAbDabz+fX19dzOJympqbm5ubW1taGhgY+n29hYTFy5EgyU35ECQuhvr6+h4fHjRs3rly5Mn/+/M6aTZkyJTU11d3dXZbZZM/PD7y84MoVOH6c7Ch/YzAYV65ccXNzy8jImDt37sWLF4WM5rq6up48eXLWrFkRERGWlsPnzZsuy6iYAunTp4+uri6bzX7//j2xCEp16OrC5s0QGAjLlsH48dD5Z0uoqQGEoL4eOBxoaoLmZmhthYYG4PGgthYAoLoaAKCuDrhcaGyElhZoaYHGRuByobWV09Iyr7q6GgBqa2t5PF5DQ0Nra2tzc3NTUxOHwxFxOP+zzz6ztLT8+eefJfFLlwwlLIQA4Ofnd+PGjdjYWCGFEACUvgoS9u2DP//88PdbTjCZzISEhLFjx8bHx4eEhBw8eFBIY19f3/379//667Wvv/bs3RumTpVZTEzBWFpaZmdnFxQUqFohBIDFi+HwYcjIgB9/hC1b2r+6aBFER/f0Fjo66g0NZ7tsRvTD6erq0mg0HR0dOp2uqamppaWlpqbGYDBaWlquX7+ekJDg5eU1VW6+mZWzEM6YMWPZsmXXrl1rbGz8+EggVWNuDmFhEBFBdo5/sre3v3jx4uTJk6OioiwsLMLCwoQ0DgoKKi4OvHuX4u8Pycng7CyzmJgisbKyIgqhq6sr2VlkjUqF/fth1Cj46SeYPx/s7f/xKp//4T/09IBKBR0doNNBUxO0tEBdHXr1AioV9PT+16BXL1BXBy0t0NQEOh10dIBGAz09hFCMvr4+hUJhMBhqamra2toaGhoaGhra2tpEnRMl6n//+9+1a9cGBwfn5uYKGRmRKXJXb0jPqFGjAODixYtkB5GddusI22puRra2PT19QhouXbpEo9EoFEp0dLTwlnw+Wrjww4nEz5/LJh2mYNauXQsAP/zwA9lBZIRYR+jh8b+vfP01AkATJiD0z3WEcrWpOIfDGTFiBACsX7+e7CwfKOGsUYKIc0eViacnIATJyR28pKEBT58CQhAZKetUwk2fPv3nn39GCC1ZsiQpKUlISwoFDh+GyZOhogKmTQOhE04xFUVMHC0sLCQ7CGm2bgUmE/74A+Li/vF1ueoXU1NTi4qKolKp27dvz8vLIzsOgFIunyDMnDkTAC5fvqxqS9ASEyE7m+wQ3bF06dLVq1dzOJzZs2dnC42urg7nzoGjIxQUgI8PNDTILCOmGFR54ihBV/fDh91Vq6Clhew0nRs5cuSSJUtaW1uDg4ORHCxzVtpCaGNjY29v//79+1u3bpGdRaZCQsDREdLSyM7RHTt27Jg/f35tba2Xl9fLly+FtGQw4MoVMDeHjAyYOxdU7EMO1gVcCAEgIAA8PKCwEE6fJjuKUJGRkX379k1NTf3tt9/IzqK8hRBUsnf0/n3Iz4d+/cDNjewo3UGhUH755ZeJEye+ffv2s88+qxY6w5XJhKtXwdAQ4uMhJERmGTEFYGZmRqfTS0pKmpqayM5CGgoF9u8HdXUoLSU7ilAGBgY7duwAgDVr1lRWVpIbRiUKoTw8esvG2bMAALNmgQjbrMoXOp1+4cKFYcOG0el9582jNDcLazx4MCQkgLY2HDokd6OeGIloNJqZmRlCqLi4mOwsZHJwAIXYMjkgIGDixIlVVVXr1q0jN4kyF0InJyczM7OSkpLMj7edVlLnzgEA+PuTnUMsurq68fHX2exrV6/qL1z4vwnfHRo1Ck6fBhoNvv1WAgukMKWhshuttbNxI5ibkx1CBAcOHNDU1Pzll1+SO5zmJyvKXAgpFMqMGTNAZXpHBf2iY8aQHUVcAwb0u3xZQ18fYmJg+fIuGk+fDj//DAhBYCAkJsokHyb3iGFCFZk4+umn8P49xMd38JK2NuTlwfv38P33sk7VLTY2NmvXrkUILVu2jMPhkBVDmQsh/N07ev78ebKDyILi9ou25eAAsbGgoQH798OuXV00XroU1qwBDgdmz1awubKYlKjUfJmkJKiuhs5WsWtrg4EBaGnJNtNH6urqhJ8F9O2339ra2ubm5u7cuVNmqdojdRWj1HG53D59+gDAkydPyM4iddbWCAAlJ5OdQxJOn0ZUKqJQ0PHjXbTk81FAAAJAJiaouFgm4TA5RnT/eHl5kR1E6qqrkaEhotORPP9sq6+vNzc3V1NTe/jwoZBmiYmJAKCtrV1QUCCzbG0p+RMhjUbz9vYGFegdVYJ+0bbmzoWtWwEh+OoruHlTWEsKBY4cgUmT4O1b+OwzeP9eVhExuaQ6Y4TbtsH79+DmBnZ2ZEfpnI6OzvTp07lcbmBgIL/zYX9PT88vvviisbExhKyJ4KSUX1mKi4sDAFdXV7KDSFd4OAJAISFk55CoFSsQANLVRUI/TSKEEJuNhg9HAGjsWNTUJJNwmFyqq6ujUCgaGho8Ho/sLFJUUoK0tRGFgv76i+woXWGz2aampgAQFRUlpFlZWRmxW/f58+dllk1A+Qthc3Mzg8GgUCivXr0iO4sUKVO/qACPh2bNQgDI1BR1+adXUoLMzBAAmj4dcbkyyYfJJWNjYwBQ7u/3wEAEgPz9yc4hmt9//x0A9PT03r59K6TZvn37AIDJZNbU1MgsG0HJu0YBQENDY8qUKQihS5cukZ1FWpSsX1SASoUTJ2DMGCgpgWnToKZGWGMTE4iPBz09iIuDb76RVURM/ij9xNHnz+HoUaDRYONGsqOIZs6cOV5eXmw2W/ghM8HBwW5ubqWlpRtl/gtT/kIIKrDFjHLMF+2QpiZcugR2dpCbC35+XWyfOHQoXLoEurogZ8dfYzKl9BNH160DLhcCA2HwYLKjiGzfvn06OjrHjx+/2fmYP5VKPXjwoLq6+p49e+7fvy/LeCpRCL28vOh0ekpKCukb+UiJQq+j75KhISQlQf/+kJwMixZ1sdD+00+hqAjmzgUA2L4dtm2DhIQOmr16Bdu2wdGjUgmMkUu558tkZEBsLGhpwX/+Q3aU7jA3Nye2j1m6dGlz5xtHDRs2bNmyZTwe77vvtgn/TpcwGXfFkmXKlCkAcOzYMbKDSF5WFgJA/fop+cDY/fuIwUDa2ujxY1HfQqMhAKStjQoL27/0xx8IAI0YIdmMmFwgNnH+/PPPyQ4iFePHIwD0n/+QnaP7Wlpa7O3tAWDjxo1CmtXW1k6fvlVTs2nvXplFU4ExQoIS944qcb9oW46OcOEC/PknODh0742NjXhvbtWixGOEV67An3+CgQGsWUN2lO6j0+kHDx6kUChbtmx59uxZZ80YDMbCheHNzZrffgtv38oom6oUwhkzZlCp1MTExAalO8VOuftF25o0SZzBP3t7uHoVlPEjENYxZR0j5PNh/XoAgA0bwMCA7DRiGTt27MKFC1taWoQfQzhzJvj4QG0t/PvfMgqmKoXQ2Nh49OjRTU1N169fJzuLJCnrfFEJ2roVAGDFCqivJzsKJhPGxsYMBuP9+/fCz/NSOCdOQHY2mJvD11+THaUHduzYYWRklJycfObMGSHN9u6FXr3g9OmOx/glTlUKIQAo5QbcRL/o7NlK3i/aE5Mng5cXvH4t77sPYxJkYWEBytU72tr6YbHEpk2goUF2mh7o3bt3ZGQkAKxatUrIJxUzsw+PvytWgPBD2SRChQohMUwYHx/f2tpKdhaJUZ1+0Z7YvRs0NGD3bnjwgOwomEwoX+/ovn1QWAhDh8K8eWRH6bHFixePGTOmrq5u925hB+StWQPDh0N+PmzZIvVIKlQIra2thwwZUlNTk5KSQnYWyRD0i7q7kx1FvllZwcqVwOXC1193sfoCUw5KtoKiru7DAdRbtypD3w+FQomKOtq3b+7mzZ5373baTE0NoqKASoVt2+DJE+lGUqFCCEo3d/TatTdUKl/p54tKxIYNYGYGd+7AoUNkR8GkT8kmjm7bBuXlMHYseHmRHUVC7O2t584dyOdDYCAIOYVw1ChYvBhaWyE4GDqfWyMBKloIheyDrkCOHh1vbGz+xRdK8t0uVTo6wGIBAHz7LVRVkZ0GkzJl6hotL4c9ewDgw0Oh0vjuO7C0hEePYO9eYc22bYO+feHWLThxQophVKsQOjo6WlhYlJWVZWRkkJ2lp+7fv5+fn48Qd/Roc7KzKAY/P/D2hupqhdmhERObMhXCiAioqwM/P/jkE7KjSJSWFuzbBwCwfj0UF3fazNAQtm8HAFi1CqS3M5hqFUIA8PX1BaXoHT179iwAzJ49m4Y7RkXGYoGWFhw4AJ0v58WUAXEY7Js3b1qE704r9168gF9+ARoNfviB7ChSMHUqzJoFjY1d7A+wYAFMmABVVfDtt9JKonKFkOgdvXDhAtlBeurcuXMA4I8njHaHlRWEhwOXC5s3kx0FkyY1NbUBAwbw+fxiIc8aAGVlZXFxccLbkGvz5gYOBxYtAnt7sqNIx88/g54eXLgAcXGdtqFQ4MAB0NCAI0cgPV0qMVSuEI4ZM6Zfv375+fm5ublkZxFfVlZWfn5+v3793PGE0W4KCwNbW9lt3YSRRZT5MomJib6+vhYWFnp6ei4uLgsWLNi9e3daWlq9fGy+kJWVFRfX39NzpxIvgWUyPyzwXb5c2JYXgwbBN98AQhAcLGxyjdhUrhBSqVQvLy9Q8N5R3C8qNg2ND1MPMOUmyjChoaGhp6dn3759a2trs7Kyjh8/vnLlyrFjx+rp6dnY2MyePXvTpk0XL14sLCwUsh+Y9ISHh7PZNc7OFf37y/7msrN8OTg5watXXfTTrF8Ptrbw+PGHWW8SJrv9veVGfHw8ADg5OZEdRHzW1tYAkJKSQnYQuUacPtHU1MFLxMH3+PQJJbZ9+3YAWLlypSiN379/n5qaymKxgoKC3N3dtbS02v2cZDAYzs7OAQEBLBYrKSmpsrJS2vmJzSANDAyqqqqkfS/S3buHaDSkpoays4U1u3690/NkeoiCyPikQ66WlhbiM2BhYSGxFZNiycrKcnFx6dev35s3b/AToRDE/k36+kChtH+ptRUaGoBGA11d2efCZOH8+fOzZ8/28fGJEzL61Akul/vs2bO8vLzc3NysrKy8vLyPu1iZTKazs7ODg4O9vb2zs/PgwYOpVIl1sCGEXF1ds7Ky/vvf//5bZjtPk2rZMti3D0aNgtu3Qchv5Ny58PvvMG2apPcglXBhVRBz5swBABaLRXYQcYSFhQHAsmXLyA6iAIqLUU4O2SEwMjx48AAAHBwcJHK16urqto+M2tra7X6Q0ul0e3t7wSNjeXl5T2536tQpADA1NW1sbJRIfvnHZiNTUwSADh0S1qy0FOnrIwB04YIk766KT4QAcObMmS+++OLTTz9NTk4W0uzEiRMBAQEdvmTQyTkodDpdR0enw5d69eqlrq7+8dcpFIq+vn7bbL179xaSysbGJj8/PyUlxcPDQ0gzDAC++QZ27IBNm2DDBrKjYLJVV1enq6urpaXV0NBA+bhPoGe4XO6rV6+I50XikbGoqKjdz1Imkyl4XnR2drazsxOx/4bD4djb2+fn5//6669ffvmlZJPLszNn4IsvwNAQnjyBvn07bbZ3LyxfDgMGQF4e9OoloXtLsqoqjtraWk1NTRqNJvyD27FjxyT029wNZWVlQiJlZmYCQL9+/bjKfSC9JPD5aOBABIDS08mOgpGhT58+AFBSUiKDe1VVVf3xxx8sFuurr75ycXH5eJRRW1vb1dX1l19+6fJSe/bsAQA7OzsOhyOD5HJlyhSkpYUuXRLWhsdDrq7IwwO9fi2x+6rJ/ge9PGAwGOPHj7969erly5cXL17cWbOFCxcuXLiww5c6O0CktbW1s7N/6+vrOR3N/OXz+Ww2W/C/nT1rEvB8UdFlZEBxMfTvD25uZEfByGBlZVVRUVFQUGBiYiLtexkaGo4fP378+PHE//J4vJcvXwqGGHNzc588eXLv3r3PP/9c+HXq6+t//PFHANi+fbuamsr9fI6KAi4XrKyEtaFSIZNFQV0AABqTSURBVCEBevfuYOxfbCr3Gy3g5+d39erV2NhYIYVQCOHlSnrOnz8PeB29aASHNUq6YwxTDFZWVnfu3CkoKBg7dqyMb02j0SwtLS0tLX18fIiv1NTU5OTkDBw4UPgbd+zY8e7du9GjR3t7e0s9pfwxF22/SCMjyMyEmzcBAAIDwdCwfYNz56CgALy9wcFBpAuq6BghAJSXl5uYmKipqVVUVDAYDLLjiATPFxUdQmBpCcXFkJ6ubJs0YiKaPHny7du3eTxe27G6ESNG9JLYyJKEVVRUWFtb19bWpqWl4b0yhGOxYNUqAIDAwA6OlPHxgfh4+O036GSOR3uq+0TYt29fNze3tLS0a9euKcoDFtEv6u/vj6tgl3C/qIrbsGFDUlKSlpZWc3MzMaXl+PHjAEClUi0sLEaMGDF06NBhw4YNHz7cwsJC4rNpxLN58+ba2lpfX19cBUV35AgsXNjTM1lVtxACgJ+fX1paWmxsrKIUQry/qOiIflF/f9wvqnIQQv/+97937txJo9EOHDgwffr0tmN19+/fLygoKCgoIEYZAIDBYAwaNIh4ZHRwcBgxYoSRkZHsYxcVFR06dIhGoxFjhJgoBg2C588hOBju34eOpuSLTGLTbhRQUVERADAYjObmZrKzdA3PFxUdn4/MzREAun2b7CiYbPH5/OXLlwMAnU4/f/78xw04HE5BQUFcXFxERIS3tzdxln07TCbT29s7LCwsOjr68ePHsvmO++KLLwBg8eLFMriXEti1CwGgkBA0fjwCQNu2/eNVb28EgH77TdSrqXQhRAgNHz4cAK5evUp2kK4R6+iXL19OdhAFcOcOAkD9+yM+n+womAxxudxFixYBgIaGxiXhc/DbIBbLR0VFhYaGymCxfIeys7OpVKqmpubLly8lfnGlJCiEDx4gGq39vmvdLYQq3TUKAH5+fg8fPoyNjZ06dSrZWbqA+0VFh/tFVVBra+u8efPOnTuno6Nz6dKliRMnivhGfX39MWPGjBkzhvjftovlBSsf8vLy8vLyiFFG6MFi+c6sXbuWeJY1MzPryXVU0IgRsGQJREVBSIj4+66p7qxRQk5OzvDhw/v06ZOVldXZXDI9PT0J7iIonszMTFdXVzxfVBQIgYUFvHwJt2/jmTKqoqWlZe7cuRcvXtTX109ISHCT6B88m81+9OiRYOvR7OzsdmuF1dXVbWxsBFuPjhw50tjYWPTrp6SkjBs3Tl9fPz8/X/iuUpgAMWs0JAT27oXKSrCzg6oquHAB/PwA8KzR7ho2bJiRkVFTU5MYH8TU1dU7q506Ojp0Ov3jr7fbTa0tTU3Nj3ejIOjp6T1+/BgAfH19cRXsUkYGvHwJ/fvD6NFkR8FkorGxccaMGUlJSYaGhteuXXN1dZXs9fX09No+MgLA27dvBZurtX1kFDRo+8jo4OAwZMgQDQ2NDi+OEAoPDweA8PBwXAXFY2QEW7dCUBCEhoKnpzj7rql6Ifz1118rKyv19fVNTEyampo6bMNms/l8/sdf53A4ne0v09nXe6JPnz73799vaWnp7DsKI+B+UZXCZrO9vLzS09P79euXmJg4dOhQGdzUxMTExMREsFi+trb2xYsXgq1HHz58WFpaWlpaeuPGDaJBu0dGoneHeOns2bN37twxMTEh5vhg4vnqKzh6FP76C7ZsgS1buv12lS6Ez58/X7lyJQDs2bOns821heBwOJ2dZN3ZbmoIoZqamg7f0tzcLKQSl5WVbdq06d69e19++eXJkyflZNmTHEIIzp0DAMBjqaqgurp62rRpd+/eNTMzu3Hjho2NDSkxdHV1icHCBQsWAACfzy8sLMzOzn706FFOTk5OTk5RUVG7R0YTE5Nhw4YNGTLkzJkzALBx48aPJ+lgoqNS4eBBcHaGn34CcTYql/hkHkXR1NRETBldtGgR2VlEkpmZSfTErlu3juws8gvPF1UdZWVlw4YNAwALC4uCggKy4whTW1ubmZkZHR0dGho6adKktl2gJiYmvXv3VsH9tXtIMGu0reXLEQCaPRsvnxBZUFAQANjY2NTW1pKdRVQ3b94khh737NlDdhY5tWYNAkCrVpGdA5Oyt2/fOjg4AICdnd2bN2/IjtM9fD6/oKDgwoUL4eHhxIPgxYsXyQ6lYDoshDU1qF8/RKGg/v1xIRRBTEwMAGhqaj548IDsLN1z4sQJCoVCpVI7XCys4vA6ehVRVFRkZWUFAI6OjtJY1SdLu3fvBoABAwbU1dWRnUWRdFgIEULHjyOAD/+IXghJXhVAisLCwsDAQADYtWvXiBEjyI7TPfPmzfv+++/5fP78+fPT09PJjiNf7t7F80WV37Nnz8aOHVtQUODi4nLjxg3i0EHFtWzZslGjRr1+/XrTpk1kZ1EG8+fDhAndfpfKFUIOhzNv3jw2mz1r1qzg4GCy44jju+++CwkJaWpq8vX1ffbsGdlx5AieL6r08vLyxo8f/+bNGw8Pjz/++MPw4wN4FA2VSt23bx+NRtu1a1d2djbZcZTBzz93f99RyT6uyr9Vq1YBgJmZWVVVFdlZxMflcmfMmAEAFhYWpaWlZMeRCyreL5qSknL27FmyU0hXZmYmMc1k6tSpjY2NZMeRJGLtxMiRI3k8HtlZFENNDSooQBUVHb/65g0qKECidzarViFMSEigUChqamq3Ff+HZWNjI7F9hrOzMx5dQAhlZDQRg+SqOV80LCzM09OT7BRSlJqaqqurCwDe3t5NTU1kx5EwNpttamoKAFFRUWRnUQxxcUiC0xxVqGu0pKRkwYIFCKGtW7dKdgcmUmhpacXFxQ0aNCgrK2vOnDlcLpfsRCT7/ff1TKZbcHC6cveL8ni8hISEm8Th3ACFhYW//vpra2urmZmZpaUlQujPP/9MS0sjN6TEJScnT5s2rba2du7cuRcuXNDU1CQ7kYTp6uru3LkTAMLDw8vLy8mOI++eP4dZs8DWFhobJXRFiZVU+cbj8SZMmAAAU6dO5SvRI0NBQQGxq+H8+fOV6dfVXXw+39zcHACU4Fm/M/X19YcOHRo5ciSTyZw0aRLxxePHj5uamjo5OS1evNjPz2/ixIlMJnOVci0fiY+PJyrfkiVLlLvn0MvLCwACAgLIDiLvZs9GACg4WGIXVJVCuGHDBgAwNjZWvhG1e/fu6ejoAEBERATZWUjz119/AUD//v2V+NNAQUHB8uXL4+Pj165dKyiECKHa2tq0tDQ3NzdbW9vExMTq6moSQ0rc77//rq6uDgBLly5V7iqIECouLia+l2/cuEF2FvmVkYEoFKSlhV6/ltg1VaJrNCUlZcuWLVQq9eTJk4It/pSGi4vL77//rqamtnHjxv3795Mdhxxnz54FAH9/fyXefM7S0nLPnj1eXl7Ez0oBBoORnJxsY2Mza9asw4cPK9NOXSdPnpw3bx6HwwkLC9u/fz/ph8BIm7m5+bp16wBg6dKlzc3NZMeRU+HhgBCsXg39+0vuohIrqfKqvLzcxMQElP2B6fDhwwBAo9FUcIsKVegXbWvjxo1tnwhZLJapqWlubm5ZWZmlpaXS9IsePHiQqHxhYWFkZ5GdlpYWe3t7ANi4cSPZWeRRQgICQAYG6P17SV5WyQshn88ndoj38PDgcrlkx5Gu9evXA4C2traK1AMBVegXbatdIayoqPj111+J/z5z5sxrCXYYkWf79u0UCoVCofz0009kZ5G1W7duUSgUDQ2Np0+fkp1FvvB4yNERAaCdOyV8ZSUvhNu2bQMAQ0PDly9fkp1F6vh8/pdffgkARkZGz549IzuO7KxevRoAlOZJqEvtCuHH2Gx2Wlpaa2urzCJJVmRkJABQKBSV3VN30aJFADBu3DgV+WwnImL7NHNz1Nws4SsrcyHMyMig0+kUCuXSpUtkZ5GR1tbWqVOnAoCVlVVZWRnZcWRB1fpFkQiF8OzZs0wm08rKasGCBcePH1esCWLEvDYajXb06FGys5CmsrKS2Dru1KlTZGeRFy0tyMoKAaDoaMlfXGkLYU1NDbE5/Zo1a8jOIlO1tbVOTk4A4OrqWl9fT3YcqVO1flEkQiG8cOHCuHHjmH8zNTWdOnXqjh077t+/L88TL/l8/ooVKwCATqcr/S45XTpy5AgAGBsbv5fsaJjCYrEQABo6FEnjr7DSFsIlS5Y4OTnNmjWrpaWF7CyyVl5ebm1tDQBeXl5Kf86ZSvWL3r9//9atW4GBgW5ubrdu3crMzBTS+NWrV8ePHw8KCrKxsREURQcHh6CgoJiYmJqaGpnFFgWXy128eDEAaGhoqOCEr4/x+fzx48cDwNKlS8nOQr66OmRsjABQfLxUrk9BCEluCqq8OHbs2Lfffqurq3v9+nWi30zV5Ofnu7u7l5eXBwYGHjp0iOw40oIQsrCwePny5e3bt5Vgt6Auffnll0+fPhX8r6Wl5cmTJ7t8V3Nz8717927dunX9+vX8/HziizQazcHBwdPT09PTc+jQoeQuO+HxeF9++eXx48d1dHRiY2M9PT1JDCM/cnNzHR0deTwesU6U7Dhk+u472LwZxo6FW7ekcwOplFdSPXnyxMLCgslkXrhwgewsZLp79y6x4OyHH34gO4uo+Hz+s2fPTp48uWrVKlHOmVPBftEeKi4uPnz48Jw5c8zMzASPia6urt98801cXBwpm9a2tLT4+fkBgJ6eXnp6uuwDyLPw8HAAGDp0qOJOfeq5d+8Qg4EAkPT+dihbIWxoaPDw8GAymWvXriU7C/ni4uJoNBqFQhFMr5dDJSUlcXFxERER3t7eRkZGgo9o8SJ0gqhUv6hkNTQ0JCYmfvPNN46OjoKKOHDgwDlz5uzdu/fFixcyizF58mQAMDAwuHPnjmxuqkAaGxstLS0BYKfEVwwojq+/RgBo5kwp3kLZukZXrFhx9uxZW1vbhIQELS0tsuOQLyoqKjg4WF1d/fLly1OmTCE7DgBASUlJZhuVlZVtXzU1NXVxcXF1dZ0zZ46NjY2Q6yAV6xeVEj6fn5OTc/PmzZs3b+bk5PD5fOLrNjY2kyZNmjhxoqurq3q3j3cTSX19va+v7x9//GFsbJyYmDhs2DBp3EXRXbt2bdq0adra2rm5uQMHDiQ7jqwVFYGdHfB4kJMD9vZSu40Ui6zMXbx4kZg1rlKr6LoUFhYGAAwGIysri5QANTU1qampLBYrICDAwsKi3d9AfX19d3f30NDQmJiYt2/fin5Z3C8qcVVVVXFxccuXL7e1tSWeEd3c3HR0dLy9vaOiot68eSPBe1VXV48ePRoABgwYgL9hhZs1axYA+Pn5kR2EBJ9/jgBQYKB076I8hbCoqIiYHXfmzBmys8gXPp+/YMECAOjTp49surzYbLag8tnb27ebiKGrq0tUvujo6MePH4tdxnC/qPRwOJz09PTNmze7uLgI/uAoFIqLi8t333139+7dHi7DePfu3fDhwwFg4MCB+fn5koqtrN6+faunpwcAqrMkmvDgAaJSkaYmevVKujdSkkLY0tLi6enJZDL/9a9/kZ1FHrW2thIz8aytrUWZhNJddXV1bStfu82Re/Xq1bbySWQpmwquoydLcXFxVFSUv78/g8EQ/JkaGRn5+/tHR0eLscqttLR0yJAhAGBnZ6ccG8LJwK5duwDAzMxMpU7hnjQJAaDwcKnfSEkK4bp164hunFoJHlqsXNhs9ogRIwBg5MiRDQ0NPbxaa2vr48ePo6OjQ0NDnZ2daTRa28qnrq5ub28fEBAQFRX1+PFjaezyivtFZa+pqSkpKSksLMzOzk7wZ02j0ZydnSMiIjIzM0X5syguLiYWudrb23erJ1zFcblcYqMM1ZkGeP36h/21q6qkfi9lKISJiYkmJibm5uY5OTlkZ5FrJSUlxFOUj49Pd4sTh8MRVD53d3cNDY22lU9NTY2ofCwWKzU1tVniWwF+BPeLkqugoIDFYk2aNIlOpwv+GhgbGwcEBMTExHT2efTZs2cDBgwAAGdn58rKShlnVnT37t2j0WhqamrZ2dlkZ5E6Ho83ciQfAG3fLovbKXwhLCkpGTx4MJPJ/OWXX8jOogByc3MNDAwAoLt9yMR6prbPAW0rX2Njo5QCdwj3i8qP+vr6uLi4oKAgU1NTwV8PTU3NSZMmRUZG5uXlCVrm5eURB6KNHTuWzWaTmFlxhYSEAMCoUaPkeas8iTh16tTAgZ7Tpr2UzY8WxS6EHA7Hx8eHyWQGBATgLjIRpaSkaGpqAsC2bdtEf9f58+ft7Ozmz5/PYrHS0tJ63rkqHg6Hk52d/e233+J+UXnD5/Pv3bu3cePGkSNHth0ktrOzW7NmzcGDB4lFouPGjVOpUS7JYrPZxAeOQ4cOkZ1FilpbW62srABAZo83il0IN2/ezGQynZyc8L603RITE0OlUikUSrQ0NnKXtJKSkpiYGKJLVnD8+qRJkw4cOEB2NKxjFRUVMTExAQEBRPcDABA9qNOnT5dBt7lyO336NAAYGhq+e/eO7CzSsmfPHgCwtbWV2VbJCrygPjk5ef78+VQq9fz5866urmTHUTD79+8PCQlRV1e/cuWKvG3tmJ+fL1huf//+/bq6uravWltbu7i4zJo1a/bs2WQlxETE5XJv376dkJDA4XCcnJzmzJkjpbX5KsXb2/vKlSsLFiyIjo4mO4vk1dfXW1tbv3v37uLFi76+vrK5qaIWwoqKCk9Pz/Ly8nXr1i1fvpzsOApp9erVu3bt0tXVTUlJISaUkuXt27dZf7t7925FRUXbV5lMpvPfRo8eTZzThmEqq6CgYOjQoU1NTTdv3pwwYQLZcSTs+++/37hx46hRo/766y+Z7QWvkIWQz+f/3//9361bt9zd3c+cOdNu7j4mIoTQggULTpw4YWJicvv2bVke01FTU5OZmZmWlpaVlZWZmVlWVtb2VQMDA2dnZ3d3d2dn55EjRxobG8ssGIYphB9++GHDhg2DBg16+PAhMeSvHCoqKqytrWtra//8889x48bJ7L4KWQhZLNb27duNjIySkpLwT8meaG1t/eyzz27evGlvb5+WliYY0ZE4Npv96NEjwWNfXl5e21f19PSGDBkieOwjTlTGMKwzra2tI0aMePLkyaZNmzZs2EB2HIlZvnz53r17fXx84uLiZHlfxSuEd+/e9ff35/P5p06d8vDwIDuOwqutrR07dmxOTo6Hh8f169cl9emyrq7u4cOHgsr35MmTtn/TGAzGsGHDBJXv423YMAwT7tatW+PGjaPT6Q8fPrS1tSU7jgQUFRUNHjyYw+Hcv3+f2IFPZtRkeTMxVFVVzZs3b+nSpYJRUwaDYWZm5u3tjaugROjq6iYkJBAnni9cuPD06dPtNkgTEYfDycnJIXo7s7Kynj59KjjHAADodPrQoUOJ3k5nZ+fBgweLdxcMwwgeHh4BAQG//fZbaGjo9evXe3i1pqam5ubmzv7dkwZMJjM3N1eUDP/5z39aWloWLVok4yoI8vxEyOFw1NXV+Xy+hYXFkSNHPD09+Xw+8dOzoaFBQ0NDTU3eq7gCyc3NHTNmTE1NzerVq3/66SdR3sLlcp89eyZ45rt3715ra6vgVXV1dRsbG8Ez38iRI9tuQYJhWM9VVVXZ2dlVVlaePn167ty5orxl06ZN0dHRXC6XWM1ZU1Mj7ZCmpqZv3rzpstnDhw+dnJzodPqzZ8/MzMyknaodeaklFRUVx44du3btWkREBPGoN3/+fH19/fDwcFNTUyaTeeTIkSNHjiQkJBgaGhIHr2MS5ODgEBsbO3Xq1J07d/bv33/VqlUft2lX+bKysohPggRilzVB5XNxcVGmMXwMk0O9e/feunVrYGDgqlWrpk6dqq+v3+Vb2Gx2YWHhx1/X1NTU0tL6+N9CXhKxmYjnwq5du5bP54eEhMi+CoKcPBHu2rVr7969Q4cOzcjI2L17t7+/P/HFzMzMvLy8uro6AwMDMzMze3v7wMBAUn6bVMSZM2fmzZuHEPrtt9/mz58PAIWFhYLezgcPHjQ2NrZtb2lpKejtdHJyEqx2xzBMNhBCEyZMSE5ODgkJ2bt3b5ftKyoq6urqaDSarq4uAEhvfly3pKSkjBs3Tk9Pr6CgoHfv3rIPIBeF8OnTp0ZGRkZGRqampiwWiyiEhEOHDp07d87AwOD48eO4b00Gtm/fHhYWRqfThwwZ8uLFi7aL2SkUCrGYneDk5NSrVy8So2IYBgC5ubmOjo48Hi89PZ0461ixIIQ++eSTO3fubNmyZd26daRkkItCKNCuEJ48eXLjxo3p6emLFi3q06fPkSNH8LigDKxcuTIvLy8pKQn+uZjdzc2N2C4SwzC5EhYWtn379mHDhmVlZSncD8mYmJjPP/+cyWTm5+eT1qskm53cRGRiYhITE0P8N5vNHjNmzI4dOxBCxEK33NxcUtOpCh6PV1NTk5CQII0jfDEMk7iGhgYLCwsA2LVrF9lZuofD4RDHW0ZFRZEYQ66fCIkRKeIzQmVlJX4cwTAM69DVq1c/++wzBoORl5fXv39/suOI6sCBA19//fWgQYNyc3NJfJaV67Vc2tragidlXAUxDMM6M23atJkzZ9bV1a1cuZLsLKJqaGjYvHkzAGzZsoXcHl25LoQYhmGYiPbu3aunp3f+/PnLly+TnUUku3btKi0tdXV1nTlzJrlJFGxYFcMwDOsQk8mMiIhYvXr1smXLJkyYID/rrYn1+wBQXV0NALW1tTwe7+3bt9u3bweAyMhI0ndYlIsxwidPnnz//fcAkJqaamtr27dv3+Dg4PHjx5OdC8MwTJHweDxXV9cHDx6Eh4dv3bpV9DcK30GtJxutNTQ0tN1zqi1LS0tbW9uEhASJ/Np7Qi4K4du3b2NjY9t+ZcKECYMHDyYrD4ZhmILKyMhwc3OjUqm+vr7EnpRtn8OIstTS0tLY2Ch4UJM2KpWqp6cHAPr6+hQKhcFgqKmpaWtrf/31115eXgwGQwYZhJOLQohhGIZJSnh4+JMnT7p1kpHYO6h12UxHR0f+90LBhRDDMEzZPHr06O7dux0+h2loaNDpdB0dHcFGaxguhBiGYZhKw8snMAzDMJWGCyGGYRim0nAhxDAMw1QaLoQYhmGYSsOFEMMwDFNp/w9gZUrGtVuvpgAAAO56VFh0cmRraXRQS0wgcmRraXQgMjAyMi4wMy41AAB4nHu/b+09BiDgZYAARiDmAmJuIG5gZHPQANLMLAg6A0QzM8IZ7BAZZtwCcAYDgwbIdEZGsPGMGUyMTAlMzBlMzCwJLKwZTKxsCWzsCewcGUwcDAlsjAmcDAwiTKwMjGzsHGxANaxsjOJNUAeCARfvxjv7A8Vu7QNx5Kak7mtjeQBmS4W72guuPb4fxK5I5neIMl0IZisd0nWILVK3A7FN1O7YW89aYg9i22s32HG61oDZOZdL9nfpfwCzzfy4DyztaACzOePVD0j9ugA2RwwAnpAwxxGkuxsAAAFLelRYdE1PTCByZGtpdCAyMDIyLjAzLjUAAHicfZJLbgMhDIb3cwpfIMgGG/Cii7xUVVUmUpL2Dt33/upPogkTCRWwxOPD+LeZqLXL4fPnl54tHqaJiP8Z7k7fiZmnE7UJ7Y7vHzPtb9vdsrM/f823KwmTCO6gv7Lb2/m07AjtaSOhRBVLtOGg0dwiceB763djIzlEkF7vZCqWbEAmkBxK4Zq5OTdzzz4AFWAMUVk1NxBPq8oANJoBFlEvimPJyeIoxgyHECPukjGJFVrKgCvwBynGCQsOXk1jHXD1odkNDwoc1pLVRgF6A2OQkrM6QGaVwgMQRbk0MosBbqJzihgrlE7b6/VNlhvH+fBSsUcNd+f50GuosNgLpbDUq6HNes5bt55ZLCj3BCqs9DwprPZ0KMy7aIXJSlqjn3Hg88n9E66VrONu6+XfYj79Af7wk5FOMSHyAAAApnpUWHRTTUlMRVMgcmRraXQgMjAyMi4wMy41AAB4nB2OMQ4DMQgEv5IyiXwWYBaM/JQolft7wT0+e2kQGoaFj76/W7ftfe6TVR/X87AeCp3t0B7DYrTFLs0V7ZDuhoKRSTeymn84EgNtSc+UGfcqUJVtWTcXx0246H6TVOdIusaAMYrpWmWNykTFHWOQMajUhNv8XytQV0ozg4GLf2pGgETENdvr+gFHFCtNHMMFLQAAAQN6VFh0cmRraXRQS0wxIHJka2l0IDIwMjIuMDMuNQAAeJx7v2/tPQYg4GWAAEYg5gZiHiBuYGRjSADSTExsDhpAmpkFQWeAaGZGOIMdIsOMWwDOYGDQANnCCLGKkYGRKYOJiTmBmSWDiYU1gZUtg4mNPYGdI4GDM4OJkzGBnSmBi4FBhImVkYmdg5ONmYWVjZ1JvA/qVjDgjtore6DMsmc/iGN/bMN+wad5e0Hszs5DtpenLtsHYutHJ9nLvTkDVpPaLeGgLXwczK7/6+pQOicfrIahWthBKrjVHsScKeln7/+lDsxmXpO7z0+c1QGsd9mp/fkntoHFvz+rPHD0mw7YHDEAKME5+XCfArcAAAFhelRYdE1PTDEgcmRraXQgMjAyMi4wMy41AAB4nH1SSW7DMAy8+xX8gA2KiyQeekjioCiKOECT9g+99/8omcCRgwqVTEMShkNxRgPE+Jjfv3/gMWgeBgD85zMz+GJEHE4QC9gfX98WOFx3+/XkcP5crhdICRJ5js9n7O56Pq0nCQ4w0iRZciUY04SmigI44W20XApkmrgmVITRAVqZekh2pJ+aWLUAMiln6gDlBqxVyCs6d0avnjtAdSB5aVasAVRVKj3GDAuwl2a1EqWJ2Uw7wHJnRGFv27uWpC7sX1x1Qr+it1yqL5zMUo/PQp2oRwmTM2MxldIBJrzrGOIhe2mhYtbrxf37gJEnQylEwZ6LZsENFE67y+UlrRnHZX4y9273/rzMze6Y1DwVD27GSUSzJ6Y2E3wDuUktHqUJKh616SYe1uQRj7RVQeJHm2Yj4XEVf7np9oK3vW07if366H09/AIN+J6lVdFy8AAAAK96VFh0U01JTEVTMSByZGtpdCAyMDIyLjAzLjUAAHicNY47DgIxDAWvQgnIG/kfWyk5BqJKvyfYw2Mj0VjR5I393vT8vDZt3vvcZ026XfdDRqJOhgOHT3OFdfBQVw84aGCaFaEhQWgdQgthSVj1TM2IbCps4twwQhm1XUdMh8XlilETM+MJS8oUb41FMu2XQZWAOqjkvzVoOANw1H9Sd+g0ExLwwPmv1WXKUp6Z8Li+21QvRSAxeGAAAAAASUVORK5CYII="/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;左边为默认结果，右边为保留子结构中虚拟原子的结果，注意与前文中删除子结构的结果对比，避免具体操作中多删或漏删原子。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[15]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;m1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'OC*c1c2ccncn2cc1'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[15]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[16]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;core&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'[*]CO'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceCore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;requireDummyMatch&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[16]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcIAAACWCAIAAADCEh9HAAAABmJLR0QA/wD/AP+gvaeTAAAeUElEQVR4nO3daVhTZ9oH8DsJmyDBHSnoiLtIUWSxZVFwB2kVFWPBpdXponVg1KJjbasOdKTTkaKj9NWpC4sUZdCKFhFRqixaARHcUCpgWZRWgYAsCSTP+yE2ZhQhZDtL7t81X8o5Sf5cc/H33Oc554RDCAGEEEKq4lIdACGEmA1rFCGE1II1ihBCasEaRQghtWCNIoSQWrBGUc8IhcLAwMAdO3b4+Pg8evSI6jgIUY+DFzwh5WVmZi5fvryqqsrIyEgsFltbWyckJEyZMoXqXAhRCY9GkVI6Ojq2bds2c+bMqqqqyZMnX7hwwdPTs7q6etq0adu2bZNIJFQHRIgyeDSKuldeXh4UFHT58mUDA4MNGzaEhYUZGhpKJJKwsLDw8HCJROLl5RUfH29tbU11UoQogDWKuhEbG/vxxx8/ffr0T3/6U3x8vIeHh+LWzMzMpUuX1tTUDBgwICYmxtfXl6qcCFEFh3r0SrLVpBUrVjx9+jQgIKCwsPCFDgUAb2/v69ev+/j4PH782M/PLyQkRCwWU5IWIarg0SjqnHw1ic/n79mzZ9myZV3sTAjZvXv3xo0bxWKxs7NzYmLiiBEjdBYVIWphjaIXdXR0hIeHy056Tp48+ciRI0p2Yl5e3pIlS8rKyvh8/r59+5YsWaLtqAjRAQ716H+Ul5dPnTp1+/btHA5n06ZNWVlZyh9Xuri4FBYWCgSCxsbGd955Z/ny5S0tLVpNixAd4NEoek5xNSkuLs7T01Pl91m9enVLS4udnd3Ro0ft7e01mxMhWsGjUQTQ2WqSyh0KAMuXL7969er48eNv377t6uq6a9cuDUZFiG7waBTB5cuXg4KCysvLlVlNUt7Tp09Xr14dHx8PAMuWLYuOju7du7dG3hkhWsEa1WuKq0murq5HjhwZOXKkZj9CfqJg9OjRR48enThxombfHyHKYY3qr4qKiqCgoNzcXB6P98knn8juTdLGB5WUlAgEguLiYhMTk2+++fdHH/1ZG5+CEFXw3Kieio2Nff3113Nzc4cOHZqZmRkREaFkh5aWlgoEgqamJuU/a+zYsT///HNwcHBbW1t8vMn8+VBXp2puhGiIID3T0NAQGBgo+38/ICCgrq5O+dceOHBAdn5zw4YNKnz0yZNXLSwIABk2jFy+rMIbIERHWKP6JTc3d/jw4QBgbm6+b98+5V+oTvkqevCAuLkRAGJgQLZuJRKJam+DEI1gjeqL9vb2rVu38ng8AHB1dS0tLVX+tbm5uba2tgDA5/NjY2PVTkK2biVcLgEg06eTmho13w8himGN6oXy8nJ3d3cA4PF4mzZtEovFSr5QnfLt2rlzZPBgAkAGDSJpaZp6V4QogDXKfjExMbITmkOHDr148aLyLywvL3dzc1OhfJX06BGZNYsAEA6HBAcTTb89QjqCNcpmDQ0NQUFBshOaixYt6tEJTcXyvXTpkpYSSqUkIoLweASATJ5Mysu19DkIaRHWKGtdvnyZ2tUk5f30E7G2JgCkf39y6pS2Pw0hDcMaZSE1V5Nk5St72J32Qr7g99/J3LnPB3yRSGefrBVCoTArKysqKmrZsmUODg6JiYm//vor1aGQtmCNsg0NV5OUJJWSqChiZEQAiJMT0fnnq6WpqUnem3Z2dlzu/9zYwuVyx48fr4PjekQJrFFWOXbsWJ8+fVRbTVKtfDUuL4+MGEEAiLk5OXKEqhTdE4vFN2/ejImJ+eCDD+zs7GT//MgZGhra2dktW7Zs3759V65ccXBwAIApU6a0trZSHRxpHtYoSwiFQsXVpCdPnij/WpWX8rVEKCTvvEMACABZtow8fUp1IEIIIe3t7bLeDA4Odnd3NzY2VuxNAwMDWW9GRUVlZWW1tbUpvraqqmrIkCGyc80SvOWAdbBG2UCd1SSVl/K1LSaGmJoSADJuHCkuJoSQX38lAQEkIIAcOtTJ/hUVJCCArFihsQDt7eTGjXsHDx5cvXq1i4vLy73p4OCwcuXK6Ojoq1eviro7m3vz5k3ZoLBmzRqNRUT0gDXKbIonNF1cXFRbTepp+epMUREZO5YAEFNTcu4cuXHj2SGqqSkpK+tkZwBiYaHWJ1ZXk5QUsnUrmTGDmJkRT88Yxeq0srLy8/OLiIjIyspqbm7u6ZtnZmbKujgyMlKtlIhmsEYZTH5Ck8vlBgcHM2g1SXktLSQ4mAwZQp48eV6jAMTH58U9VavR+/fJ0aMkNJR4exM+//n7y/43f/4tgUDw9ddfZ2ZmCoVC9X+d77//nsvlcjicuLg49d8N0QTWKFOxYDVJeY8fE0Ke1Wj//mTkSAJAkpP/Zx8la1R+vOnnRwYNerE3rayInx/ZupWkpJDfftPK7/LVV18BgJGRUUZGhlY+AOkc1ijzCIXCpUuXysbMhQsX9mg1SeXypQNZjQ4eTI4dIwDExoY0Nj7f+qoara8nWVkkKooEBBArqxd7s08f4u5ONm0iKSnk4UMd/SIhISEAYGFhUVRUpKOPRNqENcowly9fln3jcU9PaL6wlE+r1SQlyWuUEDJ1KgEg69c/36pYoxUV5B//IAsWkKFDX+zNvn3JzJlk82Zy/Dih6op4iUSycOFCALC2tsbL8lkAa5RJvvzyS9kJzcmTJ//yyy/Kv1DlpXxaUazRwkLC4xEej1y79myrYo1euvS8N3v3Ju7uJDiYxMSQmzeJVEpZfkWtra0eHh4AYG9vX19fT3UcpBasUcZobm5euXIlh8MJDg7u9vIaOQatJnVLsUYJIatXEwDi6vrs2c+KNdrURIKDSWwsuX2bvk+GfvLkydixYwHAy8vrhetMEbNgjTJGVVUVh8MxMTFR/lIblZfy6emFGq2re7ZGFB1NiIYueNIgZW5YqqystLGxAYAlS5bgZfnMhV9pxxjW1tYuLi5tbW0ZGRnK7J+UlOTo6JiTkyP70rpdu3Zp6Ys/qdK3L3z1FQDAli3w+DHVaf7Xo0eP3N3d//nPf3a9m42NTWpqqoWFRWJi4qeffqqbbEjzqO5x1AM7duwAgHfffbfr3dS5MZTOXjgaJYRIpcTLiwCQtWvpdTR64sQJ2fWhR5R4LsD58+eNjIwAYNeuXTrIhjQOa5RJ7t27BwD9+/dvb2/vYrfr168bGxubm5sfPnxYZ9l04OUaJYQUFxMDA2JgQBITaVSjhJC9e/cCgKGhYXp6erc7HzlyhMPhcLnc//73vzrIhjQLa5Rhxo0bBwAXLlzoerfExMQeLeUzQqc1SgjZsIEAkFGj6FWjhJB169YBAJ/PLyws7HbnsLAwADAxMcnOztZBNqRBeG6UYfz9/QHgxIkTXe8mEAhkl5fqg61bwdoaSkupzvGSnTt3Ll26tLGxce7cuQ8ePOh6588++2zt2rUDBgwODu5fUqKbgEgzsEYZRlajx48fJ4RQnYUuzM0hMpLqEJ3hcDgHDhyYPn16TU2Nr69vfX191/tHRUV5el69dm2sry88eqSbjEgDsEYZxsnJaejQodXV1QUFBVRnoZHFi8HHh+oQnTEyMjp+/LiDg8Pt27fnz5/f1tbWxc48Hu/AgYFublBeDrNmgVCos5hILVijDMPhcObNmwdKzPXsM2wYnDsHR492vvXQITh3Dn74QbeZlMDn81NTU4cMGXLp0qXly5dLpdIudu7VC06ehDFj4MYNWLAAxGKdxUSq4+BsyDiZmZnTpk0bN27c7du3qc5CgZYW6NULOByqc/TQrVu3PDw8Ghoa1q9fv3Pnzq53LisDNzeorYWgIIiLY94vq2/waJR5pkyZMmDAgDt37pTo5UrE5s1gaws//kh1jh4aP378iRMnjI2NIyMjv/nmm653Hj4cTp+G3r3hyBHYulU3AZHqsEaZh8fj+fn5AcAPNJxgtUwqheRkePAALC2pjtJzXl5ehw8f5nK5GzZsiI+P73pnZ2c4ehQMDCAsDPbu1U1ApCKsUUZS8rIn9snJgepqsLUFJyeqo6hkyZIlO3bsIIRs2rQ5O7ur5SYA8PWF//s/AICQEDqe80VyWKOMNHPmTDMzs7y8vMrKSqqz6FRSEgBAQACDTxdu3Ljxb38LNzK68PbbJrdudbPzqlXwxRcgkUBgIFy+rJN8qOewRhmpV69ec+bMIYSkpKRQnUV3pFI4fhwAICCA6ijq+fLLLU5Oo+rrYfZs6PbfwW3bYOVKaG2Ft9+Ge/d0kg/1ENYoU+nhXM/0iV6Oy4X4ePDwgOpq8PWFhoauduZwYP9+mDcPHj8GHx+ordVVSqQ0rFGm8vPzMzIyunjx4mO6PSROa2QT/eLFDJ7o5UxM4ORJGDsWbt4Ef38QibramceDhAR44w0oKwM/P3j6VFcpkXKwRpnKwsLCy8uro6MjNTWV6iy6IFujB+ZP9HL9+sG5c2BjAz/9BO++C11elQ+mppCSAqNGQX4+CATQ0aGrlEgJWKMMpldzfU4O1NSArS1MmkR1FM2xsYHUVLCwgMRE6PapzQMHwpkzMGgQpKbC6tU6yYeUgzXKYP7+/lwu9+zZs83NzVRn0To2TfSKXn8dTpwAIyP46ivYvbubnUeMgFOnwMwMvvsOwsJ0kg8pAWuUwSwtLSdPntza2pqenk51Fu1i30SvyNsbDh0CDgfWrXv2a3bB1RUSE8HAALZuhYMHdZIPdQdrlNn0ZK5n5USvKDAQwsJAKoWlSyE7u5ud/fxg1y4gBD76CMrLdZIPdQlrlNlkNXrq1Ckxq58FxNaJXtGWLbB2LbS1wfz50O3DEtasgc8+g//8B2xtdRIOdQlrlNlGjhxpb2/f0NBw6dIlqrNoC7snekVRUeDvD0+egI9P949tDguDFSsAAPbsAWdncHaGoqJOdtu9G5ydn32FKtISrFHGY/1cz/qJXo7Hg/h4mDwZpNJurslXVF0NBQVQUADvv9/JVVOyrXp2z7CuYY0ynqxGf/jhB7Y+OlYfJno5U1M4dQouX4axY3v82rw82L9fC5lQd7BGGc/R0dHW1rampubq1atUZ9E8/Zno5QYOhNde6/GrZs0CLhf+9jd4+FALmVCXsEbZgMVfK5KdrS8TvZocHCAoCIRCCA2lOor+wRplA/nXhVIdRPP0aqJX044dzx6Yn5FBdRQ9gzXKBu7u7oMGDSotLWXZtzOx5sl4umFtDZs3AwB8/HE3zzpBmoU1ygY8Hu+tt94C1s31ONH31CefwJgxcO8eRERQHUWfYI2yBCsve7pw4baxsYjRz7rXMSOjZzfmR0RAaSnVafQG1ihLzJgxg8/nFxQUlLPl9kCpVPqf/8w0MRksEFRQnYVJZs2CRYugrQ3Wr6c6it7AGmUJY2PjOXPmAMCpU6eozqIZ2dnZNTU1/fr1dXT8E9VZGGb3buDz4fRpOHOG6ij6AWuUPVg21yclJQHA4sWLOTjS95CVFXz+OQDA+vX4gGddwBplj7lz55qYmGRlZf3+++9UZ1GXVCqVXb8VgIv0KgkJAXt7KCmBo0epjqIHsEbZw9zc3NvbWyKRnD59muos6pJN9La2tpNwkV4lhobw7bfA4UB1NdVR9ADWKKuwZq7HiV59Hh6wbBnVIfQD1iirzJs3j8fjpaenNzU1UZ1FdTjRa8rXX0PfvlSH0AMctj4WSG95enpmZ2cnJSUtWrSI6iwqunTp0tSpU21tbe/fv49Ho92qroZHj8DSEmxsOtlaVgb19TBwIAwdqvNkegOPRtmGBXM9TvQ9Ym0NTk4gkXS+dfhwcHLCDtUuPBplm4qKCltbWwsLi99++83IyKiLPRcuXHj9+nVjY2NTU9NOdzA3NzcwMHj551wu18LCotOX9OrVy8TEpNNNFhYWXC53/Pjxy7o8YyeVSocMGVJTU5Ofn+/k5NTFnkhOJILBg6FfPygogD59qE6jfzr5I0GMNmzYsAkTJhQVFWVmZs6ePbuLPauqqsrKynQWTGbhwoVd1yiu0asgPR0aGsDWFjuUGlijLOTv719UVHTixImua/T48eMikUgkErW0tHS6Q2Njo6SzWVEikTQ2Nnb6ktbW1ra2tk43CYVCqVQ6ZsyYrsPjRK8C2eMEcUGOKjjUs1BxcfGECRMsLS1ramq4XCad/saJXgViMQweDPX1cO8ejBpFdRq9xKS/MaQkBweHESNG1NbWXrlyheosPYMTvQrOnoX6enB0xA6lDNYoO82fPx8YuF6PE70KcKKnHA717JSTk+Ph4WFra6v7RSSV4USvApEILC1BKMSJnkp4NMpOb775ppWVVXl5+Y0bN6jOoiyc6FWQng5CIU70FMMaZScul8u4rxXBiV4FONHTAdYoazHrdia8j14FIhGkpAAAMPa+X5bAGmWt6dOn9+nT5/r164w4PYoTvQpwoqcJvPyetQwNDWfOnJmUlLR48eJXrdi86nZPHo/H5/M7fYmpqamxsXGnm/q+4mlCXdxvyufzeTweAOzduxdwou8hnOhpAmuUzWprawcPHlxQUFBQUEB1lu4ZGxtPmDCB6hSMIZ/osUYphzXKWnv37r106ZK5uXlkZKSZmVmn+7zqds+Ojo5XPbG0ublZLBa//HNCSENDQ6cvaWtra21t7TpAbW1tVVVVaGiou7v7UHwekRLkE/3IkVRH0XtYo+x048aN0NBQANi3b98777xDdZzuicXiuXPnZmRk+Pj4ZGVl9evXj+pEdIcTPX3g5fcs1Nzc7OzsXFJS8tFHH3377bdUx1FWY2PjlClTioqKPD0909PTX/XAPQQKV92XluLRKPVwpZ6F1qxZU1JSYm9vHxkZSXWWHuDz+T/++OPQoUOzsrKWL18ulUqpTkRfONHTCtYo28TExMTGxpqZmR07dqxXr15Ux+kZa2vr1NTUvn37JiUlrV27luo49IUTPa3gUM8qpaWlTk5OTU1Nhw8fXrFiBdVxVHTx4sXZs2eLRKLIyMh169ZRHYd2cKKnGzwaZQ+RSCQQCJqamgQCAXM7FACmTp0aExPD5XI3bNgQHx9PdRzaOXsWhEKYNAk7lC6wRtlj3bp1hYWFI0eO3L9/P9VZ1CUQCCIiIgghq1atOn/+PNVx6AUnerrBGmWJ5OTkb7/91tjY+NixY6+6AYlZQkNDQ0JCxGLxggULiouLqY5DFyKRqLLyoZER3kdPI1ijbFBZWfnBBx8AwM6dOx0dHamOozGRkZGLFi1qbGz09fWtrKykOg4tpKenX7z4mqvrXJzo6QNrlPE6OjqWLFlSV1fn5+e3Zs0aquNoEpfLjYuL8/DwqK6u9vHxedVdUnrl2LFjADB3rifVQdBzuFLPeBs3bvz666+HDBlSWFjYv39/quNonlAo9PT0vHHjhpeXV1pa2qsejKIPRCKRpaWlUCgsLS0diYejtIFHo8yWlpa2c+dOAwOD77//npUdCgAWFhapqak2NjY//fTTu+++q8+X5Z89e1YoFE6aNAk7lFawRhmstrb2vffek0ql4eHh7u7uVMfRIhsbm9TU1D59+iQmJm7evJnqOJSRfUEAPtmabnCoZyqpVDp79uyMjAxvb++MjAxmfR+9ajIzM+fMmSMWi6OiokJCQqiOo2s40dMW+//22Co8PDwjI8PS0jIhIUEfOhQAvL29Dx06xOFw1q9fn5ycTHUcXcOJnrb04s+PfbKysv7+97/LFrIHDx5MdRzdCQwMDAsLk0qlS5cuzc7OpjqOTuFET1s41DNPXV3dlClTbt26tWXLlvDwcKrjUOAvf/nLnj17+vXrl5OTM3bsWKrj6AJO9HSGR6MMQwj561//yuVyg4KCtm3bRnUcakRFRfn7+9fV1c2cObOqqorqOLqAEz2dYY0yzP79+zMyMtrb2yMiIjr9Njp9wOPxjhw54ubmVlVV5evrKxQKqU6kdTjR0xkO9UxSVFT09ttvd3R0HDx4cPbs2VTHodiTJ0/c3d3v3r3r7e2dlpZmZGREdSJlEUJ++eWX/Pz8a9eu7dixo9t/DnGipzmsUcZobm6ePXt2WVnZ+++/v337dqrj0EJ5efmbb75ZW1sbGBgYHx9P5y9nrqmpKfjDlStXHj9+LPt5UVGRg4ND169NSUmZN2/epEmTGPENr3pIT6dCJtq4cWNZWZmDg8OWLVuozkIXtra2P/74o5eXV0JCwvDhw8PCwqhO9NzDhw/z8vLy//D7778rbn3ttdecnZ2dnZ2V+fI+nOhpDo9GmSE+Pn7jxo1mZmZpaWkjRoygOg69nDlzRnau49///jeFXz0iFApv3LghP+S8ffu24lYLCwt7e3snJycnJycPD4/hw4cr+bY40dMf1igD3L1719fXt7W1dc+ePQsWLKA6Dh0dOHDgz3/+M4/HS0pK8vf3182HNjU1FRUVyXvzzp07in9N5ubmDg4OTn+ws7NT7ZwDTvT0h0M93YlEojVr1rS2tgYGBmKHvsqqVasqKyu3b98eFBSUkZHh5uamjU9pbm4uLCyU92ZJSYnic1LMzMwmTpwo781x48Zp5O4ynOjpD49G6W79+vWJiYmjR48+c+YM477pU8c+/vjj6OjoAQMGZGdnjxkzRv03bG9vv3fvnrw38/LyxGKxfKuhoeGoUaPkc/rEiRN5PJ76H6oIJ3pGwKNRWktJSUlMTDQ2No6OjsYO7dbu3burq6tPnjzp6+ubm5traWnZ03fo6Oi4e/dugYK2tjb5VgMDAzs7O/nxpouLi7YffpqWliYUCp2cnLBD6QxrlL4qKipCQ0MB4Msvv7Szs6M6DgPweLyEhITp06dfuXLFz88vMzOzd+/eyr988+bNUVFRir3J4/Hs7e2d/zBhwgQTExMtBH8lnOgZAWuUpsRi8YcfftjU1PTWW28FBgZSHYcxTE1NT5065ebmlp+fLxAITp48qfy9Xnw+v62tzcrKSn686eHh0bdvX60G7kJlZWVKSgoALFy4kKoMSBl4bpSmPv/88wMHDgwbNiwtLY0d3/SpS/fv33dzc/vtt99WrVr13XffKfmq+vp6LpdrYWGh1WxdaGxsLC4uVrxkavjw4cOGDcOvmKY5rFE6ysjIWLFihYGBwfHjx52cnKiOw0h5eXne3t7Nzc3bt2//4osvqI7TucbGxmvXrskv0b9//77iVj6f7+/vf/jwYYrSIWVhjdLOw4cPZ8yYUV9fv3379vfff5/qOAx2+vRpf39/iUTy3XffrVy5kuo4AH8s/efk5GRnZ798yZRs6d/Dw8Pd3V2Dl0whbcMapZeOjo5FixZdvXp1+vTpsbGxdL5JnBH279//4Ycf8ni85OTkefPm6T7AC0v/+fn5IpFIvtXAwGD06NHyU7Gurq4MesAKksMapZeIiIjdu3dbWVmdO3dOmbutUbc+/fTTHTt2mJqanj9//o033tD2x0kkkpKSklddMsXj8caMGSPvTWdnZx0v/SNtwBqlkdzcXIFAQAhJTEz08PCgOg5LEEJWrlx5+PDhgQMH5uTkjBo1SuMfUVNTI5/TCwsLW1paFLdaWVnJ5/RJkyaZmppqPACiFl7wRJns7OwHDx4EBQXJf7Jnzx6JRBIaGoodqkEcDmf//v0PHz48e/asj49Pbm7uoEGD1HxPxafe5ebm1tXVKW5VvGTK3d0dpwrWw6NRymzbtu306dP5+fnyn4hEori4uJUrV+LCgsY1NTVNnTq1sLDQxcUlMzPTzMysRy9X7M2ff/75hafeKfbmG2+8MXDgQI1mR3SHNap17e3t58+ft7S0dHR0BID79+8XFBQsWLAgLi7uzJkzx44du3PnTlVV1cyZM6lOynIPHz50c3OrqKjw8/M7ceJE15flNzQ03Lx5Uzaq5+fnP3r0SHFrnz59nJ2dZXO6i4uLXn05K3oZ1qgWPX36NDExcd++fdXV1TNmzIiNjQWA6Ojo8PBwW1tbV1fXBw8emJmZXbhwwd7e/uzZs1TnZb87d+54eHjU1dV98MEH+/btU9z08qXvilsVnxbq5OQ0fvx43QZHtIY1qkVJSUnp6emzZs1KSkoyMTGR1SgAVFRUFBcX/+tf/5I9283Z2XnUqFGGhobUptUTP//887Rp01paWrZv3z5t2jRtPy0U6QOsUV147733JBKJvEYB4ODBgwkJCS4uLuXl5bGxsXi1oC4lJycvXrzYzMysqalJ/kNDQ0MHBwfZnI6XvqMewZV6CsTFxX3++edxcXHjx493c3MLCQmJjo7Ggx2dWbhwYUJCQkVFRXJysouLi+zpTXZ2dhp/WijSE1ijFHB0dAwMDJw2bRoArFu3buTIkdihOiYQCABg06ZNVAdBbIBDvS68PNQjhFgDz/4ghJBasEYRQkgtWKMIIaQWPDeqXa+99prifzo7O8u+FgIhxBq4Uq9daWlpiv/Z01u5EUL0h0ejCCGkFjw3ihBCasEaRQghtWCNIoSQWrBGEUJILVijCCGklv8HJjTqISdG798AAADuelRYdHJka2l0UEtMIHJka2l0IDIwMjIuMDMuNQAAeJx7v2/tPQYg4GWAAEYg5gJibiBuYGRz0ADSzCwIOgNEMzPCGewQGWbcAnAGA4MGyHRGRrDxjBlMjEwJTMwZTMwsCSysGUysbAls7AnsHBlMHAwJbIwJnAwMIkysDIxs7BxsQDWsbIziTVAHggEX78Y7+wPFbu0DceSmpO5rY3kAZkuFu9oLrj2+H8SuSOZ3iDJdCGYrHdJ1iC1StwOxTdTu2FvPWmIPYttrN9hxutaA2TmXS/Z36X8As838uA8s7WgAsznj1Q9I/boANkcMAJ6QMMcRpLsbAAABS3pUWHRNT0wgcmRraXQgMjAyMi4wMy41AAB4nH2SS24DIQyG93MKXyDIBhvwoou8VFVVJlKS9g7d9/7qT6IJEwkVsMTjw/i3mai1y+Hz55eeLR6miYj/Ge5O34mZpxO1Ce2O7x8z7W/b3bKzP3/NtysJkwjuoL+y29v5tOwI7WkjoUQVS7ThoNHcInHge+t3YyM5RJBe72QqlmxAJpAcSuGauTk3c88+ABVgDFFZNTcQT6vKADSaARZRL4pjycniKMYMhxAj7pIxiRVayoAr8AcpxgkLDl5NYx1w9aHZDQ8KHNaS1UYBegNjkJKzOkBmlcIDEEW5NDKLAW6ic4oYK5RO2+v1TZYbx/nwUrFHDXfn+dBrqLDYC6Ww1KuhzXrOW7eeWSwo9wQqrPQ8Kaz2dCjMu2iFyUpao59x4PPJ/ROulazjbuvl32I+/QH+8JORTjEh8gAAAKZ6VFh0U01JTEVTIHJka2l0IDIwMjIuMDMuNQAAeJwdjjEOAzEIBL+SMol8FmAWjPyUKJX7e8E9PntpEBqGhY++v1u37X3uk1Uf1/OwHgqd7dAew2K0xS7NFe2Q7oaCkUk3spp/OBIDbUnPlBn3KlCVbVk3F8dNuOh+k1TnSLrGgDGK6VpljcpExR1jkDGo1ITb/F8rUFdKM4OBi39qRoBExDXb6/oBRxQrTRzDBS0AAAAASUVORK5CYII="/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;指定 &lt;code&gt;requireDummyMatch=True&lt;/code&gt; 后，原分子上相应位置必须也为虚拟原子（与搜索对象完全匹配）后才能进行切除。&lt;/p&gt;
&lt;p&gt;{note begin}&lt;code&gt;replaceSidechains()&lt;/code&gt; 与 &lt;code&gt;ReplaceCore()&lt;/code&gt; 也不修改原分子，仅返回新的分子。{note end}&lt;/p&gt;
&lt;p&gt;回到切除吡咯环的例子，切除吡咯环后得到两个分子片段，形如 &lt;code&gt;C.C&lt;/code&gt; 的分子片段可以用 &lt;code&gt;GetMolFrags(mol)&lt;/code&gt; 函数转化为包含若干单个分子的列表，该函数的可选操作包括&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;asMols=False&lt;/code&gt;：是否以分子形式存储片段，默认为原子索引&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sanitizeFrags=True&lt;/code&gt;：是否检查分子序列&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[17]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;core&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'c1cNcc1'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceCore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;frags&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetMolFrags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceCore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;asMols&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sanitizeFrags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;Draw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolsToGridImage&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;frags&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;molsPerRow&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;subImgSize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;150&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[17]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;
</content><category term="碎碎念"></category><category term="RDKit"></category><category term="Python"></category></entry><entry><title>文献总结｜匹配分子对以外基于 Transformer 的分子优化</title><link href="https://leonis.cc/sui-sui-nian/2023-02-04-summary-doi.org/10.1186/s13321-022-00599-3.html" rel="alternate"></link><published>2023-02-04T00:00:00+08:00</published><updated>2023-02-04T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-02-04:/sui-sui-nian/2023-02-04-summary-doi.org/10.1186/s13321-022-00599-3.html</id><summary type="html">&lt;p&gt;本文介绍于 2022 年发表在 &lt;em&gt;Journal of Cheminformatics&lt;/em&gt; 上的一篇文章，文章原标题为 Transformer‑based molecular optimization beyond matched molecular pairs，目前已经出现许多使用 MMP 的 Transformer 模型，针对这种现状，文章评估了除 MMP 以外其他分子匹配方式对 Transformer 模型表现的影响。&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;i class="fa fa-external-link"&gt;&lt;/i&gt; &lt;a href="https://doi.org/10.1186/s13321-022-00599-3" rel="noopener" target="_blank"&gt;doi.org/10.1186/s13321-022-00599-3&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本文介绍于 2022 年发表在 &lt;em&gt;Journal of Cheminformatics&lt;/em&gt; 上的一篇文章，文章原标题为 Transformer‑based molecular optimization beyond matched molecular pairs，目前已经出现许多使用匹配分子对（matched molecular pairs, MMP）的 Transformer 模型，针对这种现状，文章评估了除 MMP 以外其他分子匹配方式对 Transformer 模型表现的影响。&lt;/p&gt;
&lt;p&gt;尽管 MMP 已经广泛应用在多种分子生成模型中，但 MMP 也存在一定的局限性，例如 MMP 在分子单键处匹配的特点决定了每次只能修改分子中单一部分的结构，这与实际中对分子多部分结构进行改造的方法有所差别。除此以外，化学家改造分子的目的是使其满足一定的性质，目前少有研究关注在模型上以此为目标进行直接的分子优化。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8500?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8500?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;因此文章从分子的结构与性质两个方面考量模型的表现，如图所示，输入序列由性质约束与分子 SMILES 构成，Transformer 生成优化后的分子，评估生成分子是否满足结构与性质两种约束。&lt;/p&gt;
&lt;h2 id="fang-fa"&gt;方法&lt;/h2&gt;
&lt;h3 id="gou-zao-fen-zi-dui"&gt;构造分子对&lt;/h3&gt;
&lt;p&gt;分子的 SMILES 数据来自于 ChEMBL，经过筛选、去重等数据清洗步骤后，需要将以往文献中改造前后的分子组合为分子对，文章使用了 3 种构造分子对的方法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;MMP：对比分子的结构，将仅具有单一部分结构差异的两个分子作为分子对，这种方法获取的分子改造仅改变了分子中单一部分。&lt;/li&gt;
&lt;li&gt;谷本相似度：通过摩根指纹计算两个不同分子的谷本相似度，相似度在相应阈值内的两个分子视为分子对，这种方法获取的两个分子可能具有多部分结构差异，文章中使用的阈值包括&lt;/li&gt;
&lt;li&gt;Similarity (&amp;ge;0.5)&lt;/li&gt;
&lt;li&gt;Similarity ([0.5,0.7))&lt;/li&gt;
&lt;li&gt;Similarity (&amp;ge;0.7)&lt;/li&gt;
&lt;li&gt;分子骨架匹配：同一系列分子中，将具有相同分子骨架的两个分子作为分子对，generic scaffold 则是将骨架中的所有原子转化为碳、所有化学键转化为单键后进行行匹配。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="fen-zi-xing-zhi-you-hua"&gt;分子性质优化&lt;/h3&gt;
&lt;p&gt;收集到大量分子改造的分子对后，根据源分子与目标分子间性质的变化定义了不同的性质描述符，例如 &lt;code&gt;LogD_change_(&amp;minus; inf, &amp;minus; 6.9]&lt;/code&gt;、&lt;code&gt;Solubility_high&amp;rarr;low&lt;/code&gt; 和 &lt;code&gt;Clearance_no_change&lt;/code&gt; 等，这些描述符放置在原始分子 SMILES 前，通过 Transformer 的 self-attention 机制决定对分子的结构改造。&lt;/p&gt;
&lt;p&gt;对于缺少相关性质数据的分子，文章使用性质预测模型确定性质的变化并指定性质描述符。&lt;/p&gt;
&lt;h3 id="ping-gu-zhi-biao"&gt;评估指标&lt;/h3&gt;
&lt;h4&gt;性质约束&lt;/h4&gt;
&lt;p&gt;满足以下条件的生成分子视作满足性质约束：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class="math"&gt;\(|\log D_\mathrm{generated}-\log D_\mathrm{target}|\leq 0.4\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(\mathrm{solubility_{low}}\leq 2.3\ \mathrm{or}\ \mathrm{solubility_{high}}\geq 1.1\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(\mathrm{clearance}=1.3\pm0.35\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;结构约束&lt;/h4&gt;
&lt;p&gt;若生成分子通过了相应算法（例如 MMP）的检查，则可以认为分子满足了结构约束。&lt;/p&gt;
&lt;h3 id="ji-xian"&gt;基线&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Transformer-U：不具有特征约束的 Transformer 模型。&lt;/li&gt;
&lt;li&gt;Random：从测试集中随机选取 10 个具有相同结构约束的分子。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="jie-guo-yu-tao-lun_1"&gt;结果与讨论&lt;/h2&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8501?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8501?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;结果表明，Transformer 具有最好的效果，由于 Transformer-U 没有学习到分子的性质特征，所生成分子中满足性质约束的占比很低。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8502?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8502?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;对比不同分子对算法模型生成分子与训练集的分布，可以发现，在使用谷本相似度的三种模型中，尽管生成分子与训练集的分布吻合程度稍低，但模型生成的满足性质约束的分子并未被结构约束限制住（超出红色范围的淡绿色），这说明使用谷本相似度的模型具有一定探索化学空间的能力。&lt;/p&gt;
&lt;p&gt;使用 MMP、分子骨架的模型中，生成分子与训练集的分布十分吻合，模型学习到了数据特征并在结构约束中生成具有目标性质的分子。对比 MMP 与分子骨架的模型，MMP 模型两种分布的吻合程度更高，对分子的结构改变更小，而分子骨架模型偏向于产生谷本相似度更高的分子。&lt;/p&gt;
&lt;p&gt;结合表中的数据，相比于基于谷本相似度的模型，MMP 和分子骨架模型更容易生成满足结构约束的分子，这是因为于谷本相似度训练集中的分子差异较大，这使得 Transformer 更难获取其中的特征。另一方面，由于分子差异较大，模型更倾向于探索化学空间，能够得到了更多满足性质约束的分子（Similarity (&amp;ge;0.7)），但在探索的化学空间太大时，寻找同时满足性质约束与结构约束的分子就会变得困难，因此较恰当的 Similarity (&amp;ge;0.7) 与 MMP 两组模型表现最好。&lt;/p&gt;
&lt;p&gt;根据分子对匹配方法原理不同，可以将文章中的模型分为 3 类：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;单一部分改造：MMP&lt;/li&gt;
&lt;li&gt;多部分改造但不改变骨架：Scaffold 与 Scaffold generic&lt;/li&gt;
&lt;li&gt;多部分改造且改变骨架：Similarity (&amp;ge;0.5)、Similarity ([0.5,0.7)) 与 Similarity (&amp;ge;0.7)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;从生成分子中也可以看出不同模型的分子改造方式：&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8503?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8503?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8504?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8504?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h2 id="jie-lun"&gt;结论&lt;/h2&gt;
&lt;p&gt;文章评估了包括 MMP 在内的多种分子对匹配方法，虽然 MMP 是目前广泛应用的一种方法，并且在文章的评估中也表现良好，但必须考虑到 MMP 的原理使其对分子做的是单一部分改造，这就会影响分子多样性等指标。在实际应用中，应当根据模型目的考虑多种分子对匹配方法，或者参考该文章的方法评估不同分子对匹配方法对模型表现的影响。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="碎碎念"></category><category term="Literature Summary"></category><category term="CADD"></category><category term="Transformer"></category></entry><entry><title>文献总结｜Molecular Sets (MOSES)：分子生成模型的评估平台</title><link href="https://leonis.cc/sui-sui-nian/2023-01-08-summary-doi.org/10.48550/arXiv.1811.12823.html" rel="alternate"></link><published>2023-01-08T00:00:00+08:00</published><updated>2023-01-08T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-01-08:/sui-sui-nian/2023-01-08-summary-doi.org/10.48550/arXiv.1811.12823.html</id><summary type="html">&lt;p&gt;本文介绍于 2020 年发布在 arXiv 上的一篇文章，文章原标题为 Molecular Sets (MOSES): A Benchmarking Platform for Molecular Generation Models，文章介绍了目前在评估分子生成模型方面存在的问题，并且设计了用于衡量模型表现的一套标准指标，目前 MOSES 已经广泛应用于各类分子生成任务。&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;i class="fa fa-external-link"&gt;&lt;/i&gt; &lt;a href="https://doi.org/10.48550/arXiv.1811.12823" rel="noopener" target="_blank"&gt;doi.org/10.48550/arXiv.1811.12823&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本文介绍于 2020 年发布在 arXiv 上的一篇文章，文章原标题为 Molecular Sets (MOSES): A Benchmarking Platform for Molecular Generation Models，文章介绍了目前在评估分子生成模型方面存在的问题，并且设计了用于衡量模型表现的一套标准指标，目前 MOSES 已经广泛应用于各类分子生成任务。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8452?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8452?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;随着深度学习技术的发展，也产生了大量分子生成模型，但由于缺乏统一的评估指标，难以对比不同分子生成模型间的表现差异。此外，由于在分子生成模型中需要考虑化合物的的物理性质、生物活性、可合成性等不同方面的约束，不同的评估指标带来了混乱的同时也让模型更难泛化推广。&lt;/p&gt;
&lt;p&gt;文章提供了用于分子生成模型的工具套件 Molecular Sets (MOSES)，其中包括标准数据集、数据预处理工具、评估指标和分子生成模型。&lt;/p&gt;
&lt;h2 id="fen-bu-xue-xi"&gt;分布学习&lt;/h2&gt;
&lt;p&gt;MOSES 主要用于评估基于分布学习的模型，例如，训练集数据 &lt;span class="math"&gt;\(X_\mathrm{tr}=\{x^\mathrm{tr}_1,\cdots,x^\mathrm{tr}_N\}\)&lt;/span&gt; 满足未知的概率分布 &lt;span class="math"&gt;\(p(x)\)&lt;/span&gt;，分布学习模型最终用概率分布 &lt;span class="math"&gt;\(q(x)\)&lt;/span&gt; 逼近 &lt;span class="math"&gt;\(p(x)\)&lt;/span&gt;，从而产生与训练集具有相同特征的数据。&lt;/p&gt;
&lt;p&gt;评估分布学习模型的方法就是计算概率分布 &lt;span class="math"&gt;\(p(x)\)&lt;/span&gt; 与 &lt;span class="math"&gt;\(q(x)\)&lt;/span&gt; 间的差值。对于显式模型而言，可以计算得到 &lt;span class="math"&gt;\(q(x)\)&lt;/span&gt;，通常直接评估概率质量函数。而包括神经网络在内的隐式模型只能从 &lt;span class="math"&gt;\(q(x)\)&lt;/span&gt; 中取样，但无法计算出 &lt;span class="math"&gt;\(q(x)\)&lt;/span&gt;。对于这一类模型，MOSES 主要对其生成数据进行评估。&lt;/p&gt;
&lt;h2 id="ping-gu-zhi-biao"&gt;评估指标&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Valid&lt;/strong&gt; 和 &lt;strong&gt;Unique@k&lt;/strong&gt; 用于评估生成 SMILES 序列的合法性与独特性。使用 RDKit 检查生成分子是否满足 SMILES 规则，合法分子比例即为 Valid，用于确定模型是否学习到化学约束。Unique@k 表示在 k 个合法分子中不同分了比例，用于确定模型是否陷入局部最优点。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Novelty&lt;/strong&gt; 表示生成分子中未出现在训练集中分子的比例，Novelty 较低就意味着模型过拟合。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Filters&lt;/strong&gt; 表示生成分子中通过过滤器的分子比例。在构建训练集时，过滤器用于排除非目标的结构，Filters 用于评估模型是否学习到过滤器约束。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Fragment similarity (Frag)&lt;/strong&gt; 用于比较生成分子与测试集分子的片段相似性。首先将分子切割为 BRICS 片段，接着对比片段的余弦相似度：
    &lt;div class="math"&gt;$$
    \mathrm{Frag}(G,R)=\frac{\sum_{f\in F}\left[c_f(G)\cdot c_f(R)\right]}{\sqrt{\sum_{f\in F}c^2_f(G)}\sqrt{\sum_{f\in F}c^2_f(R)}}
    $$&lt;/div&gt;
    其中 &lt;span class="math"&gt;\(c_f(A)\)&lt;/span&gt; 表示片段 &lt;span class="math"&gt;\(f\)&lt;/span&gt; 在数据集 &lt;span class="math"&gt;\(A\)&lt;/span&gt; 中出现的次数，&lt;span class="math"&gt;\(G\)&lt;/span&gt; 表示生成分子，&lt;span class="math"&gt;\(R\)&lt;/span&gt; 表示测试集分子。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Scaffold similarity (Scaff)&lt;/strong&gt; 与片段相似性类似，但是是使用 RDKit 的 Bemis&amp;ndash;Murcko 分子架算法将分子分割为分子骨架，计算分子骨架的相似性：
    &lt;div class="math"&gt;$$
    \mathrm{Scaff}(G,R)=\frac{\sum_{s\in S}\left[c_s(G)\cdot c_s(R)\right]}{\sqrt{\sum_{s\in S}c^2_s(G)}\sqrt{\sum_{s\in S}c^2_s(R)}}
    $$&lt;/div&gt;
    Scaff 用于表示出现在生成分子与测试数据中的分子骨架相似程度。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Similarity to a nearest neighbor (SNN)&lt;/strong&gt; 计算了生成分子 &lt;span class="math"&gt;\(m_G\)&lt;/span&gt; 分子指纹与其在测试数据中最近邻分子 &lt;span class="math"&gt;\(m_R\)&lt;/span&gt; 的来均谷本相似性 &lt;span class="math"&gt;\(T(m_G,m_R)\)&lt;/span&gt;：
    &lt;div class="math"&gt;$$
    \mathrm{SNN}(G,R)=\frac{1}{|G|}\sum_{m_g\in G}\max_{m_R\in R}T(m_G,m_R)
    $$&lt;/div&gt;
    SNN 使用分子的摩根指纹计算生成分子与测试数据中分子的相似程度。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Internal diversity (IntDiv&lt;sub&gt;p&lt;/sub&gt;)&lt;/strong&gt; 在生成分子数据中评估化学多样性：
    &lt;div class="math"&gt;$$
    \mathrm{IntDiv}_p(G)=1-\sqrt[p]{\frac{1}{|G|^2}\sum_{m_1,m_2\in G}T(m_1,m_2)^p}
    $$&lt;/div&gt;
    若 IntDiv&lt;sub&gt;p&lt;/sub&gt; 较小，内部多样性低，表明可能模型发生了模式崩塌。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Fr&amp;eacute;chet ChemNet Distance (FCD)&lt;/strong&gt; 定义为
    &lt;div class="math"&gt;$$
    \mathrm{FCD}(G,R)=||\mu_G-\mu_R||^2+\mathrm{Tr}\left[\Sigma_G+\Sigma_R-2(\Sigma_G\Sigma_R)^{1/2}\right]
    $$&lt;/div&gt;
    其中 &lt;span class="math"&gt;\(\mu\)&lt;/span&gt; 是相应数据集的平均向量，&lt;span class="math"&gt;\(\Sigma\)&lt;/span&gt; 是相应的协方差矩阵。FCD 同时考虑了生成分子的化学和生物性质，FCD 也与其他指标相关，主要用于调试模型的超参数，FCD 越小时模型表现越好。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Properties distribution&lt;/strong&gt; 使用 RDKit 计算了分子的分子量、LogP、SA 分数和 QED，生成相应的特征分布（如下图），通过计算生成分子各特征分布与目标特征分布间的 Wasserstein 距离，就够评估模型是否有效学习到了训练集中的特征。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8453?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8453?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h2 id="jie-lun"&gt;结论&lt;/h2&gt;
&lt;p&gt;文章提出了一套评估分布学习模型的标准指标 MOSES，使用相同训练数据训练了目前已经提出多种分子生成模型，利用 MOSES 评估不同分子生成模型，测试结果表明 MOSES 能够全面评估不同分子生成模型表现，发现分子生成任务中存在的问题。MOSES 提供了大量指标满足了分子生成任务的需求，目前是分子生成研究中的标准工具。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="碎碎念"></category><category term="Literature Summary"></category><category term="CADD"></category></entry><entry><title>RDKit 入门：修改分子与搜索子结构</title><link href="https://leonis.cc/sui-sui-nian/2023-01-03-rdkit-modify-search-molecule.html" rel="alternate"></link><published>2023-01-03T00:00:00+08:00</published><updated>2023-01-03T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2023-01-03:/sui-sui-nian/2023-01-03-rdkit-modify-search-molecule.html</id><summary type="html">&lt;p&gt;介绍使用 RDKit 修改分子以及在分子中搜索 SMARTS 子结构并高亮绘制子结构的方法。&lt;/p&gt;</summary><content type="html">&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="修改分子"&gt;修改分子&lt;a class="anchor-link" href="#修改分子"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rdkit&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="加氢与去氢"&gt;加氢与去氢&lt;a class="anchor-link" href="#加氢与去氢"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;RDKit 默认隐藏了分子中的氢原子，但在优化分子的 3D 构象时，通常又需要在分子中加氢。实现加氢操作可以使用 &lt;code&gt;AddHs()&lt;/code&gt;，去氢可以使用 &lt;code&gt;RemoveHs()&lt;/code&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cc1ccccc1'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetNumAtoms&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;m2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AddHs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetNumAtoms&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;m3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RemoveHs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetNumAtoms&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;7
15
7
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="凯库勒式的转化"&gt;凯库勒式的转化&lt;a class="anchor-link" href="#凯库勒式的转化"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;RDKit 能将芳环中的化学键以芳香键的形式存储下来，使用 &lt;code&gt;GetBondType()&lt;/code&gt; 查询化学键类型，化学键将显示为 &lt;code&gt;AROMATIC&lt;/code&gt; 类型。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cc1ccccc1'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondWithIdx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondType&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[3]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;rdkit.Chem.rdchem.BondType.AROMATIC&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;使用 &lt;code&gt;Kekulize()&lt;/code&gt; 可以将分子转化为凯库勒式，那么芳香键就会表示为单键或双键形式。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Kekulize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondWithIdx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondType&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondWithIdx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondType&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;DOUBLE
SINGLE
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;虽然显示为单键与双键，使用 &lt;code&gt;GetIsAromatic()&lt;/code&gt; 查询化学键是否具有芳香性，可以发现化学键仍具有芳香性，这与化学定义一致。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondWithIdx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetIsAromatic&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[5]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;True&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;若要将分子转化为凯库勒式的同时去除分子化学键的芳香性，可以使用 &lt;code&gt;Kekulize(clearAromaticFlags=True)&lt;/code&gt; 修改分子，分子中的芳香键标记就会被去除。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Kekulize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clearAromaticFlags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondWithIdx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetIsAromatic&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[6]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;False&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;使用 &lt;code&gt;SanitizeMol()&lt;/code&gt; 可以将凯库勒式形式的分子转化为原始形式，化学键类型也将以芳香键标记。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SanitizeMol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondWithIdx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondType&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondWithIdx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondType&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;AROMATIC
AROMATIC
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Atom-类与-Bond-类"&gt;Atom 类与 Bond 类&lt;a class="anchor-link" href="#Atom-类与-Bond-类"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;RDKit &lt;code&gt;Chem.rdchem&lt;/code&gt; 模块中定义了 &lt;code&gt;Atom&lt;/code&gt; 类与 &lt;code&gt;Bond&lt;/code&gt; 类，其中以 Get 为前缀的方法是查询相应的属性，而以 Set 为前缀的方法就是修改分子的原子和化学键，以下列举了一部分修改操作。&lt;/p&gt;
&lt;h4 id="Atom-类"&gt;Atom 类&lt;a class="anchor-link" href="#Atom-类"&gt;&amp;para;&lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SetAtomicNum(int)&lt;/code&gt;：通过原子序数改变指定原子。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SetChiralTag(Chem.rdchem.ChiralType)&lt;/code&gt;：设定指定原子的手性。例如&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Chem.rdchem.ChiralType.CHI_TETRAHEDRAL_CCW&lt;/code&gt; 为 S 构型；&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Chem.rdchem.ChiralType.CHI_TETRAHEDRAL_CW&lt;/code&gt; 为 R 构型。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SetFormalCharge(int)&lt;/code&gt;：设定原子携带电荷数量。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SetHybridization(Chem.rdchem.HybridizationType)&lt;/code&gt;：设定原子杂化类型。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SetIsAromatic(bool)&lt;/code&gt;：设定原子是否具有芳香性。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SetIsotope(int)&lt;/code&gt;：设定原子的同位素。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SetNoImplicit(bool)&lt;/code&gt;：设定原子是否带隐式氢。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SetNumExplicitHs(int)&lt;/code&gt;：设定原子固定显示氢的数量。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SetNumRadicalElectrons(int)&lt;/code&gt;：设定指定原子未成对电子数量。&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'OC(N)C'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetAtomWithIdx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SetAtomicNum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetAtomWithIdx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SetChiralTag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rdchem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ChiralType&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CHI_TETRAHEDRAL_CW&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetAtomWithIdx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SetIsotope&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetAtomWithIdx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SetFormalCharge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[8]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;在修改分子后通常还需要检查步骤，避免出错，还可以输出修改后分子的 SMILES。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SanitizeMol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolToSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[9]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;'N[7C@H]([OH2+])S'&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h4 id="Bond-类"&gt;Bond 类&lt;a class="anchor-link" href="#Bond-类"&gt;&amp;para;&lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SetBondDir(Chem.rdchem.BondDir)&lt;/code&gt;：设定化学键显示形式。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SetBondType(Chem.rdchem.BondType)&lt;/code&gt;：设定化学键类型。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SetIsAromatic(bool)&lt;/code&gt;：设定化学键是否为芳香键。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SetIsConjugated(bool)&lt;/code&gt;：设定化学键是否共轭。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SetStereo(Chem.rdchem.BondStereo)&lt;/code&gt;：设定双键的几何构型，例如&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Chem.rdchem.BondStereo.STEREOCIS&lt;/code&gt; 为 cis 构型；&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Chem.rdchem.BondStereo.STEREOTRANS&lt;/code&gt; 为 trans 构型。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'N[7C@H]([OH2+])S'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondWithIdx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SetBondType&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rdchem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BondType&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DOUBLE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[10]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="RWMol-类"&gt;RWMol 类&lt;a class="anchor-link" href="#RWMol-类"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;RDKit 的 &lt;code&gt;Chem.rdchem.RWMol&lt;/code&gt; 类用于读取与写入分子，定义了更复杂的修改分子的功能，用于修改分子的操作包括&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;AddAtom(atom)&lt;/code&gt;：在分子中添加原子。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AddBond(beginAtomIdx, endAtomIdx)&lt;/code&gt;：在指定的始末位置间添加化学键。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;InsertMol(mol)&lt;/code&gt;：在分子中添加现成分子。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RemoveAtom(int)&lt;/code&gt;：移除分子中指定位置的原子。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RemoveBond(int, int)&lt;/code&gt;：移除分子中指定始末位置间的化学键。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ReplaceAtom(index, atom)&lt;/code&gt;：使用指定原子替换索引位置上的原子。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ReplaceBond(index, bond)&lt;/code&gt;：使用指定化学键替换索引位置上的化学键。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;使用 RWMol 中修改分子的操作，首先要创建 &lt;code&gt;RWMol&lt;/code&gt; 类。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'CC(=O)C=CC=C'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;mw&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RWMol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;mw&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[11]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;使用 &lt;code&gt;AddAtom()&lt;/code&gt;添加原子后，所添加的原子不会与原来分子相连，通常需要搭配 &lt;code&gt;AddBond()&lt;/code&gt; 方法。使用 &lt;code&gt;AddBond()&lt;/code&gt; 添加化学键时，还可以设定参数 &lt;code&gt;order&lt;/code&gt;，设置为 &lt;code&gt;Chem.rdchem.BondType&lt;/code&gt; 类型，可以指定化学键类型。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AddAtom&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Atom&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;mw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AddBond&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;order&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rdchem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BondType&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;UNSPECIFIED&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;mw&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[12]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcIAAACWCAIAAADCEh9HAAAABmJLR0QA/wD/AP+gvaeTAAASOElEQVR4nO3de0xUVx4H8C8DgwwVUURFVHzUByooarURa31Q+nTbbhoauwa3zTajbbOs3ZpSN1FMuk3H/rGhTboyW+Mui5tWNEaxLwsWtdoWqkjRFgUVX1AFCyrymoGZ/eMQSinCMHMfM2e+n//knrn8uCNfzj33nDMBTqcTRETkLoPeBRAR+TbGKBGRRxijREQeYYwSEXmEMUpE5JEgvQsgUkd7O376CXfuYPhwjBz5q0NOJ+x2BAYiMLDnq8QhgwFB/NUgV7E3StKpqMCqVYiIQEwMZszAqFGYNAlvvonm5s4GR45g0CCsWtXLa0+dwqBBeOIJLeslX8c/uSSXQ4fw5JNobMSSJUhOxtChqKpCbi42bcL+/ThwAMOG6V0iyYYxShKpq8Ozz6KpCTt2/Kqz+eab+MMfsHcvXn4ZH36oX30kJ97Uk0T++U/U1cFs7nnDbjLhv/9FVBR27kR5uU7FkbQYoySRvXsBwGzu5VBYGFJT4XRi3z6NiyLp8aaeZNHe3vmAaNas3hssWAAApaVYuBAA7HY0NPRs09ioZokkJ8YoyeLWLXR0YOTIXqYxCWLa040bnf/cswd79mhUG0mNMUqyMBgAoI8dyxwOAL+E7IwZePrpnm1qa7FtmxrVkcQYoySLIUNgNKK+HnY7jMZeGly/DgCRkZ3/jI/HW2/1bFNWxhilgeIjJpJFYCBmz4bNhtLS3hsUFQHA3LlaFkX+gDFKEvn97wHgX//q5dDt2/jf/2AwdLYhUg5jlCSyZg2iorB9O3bs+NXXW1vxwguorcUf/4hJkwZ2zuPHsWcPSkoULJMkw7FRksjw4di5E7/7HVJT8e9/45FHEB6Oqirs3ImLF5GYiMzMAZzt1i089RQuXEBsLI4fx/Ll2LULAQGqVU++ijFKcnnwQRw/jo0b8fHH+PLLzi/GxODvf8df/wqTCQACAhAQ0Plkv4fuh77+GhEROHAAgwbh3DnMmIHPPsPjj2v1k5DPCOBH2pGc7HZcvIimJowYgTFjFDjh5Mn485/xl78ocCqSC8dGSVJGI6KjERaG1lYFztbYiJoaTJ2qwKlIOoxRkldhISZPxrp1CpzKYsGkSUhOVuBUJB2OjZK8QkMB/LJbs9v+8x9kZaGggFviU6/434Lk5XmMOhzYvBlWKz75BHPmKFUXSYYxSvISz+XdjtGff8aqVaiqwoEDGD8eDQ0IDsY99yhYIMmBY6MkLw97o5s24cABVFRgzhxERCAiAi+9pGB1JA1OeCJ5VVdj7FhER6O6Wu9SSGbsjZK8lHrERNQnxijJizFKmuBNPUktKAgdHbDbOVeJ1MPeKEmNHVJSH2OUpMYYJfUxRklqjFFSH2OUpCZitKVF7zpIZoxRkhp7o6Q+xihJzcP1oEQuYIyS1NgbJfUxRklqjFFSH2OUpMYYJfUxRklqjFFSH2OUpMYYJfUxRklm70dEzB016l2bTe9CSGaMUZJZQ0DAyevX6xob9S6EZMYYJZmFhoYCaOZNPamJMUoyY4ySBhijJDPGKGmAMUoyY4ySBhijJDPGKGmAMUoyY4ySBhijJDPGKGmAMUoyY4ySBhijJDPGKGmAMUoyY4ySBhijJDPGKGkgwOl06l0DkVra29uNRmNgYGB7e7vetZC02BslmQUFBQUHB3d0dNi4yROphjFKkuN9PamNMUqS8/MYLSgosFgselchuSC9CyBSl9/GaF1d3WuvvZaTk2MwGJKTk+fNm6d3RdJib1ROTqfz4sWLelfhFfwzRnft2jVz5sycnByTybRx48b4+Hi9K5IZY1RC586dS05OTkxMvHnzpt616M9utwOorKzUuxCNnD9//uGHH3722Wfr6uqWLFlSUlKyefPm4OBgveuSGWNUKm1tbZs3b46Lizt48KDD4aioqNC7Ij1VVVU99thj5eXlI0aMeO6559asWVNTU6N3USqy2+3vvvvu7Nmz8/Pzhw0bZrVaCwsLY2Nj9a7LDzhJFl999dWMGTMABAQEpKam1tXV6V2Rbux2+zvvvCNu54cOHbp06dLAwEAAoaGhr7/++s8//6x3gco7duzYzJkzxS91SkpKbW2t3hX5EcaoDBoaGtLS0gwGA4DJkycXFBT0aNDY2KhLYbooKSm57777RKCsWLHi6tWrTqezvLw8JSUlICAAwODBg9PT02/duqV3pcq4efNm17t/7733fvHFF3pX5HcYoz4vLy9vzJgxAIxGY3p6emtra48G+/btGz58uMViaW5u1qVCzTQ1NaWnp4uO58SJEz/77LMeDcrKylJSUkTCRkZGWiyWlpYWXUpVSl5e3tixY8W7n5aWdufOHb0r8keMUR924cKFRx99VITCAw888MMPP/Ta7MUXXxRtxo0bt23bNrvdrnGd2ti/f39MTAyAoKCgtLS0PjrgR48effDBB7uuidVq9cVrUl1d/cwzz4ifIjEx8fTp03pX5L8Yoz7JbrdnZmYOHjxYjP1lZmZ2dHT00T4/P3/u3LniV27atGnZ2dl9t/ctNTU1qamp4qebM2fOd99958qr8vPzExISxKtiY2Nzc3MdDofapSqio6PDarWGhYUBCA8P7/fdJ7UxRn1Pr2N//XI4HLm5uVOnThUvjIuLy83NVbtUtTkcjuzs7IiICPH4yGKxtLe3u/7yjo6O3NzcyZMni2syf/78vLw89apVRGlp6YIFC7re/StXruhdETFGfUq/Y393c+LEieTk5NraWrvdnp2dPWHCBPF7uHDhwkOHDqlas3rKysoWLlzYFSiXLl1y7zw2m81qtUZHR4tTLVq06PDhw8qWqoimpqaMjAyj0QggOjp69+7deldEnRijPsP1sb/ubt68+fLLL4vHuOvXrxdfbGtrs1qto0aNEsHx0EMPnThxQs3aFdbc3JyRkSGmlI8ePTo7O9vzczY1NWVmZo4cObLrmpw8edLz0yrlk08+EX/8DAaD2Wy+ffu23hXRLxijPsC9sT+n05mXlzdu3Liu5O3xGLexsdFisYSHh4uppikpKRUVFSqUr7BDhw6JKeVieqyyk0Bv375tsViGDBkiAislJaWyslLB87vh2rVrXe/+7Nmzi4qK9K2Hfosx6tXcHvvr/hh37ty5fXQ2b9y4kZ6eHhISIibNmM1mFwdbtVdfX282m8Xcz/j4+K+//lqlb1RXV9fjmlRXV6v0vfog3v3hw4eLdz8jI8Nms2lfBvWLMeq93Bv7++1jXFeS98qVK2azOSgoCEBwcLDZbL5+/brHP4GScnNzR4wYAcBkMmVkZLS1tbnyqt/OonXd5cuXu65JaGhoenp6fX2922cbqIqKiuXLl4t3//HHH6+qqtLsW9NAMUa9kdtjf99///3999/flbyXL18e0Pc9c+ZMamqqGEj1nqU+YqcV8UMtWbKkvLzclVeJrlx0dPSPP/7oyXfvvvwpLCxMg2tis9ksFsugQYMAjBo1SpGRX1IVY9TruDf21z15PXyMe+rUKS9Z6mOz2TIzM++55x4AYq8NF6d2lpeXd02w37Bhg+eVFBcXr1ixQoNrcuTIkenTp3e9+zdu3FDju5CyGKNexO2xvy+//FJMCFXwMe6xY8eWLFkigkOXpT7u7bWhalfu6NGjixcvFiXFxMRYrdYBTVPtW/eNEaZMmXLw4EGlzkxqY4x6C/fG/ro/xp01a9a3336rbFX5+flz5swR59dsqY/be21os8dV9+VP06dPV+Sa5ObmirlWd9sYgbwZY1R/noz9RUZGDjR5B0osf5oyZYqoMD4+XtXlT+7ttdHvHlfK6rH8acGCBfn5+e6d6sKFC4888og4z+LFiz0cySVdMEb15PbYX2VlZVJSkvjdW7Zs2dmzZzUotftSn8TERMWX+ri910a/e1ypRFyT0aNHi5oXLVp05MgR118+0I0RyGsxRnXjhWN//RLLn7ov9SkpKfH8tG7vteHiHleqampqslgsw4YN67ompaWl/b6q+8YIKSkp3ja9jAaEMaoDLx/765dY/tR9qY8ny5/c22vD27pyYvmT+Esgrsm5c+d6bXnnzp3uGyN8/vnnGpdKimOMas0nxv5c4flSH7f32jh58uT8+fO7ktd7ll3V1tamp6eLewVxTWpqaro3yMvLc2NjBPJyjFHt+NzYnyt6LPVJS0tz8f7Uvb02uu9xNWHChE8//dSz8lVx6dIls9nc9elPYvmT2xsjkPdjjGrBp8f+XDGgTzpye6+Njz/+ePz48b7SlTt9+vTTTz/dtfxJPEgMCwt77733+ChJMoxR1ckx9ueKfj/pyO29Nn766aeu5E1ISCguLlbnJ1DM7t27rVbrnTt3ioqKkpKSwsPDJ06c2LUxQlJS0rx583xls33qF2NURW6P/bm3v72XuNsnHbm314aH+9vrZeLEiQDOnz8v/nn58uXuMzFMJhOApqYmnaojhTFGVVRWVmY0GgMDA9etW+fiHajb+9t7m3379sXFxYnQnD59+sqVK8V6/6ioqI8++sjFk5w9e3bZsmXiJE888cTFixdVrVlBYirbqVOnej0q+uNcLy8Nxqi6tm7d6vrDBPf2t/da3Zf6jBs3bkB7bbS0tGRkZIhH3lFRUT63y5GYSHC3YV+xl/ZA998ir8UY9QoSP8a12Wxbt24tLi52fYXP4cOH1dvfXhtiV5fCwsJej06bNg3AmTNntC2K1BIE0pXT6czJyXn11Vfr6+tDQ0M3bdq0fv16cVMvB6PRuHbtWhcbNzQ0vPHGGx988IHT6Zw6dWpWVlbXTb1vCQ0NBdDc3OzGUfI5jFE9nTp1as2aNd988w2AFStWvP/+++Km3j/t2rXrlVdeqaurCwkJSU9P37Bhg7ip90WMUb/CGNVHS0vLli1b3n77bZvNFhUVtWXLltWrV+tdlJ5ycnLEFVi+fHlWVlbXhlI+ijHqVxijOjh8+PDatWvPnDkjxv4yMzPFhB5/tnLlyu3btz///POrV68WU9Z9mgjKlpaWPo4yRqXBGNVU97G/+Ph4q9Xa9aF1fs5oNBYWFupdhWL6Dkoxb5QxKg3GqHZaW1tnzZp19epVk8m0cePG9evXi5n5JB/e1PsVxqh2QkJC1qxZU1BQkJWVJSb0kKxEf5M39X7CoHcB/mXDhg1dH/xJEmNv1K8wRjUl04RQ6oMrY6N366uSz2GMEimPvVG/whglUh5j1K8wRomU1/eUJsaoZBijRMpjb9SvMEaJlMcY9SuMUSLlMUb9CqffEylPfICdyeHo9eikIUNyFi8eOnastkWRWhijRMqbaDI5AdTX93p0UnDwpK++wu3b2hZFauFNPZEKQkMB4G637X0fJV/DGCVSAWPUnzBGiVQQFITgYHR0oK2tl6OMUbkwRonU0UdWMkblwhglUkcfWRkSgsBAtLWho0PjokgNjFEidfTd5TSZAICbPEmBMUqkDhGjdwtKEaO8r5cCY5RIHXxY7zcYo0Tq6Lu/yRiVCGOUSB3sjfoNxiiROhijfoMxSqQOxqjfYIwSqYMx6jcYo0TqYIz6DcYokToYo36DMUqkjr7XKfU9OZ98CmOUSB3sjfoNxiiROrim3m8wRonU0W9vNCQETqeWFZFKApx8I4nUUFWFoiKMH4+FC/UuhdTFGCXSxI0buHYNAQGIjsawYXpXQ0riTT2RynbsQEICRo5EfDzi4hAZifvvx969epdFimFvlEhNL72ErCyEhWHVKsTHw+FASQk+/BCtrfjb3/DWW3rXRwpgjBKpZvt2/OlPiI1FQQHGjPnl62fOICkJNTXYuxdPPaVffaQMxiiROhwOTJmCCxdQXIz583se3b8fTz6JefNw/LgexZGSGKNE6vj+eyQkYPZslJb2ctThQEwMqqtx5QrGjtW8OFISHzERqUOk57x5vR81GDoP9Rqy5FMYo0TqqK8HgBEj7tpg5MhfmpEvY4wSqcNgAACH464NxIfUBwZqVA+phjFKpI7ISAC4du2uDcQh0Yx8GWOUSB1i6LOoqPej7e04fhwBAXcdPCXfwRglUkdsLGbOREUFCgt7Obp7N+rqsHQpe6MSYIwSqWbzZgB44QVUVv7q6ydPIi0NBkNnA/JxnDdKpKYNG2CxwGRCSgoSEuB0orgYe/agvR3/+AfWrdO7PlIAY5RIZXl52LIFRUWdj+aNRixejI0bsXSpzoWRQhijRJpobsbVqzAYMGZM59b3JAvGKBGRR/iIiYjII4xRIiKPMEaJiDzCGCUi8ghjlIjII/8HXkHvLtdyZOAAAADIelRYdHJka2l0UEtMIHJka2l0IDIwMjIuMDMuNQAAeJx7v2/tPQYg4GWAAEYg5gBidiBuYGRjSACJMbMxaABpZhYOCM3ExpABopkZcTKYmDgYPEAGMnEDzWRk0mBiZFZgZtFgYmFVYGXTYGJm52AQYRDPgloJBhysfy0din/8tANxVvZetF84cf4+ELuY6aZ9yP7n+0HsPxvn2f32PwZWc7i+dL+k1WWwmrYAoQPNyyeBxbe1JR/wLGQGq796r8Hudd5HexBbDABTRytjuvCFjgAAARR6VFh0TU9MIHJka2l0IDIwMjIuMDMuNQAAeJx9UltqxDAM/M8pdIE1eli2/LlJllLKJtBue4f+9/5Uakm9C6ZSDGN5JHuGTBDxur58fsFf8DpNAPjP11qDD0HE6QoBYL48PW+w3M7zUVn29+32BgbVOzwfmefbfj0qBAtwaliwGGDKZszZAf5E72TnUSpSSQqcMAlRURsQBfYgNhWrcKJkhMplQMw+0ee4HOUAVoXbgKfO8wubWjMKlIlVZcAsweTEVvxtfu4gy0hMDaIkVcVWY6SS5FwHTHM1PkipetXF+Og24l229cHWX6PnfVu70ZHc/YyU7pqfQe7e+Aa0W0C+StfJvmpXEw12/5T7i2N//BuOp29lb3bHtvOWfQAAAJN6VFh0U01JTEVTIHJka2l0IDIwMjIuMDMuNQAAeJwdjMsJxDAMBVvZowOy0NeWMD65gDQUUvvaOT0YZt6aa81V3vtaZV3z/j2lKro7QyV0VrMOowpKNG5AZ01tI8L0yPg8Y3FXGIRKmS7b0+gqeZA4d2CMaAKDsWlnO5EyNw8YgkmN+m4sQsQ+KV0T6q6Y9vH1/AGTvCJtuza8aQAAAABJRU5ErkJggg=="/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;与 &lt;code&gt;Atom&lt;/code&gt; 类不同，由于在 Python 中无法实例化 &lt;code&gt;Bond&lt;/code&gt; 类，必须通过 &lt;code&gt;GetBonds()&lt;/code&gt; 等方法从分子其他部分复制化学键后再用于替换。&lt;code&gt;ReplaceBond()&lt;/code&gt; 中需要指定化学键的索引，可以通过以下方式得到。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceAtom&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Atom&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;mw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReplaceBond&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondBetweenAtoms&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetIdx&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;mw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondBetweenAtoms&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;mw&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[13]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;其他操作也大同小异，需要注意在原始分子中增删原子后，可能导致原子索引发生变化。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[14]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;InsertMol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'OC(N)C'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;mw&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[14]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;修改完成后，需要将 &lt;code&gt;RWMol&lt;/code&gt; 类转换为 &lt;code&gt;Mol&lt;/code&gt; 对象。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[15]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;m_edit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetMol&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m_edit&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[15]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;rdkit.Chem.rdchem.Mol&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="搜索子结构_1"&gt;搜索子结构&lt;a class="anchor-link" href="#搜索子结构"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;&lt;h3 id="搜索单个分子"&gt;搜索单个分子&lt;a class="anchor-link" href="#搜索单个分子"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;HasSubstructMatch(pattern)&lt;/code&gt;：指定分子结构中是否具有 pattern 目标结构。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GetSubstructMatch(pattern)&lt;/code&gt;：给出分子中 pattern 目标结构的原子索引。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GetSubstructMatches(pattern)&lt;/code&gt;：给出分子中所有 pattern 目标结构的原子索引。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在搜索子结构时，即使在 pattern 中具有立体化学标记，也不考虑分子立体化学的匹配。若要考虑立体化学，需要指定参数 &lt;code&gt;useChirality=True&lt;/code&gt;。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[16]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rdkit.Chem.Draw&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;rdMolDraw2D&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;IPython.display&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SVG&lt;/span&gt;


&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'c1ccccc1O'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;patt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmarts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'ccO'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rdMolDraw2D&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolDraw2DSVG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;450&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;150&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;do&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drawOptions&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;do&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;addAtomIndices&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DrawMolecule&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FinishDrawing&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;SVG&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetDrawingText&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[16]:&lt;/div&gt;
&lt;div class="output_svg output_subarea output_execute_result"&gt;
&lt;svg baseprofile="full" height="150px" version="1.1" viewbox="0 0 450 150" width="450px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:rdkit="http://www.rdkit.org/xml" xmlns:xlink="http://www.w3.org/1999/xlink"&gt;
&lt;!-- END OF HEADER --&gt;
&lt;rect height="150.0" style="opacity:1.0;fill:#FFFFFF;stroke:none" width="450.0" x="0.0" y="0.0"&gt; &lt;/rect&gt;
&lt;path class="bond-0 atom-0 atom-1" d="M 220.0,129.5 L 157.1,129.5" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-0 atom-0 atom-1" d="M 210.6,116.9 L 166.5,116.9" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-1 atom-1 atom-2" d="M 157.1,129.5 L 125.6,74.9" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-2 atom-2 atom-3" d="M 125.6,74.9 L 157.1,20.4" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-2 atom-2 atom-3" d="M 141.2,73.1 L 163.3,34.9" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-3 atom-3 atom-4" d="M 157.1,20.4 L 220.0,20.4" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-4 atom-4 atom-5" d="M 220.0,20.4 L 251.5,74.9" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-4 atom-4 atom-5" d="M 213.9,34.9 L 235.9,73.1" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-5 atom-5 atom-6" d="M 251.5,74.9 L 277.9,74.9" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-5 atom-5 atom-6" d="M 277.9,74.9 L 304.2,74.9" style="fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="bond-6 atom-5 atom-0" d="M 251.5,74.9 L 220.0,129.5" style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"&gt;&lt;/path&gt;
&lt;path class="atom-6" d="M 306.3 75.0 Q 306.3 70.7, 308.4 68.3 Q 310.6 65.9, 314.5 65.9 Q 318.5 65.9, 320.6 68.3 Q 322.7 70.7, 322.7 75.0 Q 322.7 79.3, 320.5 81.8 Q 318.4 84.2, 314.5 84.2 Q 310.6 84.2, 308.4 81.8 Q 306.3 79.4, 306.3 75.0 M 314.5 82.2 Q 317.2 82.2, 318.7 80.4 Q 320.2 78.6, 320.2 75.0 Q 320.2 71.5, 318.7 69.7 Q 317.2 67.9, 314.5 67.9 Q 311.8 67.9, 310.3 69.7 Q 308.8 71.5, 308.8 75.0 Q 308.8 78.6, 310.3 80.4 Q 311.8 82.2, 314.5 82.2 " fill="#FF0000"&gt;&lt;/path&gt;
&lt;path class="atom-6" d="M 324.0 66.1 L 326.4 66.1 L 326.4 73.7 L 335.5 73.7 L 335.5 66.1 L 337.9 66.1 L 337.9 84.0 L 335.5 84.0 L 335.5 75.7 L 326.4 75.7 L 326.4 84.0 L 324.0 84.0 L 324.0 66.1 " fill="#FF0000"&gt;&lt;/path&gt;
&lt;path class="note" d="M 225.3 143.2 Q 223.7 143.2, 222.8 142.0 Q 222.0 140.8, 222.0 138.6 Q 222.0 136.5, 222.8 135.3 Q 223.6 134.1, 225.3 134.1 Q 226.9 134.1, 227.8 135.3 Q 228.6 136.5, 228.6 138.6 Q 228.6 140.8, 227.7 142.0 Q 226.9 143.2, 225.3 143.2 M 225.3 142.2 Q 226.3 142.2, 226.8 141.3 Q 227.3 140.4, 227.3 138.6 Q 227.3 136.9, 226.8 136.0 Q 226.3 135.1, 225.3 135.1 Q 224.3 135.1, 223.8 136.0 Q 223.3 136.9, 223.3 138.6 Q 223.3 140.4, 223.8 141.3 Q 224.3 142.2, 225.3 142.2 " fill="#000000"&gt;&lt;/path&gt;
&lt;path class="note" d="M 149.6 142.0 L 151.6 142.0 L 151.6 135.4 L 149.4 136.1 L 149.1 135.3 L 151.9 134.1 L 152.8 134.2 L 152.8 142.0 L 154.5 142.0 L 154.5 143.1 L 149.6 143.1 L 149.6 142.0 " fill="#000000"&gt;&lt;/path&gt;
&lt;path class="note" d="M 112.1 72.2 Q 112.4 71.4, 113.2 70.9 Q 114.0 70.4, 115.1 70.4 Q 116.4 70.4, 117.2 71.2 Q 118.0 71.9, 118.0 73.2 Q 118.0 74.5, 117.0 75.8 Q 116.0 77.0, 114.0 78.5 L 118.1 78.5 L 118.1 79.5 L 112.1 79.5 L 112.1 78.6 Q 113.8 77.4, 114.7 76.5 Q 115.7 75.7, 116.2 74.9 Q 116.7 74.1, 116.7 73.3 Q 116.7 72.4, 116.3 71.9 Q 115.8 71.4, 115.1 71.4 Q 114.4 71.4, 113.9 71.7 Q 113.4 72.0, 113.1 72.7 L 112.1 72.2 " fill="#000000"&gt;&lt;/path&gt;
&lt;path class="note" d="M 153.1 11.1 Q 154.0 11.4, 154.4 12.0 Q 154.8 12.5, 154.8 13.4 Q 154.8 14.1, 154.5 14.7 Q 154.1 15.3, 153.4 15.6 Q 152.7 16.0, 151.8 16.0 Q 150.8 16.0, 150.1 15.6 Q 149.4 15.3, 148.8 14.6 L 149.6 13.9 Q 150.1 14.5, 150.6 14.7 Q 151.0 15.0, 151.8 15.0 Q 152.6 15.0, 153.1 14.5 Q 153.6 14.1, 153.6 13.4 Q 153.6 12.5, 153.1 12.1 Q 152.5 11.7, 151.5 11.7 L 150.8 11.7 L 150.8 10.7 L 151.4 10.7 Q 152.3 10.7, 152.9 10.3 Q 153.4 9.9, 153.4 9.1 Q 153.4 8.5, 153.0 8.2 Q 152.5 7.8, 151.8 7.8 Q 151.1 7.8, 150.6 8.1 Q 150.1 8.4, 149.8 9.0 L 148.9 8.6 Q 149.2 7.8, 150.0 7.3 Q 150.7 6.8, 151.8 6.8 Q 153.1 6.8, 153.9 7.4 Q 154.6 8.1, 154.6 9.1 Q 154.6 9.8, 154.2 10.3 Q 153.9 10.8, 153.1 11.1 " fill="#000000"&gt;&lt;/path&gt;
&lt;path class="note" d="M 227.7 12.7 L 228.7 12.7 L 228.7 13.7 L 227.7 13.7 L 227.7 15.8 L 226.5 15.8 L 226.5 13.7 L 221.9 13.7 L 221.9 12.9 L 225.8 6.9 L 227.7 6.9 L 227.7 12.7 M 223.3 12.7 L 226.5 12.7 L 226.5 7.7 L 223.3 12.7 " fill="#000000"&gt;&lt;/path&gt;
&lt;path class="note" d="M 257.0 64.7 Q 257.8 64.7, 258.4 65.1 Q 259.1 65.4, 259.4 66.0 Q 259.8 66.7, 259.8 67.5 Q 259.8 68.4, 259.3 69.1 Q 258.9 69.7, 258.2 70.1 Q 257.4 70.4, 256.6 70.4 Q 255.8 70.4, 255.0 70.1 Q 254.3 69.8, 253.8 69.2 L 254.5 68.5 Q 254.9 68.9, 255.5 69.2 Q 256.1 69.4, 256.6 69.4 Q 257.4 69.4, 258.0 68.9 Q 258.5 68.4, 258.5 67.5 Q 258.5 66.6, 258.0 66.1 Q 257.4 65.7, 256.6 65.7 Q 255.8 65.7, 254.9 66.0 L 254.2 65.7 L 254.7 61.4 L 259.2 61.4 L 259.1 62.4 L 255.7 62.4 L 255.4 65.1 Q 256.2 64.7, 257.0 64.7 " fill="#000000"&gt;&lt;/path&gt;
&lt;path class="note" d="M 325.4 92.1 Q 326.2 92.1, 326.8 92.4 Q 327.4 92.7, 327.8 93.4 Q 328.1 94.0, 328.1 94.8 Q 328.1 95.6, 327.7 96.3 Q 327.3 97.0, 326.6 97.4 Q 326.0 97.7, 325.1 97.7 Q 323.5 97.7, 322.7 96.7 Q 321.9 95.6, 321.9 93.4 Q 321.9 91.1, 322.9 89.9 Q 323.9 88.6, 325.8 88.6 Q 326.3 88.6, 326.8 88.7 Q 327.3 88.9, 327.7 89.1 L 327.2 90.0 Q 326.6 89.6, 325.8 89.6 Q 324.5 89.6, 323.9 90.4 Q 323.3 91.3, 323.2 92.9 Q 323.6 92.5, 324.2 92.3 Q 324.8 92.1, 325.4 92.1 M 325.1 96.7 Q 325.6 96.7, 326.0 96.5 Q 326.4 96.2, 326.6 95.8 Q 326.8 95.3, 326.8 94.8 Q 326.8 94.0, 326.4 93.5 Q 326.0 93.1, 325.2 93.1 Q 324.6 93.1, 324.1 93.3 Q 323.6 93.5, 323.2 93.9 Q 323.2 95.4, 323.7 96.0 Q 324.2 96.7, 325.1 96.7 " fill="#000000"&gt;&lt;/path&gt;
&lt;/svg&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[17]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HasSubstructMatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;patt&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetSubstructMatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;patt&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetSubstructMatches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;patt&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;True
(0, 5, 6)
((0, 5, 6), (4, 5, 6))
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;也可以通过 &lt;code&gt;MolFragmentToSmiles()&lt;/code&gt; 输出匹配子结构的 SMILES。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[18]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFragmentToSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;atomsToUse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetSubstructMatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;patt&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;rootedAtAtom&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;ccO
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="搜索多个分子"&gt;搜索多个分子&lt;a class="anchor-link" href="#搜索多个分子"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;利用 &lt;code&gt;HasSubstructMatch()&lt;/code&gt; 的特性，可以轻松地搜索多个分子并将相应分子加入列表。pattern 子结构也可以使用 SMILES 表示，但 SMILES 的功能较 SMARTS 有限，许多结构无法表示出来。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[19]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;patt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'c1ccccc1'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SDMolSupplier&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"./mols.sdf"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;suppl&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;matches&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;suppl&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HasSubstructMatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;patt&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;matches&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[19]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;1&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="为子结构着色"&gt;为子结构着色&lt;a class="anchor-link" href="#为子结构着色"&gt;&amp;para;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;由于 &lt;code&gt;GetSubstructMatch()&lt;/code&gt; 得到的是原子索引，还需要迭代获取子匹配子结构的化学键索引。首先通过 &lt;code&gt;patt.GetBonds()&lt;/code&gt; 遍历子结构中的化学键，再通过 &lt;code&gt;hit_atom&lt;/code&gt; 将化学键首末端原子映射为完整分子中的索引。因为 &lt;code&gt;hit_atom&lt;/code&gt; 是元组，元组中元素的位置即子结构中的索引，而元素的值就是完整分子中的索引，所以可以像字典一样使用。再通过 &lt;code&gt;GetBondBetweenAtoms(begin, end)&lt;/code&gt; 获取首末原子间的化学键，使用 &lt;code&gt;GetIdx()&lt;/code&gt; 获筛键索引，即可高亮绘制出子结构。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[20]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class="highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rdkit.Chem&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Draw&lt;/span&gt;


&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmiles&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Cc1cccc(C)c1C(C)=NC'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;patt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolFromSmarts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;'[cH0:1][c:2]([cH0])!@[CX3!r:3]=[NX2!r:4]'&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;hit_atom&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetSubstructMatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;patt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;hit_bond&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;bond&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;patt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBonds&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;begin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hit_atom&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;bond&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBeginAtomIdx&lt;/span&gt;&lt;span class="p"&gt;()]&lt;/span&gt;
    &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hit_atom&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;bond&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetEndAtomIdx&lt;/span&gt;&lt;span class="p"&gt;()]&lt;/span&gt;
    &lt;span class="n"&gt;hit_bond&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetBondBetweenAtoms&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetIdx&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;Draw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MolToImage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;450&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;150&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;highlightAtoms&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;hit_atom&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;highlightBonds&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;hit_bond&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[20]:&lt;/div&gt;
&lt;div class="output_png output_subarea output_execute_result"&gt;
&lt;img src="data:image/png;base64,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"/&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;hr/&gt;
&lt;h2 id="Reference_1"&gt;Reference&lt;a class="anchor-link" href="#Reference"&gt;&amp;para;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.rdkit.org/docs/GettingStartedInPython.html"&gt;Getting Started with the RDKit in Python - RDKit&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/dreadlesss/rdkit_summary/blob/master/modifying_molecules.ipynb"&gt;@dreadlesss/rdkit_summary/modifying_molecules - Github&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/dreadlesss/rdkit_summary/blob/master/substructure_search_and_highlight.ipynb"&gt;@dreadlesss/rdkit_summary/substructure_search_and_highlight - Github&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;
</content><category term="碎碎念"></category><category term="RDKit"></category><category term="Python"></category></entry><entry><title>文献总结｜从头药物设计和生成模型</title><link href="https://leonis.cc/sui-sui-nian/2022-12-25-summary-doi.org/10.1016/j.drudis.2021.05.019.html" rel="alternate"></link><published>2022-12-25T00:00:00+08:00</published><updated>2022-12-25T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2022-12-25:/sui-sui-nian/2022-12-25-summary-doi.org/10.1016/j.drudis.2021.05.019.html</id><summary type="html">&lt;p&gt;本文介绍于 2021 年发表在 Drug Discovery Today 上的一篇综述，文章原标题为 De novo molecular design and generative models，文章综述了分子生成模型在药物分子设计中的应用，特别介绍了用于从头药物设计的不同分子生成方法以及未来的前景。&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;i class="fa fa-external-link"&gt;&lt;/i&gt; &lt;a href="https://doi.org/10.1016/j.drudis.2021.05.019" rel="noopener" target="_blank"&gt;doi.org/10.1016/j.drudis.2021.05.019&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本文介绍于 2021 年发表在 &lt;em&gt;Drug Discovery Today&lt;/em&gt; 上的一篇综述，文章原标题为 De novo molecular design and generative models，文章综述了分子生成模型在药物分子设计中的应用，特别介绍了用于从头药物设计的不同分子生成方法以及未来的前景。&lt;/p&gt;
&lt;h2 id="yin-yan"&gt;引言&lt;/h2&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8417?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8417?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;传统的虚拟筛选方法是对已经获得到化学分子进行评估，确定具有活性的分子。而分子生成的目标与此不同，分子生成是需要在从头药物设计中生成用于虚拟筛选的化学结构。&lt;/p&gt;
&lt;p&gt;在化学空间中分散着大量的目标分子，分子生成模型需要利用算法通过化学空间，在具有最优目标特征的目标化学空间上生成需要的化学结构。由于在化学空间中具有许多目标化学空间，分子生成模型的一个关键问题就是如何去平衡探索更多化学空间而生成更多新分子和利用已有的局部最优化学空间。&lt;/p&gt;
&lt;h2 id="ping-gu-zhi-biao"&gt;评估指标&lt;/h2&gt;
&lt;p&gt;分子生成模型常常使用优化分子的特定性质作为生成任务的目标，例如优化分子的类药性（QED）和脂水分配系数等，但这样的指标不能用于全面评估分子生成的结果。针对于分子生成任务，目前有两种标准的评估指标：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Molecular Sets（MOSES）评估：用于评估生成分子的分布以及合法性、独特性、分子片段多样性等，可以用于将生成分子的化学空间与已知化学空间进行对比，适用于多种分子生成任务；&lt;/li&gt;
&lt;li&gt;GuacaMol 评估：除了具有针对生成分子分布的评估，还可以用于评估目标导向的分子生成任务。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="fen-zi-miao-shu-yu-sheng-cheng"&gt;分子描述与生成&lt;/h2&gt;
&lt;p&gt;分子生成任务中的分子通常可以以 SMILES 和基于图的表示两种类型方式描述。SMILES 将分子描述为文本序列，虽然有利于使用自然语言处理中的许多方法进行处理，但将分子转化为文本序列时丢失了许多几何信息，而且使用 SMILES 数据训练模型时，生成模型还学习到了 SMILES 语法和语义这一类信息，而没有学习到更为基本的分子结构信息。基于图的分子描述形式在本质上更接近分子的化学结构，但处理这种描述形式的分子需要更大算法且处理方法有限。&lt;/p&gt;
&lt;p&gt;除上述分子描述形式的不同，分子生成的方法还可以细分为基于原子、基于片段和基于反应三种形式。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8418?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8418?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h3 id="ji-yu-yuan-zi"&gt;基于原子&lt;/h3&gt;
&lt;p&gt;基于原子的生成方法逐个原子生成分子，除了 SMILES 语法等约束以外几乎没有额外的分子知识，是一种较为简单的分子生成方法。&lt;/p&gt;
&lt;p&gt;例如在遗传算法中，可以交叉两种分子中的若干个原子生成新分子。或是在 RNN 中，通过模型训练过程中学习到的权重，指定原子后得到后续原子，再将后续原子作为输入，直至生成整个分子。由于这种方法是通过学习隐藏的特征生成分子，随机性很大，常常会使用强化学习的方法使生成分子更有专一性。&lt;/p&gt;
&lt;h3 id="ji-yu-pian-duan"&gt;基于片段&lt;/h3&gt;
&lt;p&gt;使用一定的规则将分子分割为分子片段，基于片段的分子生成将分子视作片段的集合，这种方法在探索化学空间时利用了分子片段的约束，能够更好地保留训练数据中的子结构。&lt;/p&gt;
&lt;p&gt;例如在遗传算法或 RNN 模型中，模型生成分子的原理没有改变，但遗传算法在交叉两种分子时交叉的是属于某片段的若干原子，RNN 模型除了具有基于原子方法中的权重以外，还学习到了通过片段结构组织若干原子的权重，在获取分子特征上更具优势。&lt;/p&gt;
&lt;h3 id="ji-yu-fan-ying"&gt;基于反应&lt;/h3&gt;
&lt;p&gt;基于反应的分子生成是一种基于规则的方法，基于数据库数据或是使用逆合成模型，将分子拆分为化学反应片段，将其作为训练数据。&lt;/p&gt;
&lt;p&gt;在分子生成过程中，模型以不具有目标分子性质但可获得的反应物为原料，通过多步的化学反应最终得到目标分子。这种模型通常使用强化学习的方法，实现目标优化，在分子可合成性的表现很好。但这种模型的一大缺陷在于需要人工制定反应模版，这大大限制了其应用。&lt;/p&gt;
&lt;h2 id="tiao-zhan-yu-qian-jing_1"&gt;挑战与前景&lt;/h2&gt;
&lt;p&gt;药物化学中常用的设计策略是固定分子的特定结构不变，对分子结构进行改造，这有利于研究分子的构效关系，这种设计策略在分子生成任务中可以理解为在局部最优化学空间附近进行探索。&lt;/p&gt;
&lt;p&gt;在分子生成中实现这种分子改造，目前采取的两种思路是基于分子的知识改造分子和生成大量分子后过滤掉具有非目标结构的分子。相比之下，前一种方式更具有效率而且能生成更符合目标的分子，是目前研究的方向。基于图的分子描述形式能够更直接地学习到所需要的分子知识，文本形式的分子描述需要更好地提取出这种分子知识。&lt;/p&gt;
&lt;p&gt;分子生成的结果不能以单一指标衡量，药物分子的设计也不能只考虑单一特征，分子生成通常是多目标优化的任务。但实际中分子生成模型针对于多目标任务的表现并不好，这主要是由于针对这种多目标优化任务与药物成药性还有一定偏差。所以尽管有些模型在数值上表现更好，但无法真正用于药物设计，研究新的评估指标是解决这一问题的重要方向。&lt;/p&gt;
&lt;p&gt;文章还提出了以下几个未来重要研究方向：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;继续改进目前的模型，通过算法上的改进提高生成目标分子的成功率；&lt;/li&gt;
&lt;li&gt;发展专门的生成模型，例如针对于 3D 蛋白结合位点 3D 空间匹配的模型；&lt;/li&gt;
&lt;li&gt;研究可解释性的模型，用于分子生成的深度学习模型仍被视为黑箱，药物化学家需要通过可解释性模型给出的知识指导药物设计。&lt;/li&gt;
&lt;/ol&gt;</content><category term="碎碎念"></category><category term="Literature Summary"></category><category term="CADD"></category><category term="Review"></category></entry><entry><title>CS224n 自然语言处理第一节：简介与词向量</title><link href="https://leonis.cc/sui-sui-nian/2022-12-21-cs224n-lecture1.html" rel="alternate"></link><published>2022-12-21T00:00:00+08:00</published><updated>2022-12-21T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2022-12-21:/sui-sui-nian/2022-12-21-cs224n-lecture1.html</id><summary type="html">&lt;p&gt;CS224n Lecture 1: Introduction and Word Vectors&lt;/p&gt;</summary><content type="html">&lt;h2 id="one-hot-bian-ma"&gt;one-hot 编码&lt;/h2&gt;
&lt;p&gt;在传统 NLP 中，词可以使用 one-hot 向量表示，&lt;strong&gt;one-hot&lt;/strong&gt; 指向量中只有一个 1，其余都是 0。例如词库为向量&lt;/p&gt;
&lt;div class="math"&gt;$$\mathrm{vocab}=[\mathrm{hotel\ conference\ motel}]$$&lt;/div&gt;
&lt;p&gt;那么单词的 one-hot 向量就是&lt;/p&gt;
&lt;div class="math"&gt;$$\mathrm{motel}=[0\ 0\ 1]$$&lt;/div&gt;
&lt;div class="math"&gt;$$\mathrm{hotel}=[1\ 0\ 0]$$&lt;/div&gt;
&lt;p&gt;这样得到不同词向量是&lt;strong&gt;正交&lt;/strong&gt;的，无法判断词之间的相似性。&lt;/p&gt;
&lt;h2 id="word2vec"&gt;word2vec&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;分布式语义&lt;/strong&gt;（distributional semantics）：一个词的语义由最常出现的邻近词决定。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;分布式语义是 NLP 中的一个基本概念，基于这个假设，我们可以通过上下文来表示指定的词，得到的词向量又称为&lt;strong&gt;词嵌入&lt;/strong&gt;（word embeddings）。&lt;/p&gt;
&lt;p&gt;word2vec 是基于分布式语义得到词向量的一种重要方法，其基本设想是&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;拥有一个较大的语料数据库&lt;/li&gt;
&lt;li&gt;文本中的每一个词都能通过向量表示，语义相似的词具有相似的向量&lt;/li&gt;
&lt;li&gt;在文本中的位置 &lt;span class="math"&gt;\(t\)&lt;/span&gt; 上，有中心词 &lt;span class="math"&gt;\(c\)&lt;/span&gt; 和上下文词 &lt;span class="math"&gt;\(o\)&lt;/span&gt;（为了简化计算，&lt;span class="math"&gt;\(c\)&lt;/span&gt; 对应的 &lt;span class="math"&gt;\(o\)&lt;/span&gt; 通常由窗口 &lt;span class="math"&gt;\(m\)&lt;/span&gt; 决定）&lt;/li&gt;
&lt;li&gt;使用 &lt;span class="math"&gt;\(c\)&lt;/span&gt; 和 &lt;span class="math"&gt;\(o\)&lt;/span&gt; 的词向量相似性计算给定 &lt;span class="math"&gt;\(c\)&lt;/span&gt; 时 &lt;span class="math"&gt;\(o\)&lt;/span&gt; 的概率&lt;/li&gt;
&lt;li&gt;不断调整词向量直至&lt;dot&gt;最大化&lt;/dot&gt;该概率（最大似然法）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8285?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8285?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;在文本中的位置 &lt;span class="math"&gt;\(t=1,\cdots,T\)&lt;/span&gt; 上，对中心词 &lt;span class="math"&gt;\(w_j\)&lt;/span&gt; 固定窗口大小为 &lt;span class="math"&gt;\(m\)&lt;/span&gt;，那么文本数据的似然为&lt;/p&gt;
&lt;div class="math"&gt;$$L(\theta)=\prod^T_{t=1}\prod_{\substack{-m\leq j\leq m\\j\neq0}}P(w_{t+j}|w_t;\theta)$$&lt;/div&gt;
&lt;p&gt;最大似然的目标就是 &lt;span class="math"&gt;\(\max L(\theta)\)&lt;/span&gt;，在这里取负对数将其转化为&lt;/p&gt;
&lt;div class="math"&gt;$$J(\theta)=-\frac{1}{T}\log L(\theta)=-\frac{1}{T}\prod^T_{t=1}\prod_{\substack{-m\leq j\leq m\\j\neq0}}P(w_{t+j}|w_t;\theta)$$&lt;/div&gt;
&lt;p&gt;优化目标就变为 &lt;span class="math"&gt;\(\min J(\theta)\)&lt;/span&gt;，更加符合最优化的习惯，这里的 &lt;span class="math"&gt;\(J(\theta)\)&lt;/span&gt; 就是 word2vec 的损失函数。&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(J(\theta)\)&lt;/span&gt; 中的条件概率一项如何计算呢？这里为了便于计算，当 &lt;span class="math"&gt;\(w\)&lt;/span&gt; 为中心词时用 &lt;span class="math"&gt;\(v_w\)&lt;/span&gt; 表示，当 &lt;span class="math"&gt;\(w\)&lt;/span&gt; 为上下文词时用 &lt;span class="math"&gt;\(u_w\)&lt;/span&gt; 表示。&lt;/p&gt;
&lt;p&gt;{note begin}每一个词 &lt;span class="math"&gt;\(w\)&lt;/span&gt; 都会具有两个不同的向量 &lt;span class="math"&gt;\(v_w\)&lt;/span&gt; 和 &lt;span class="math"&gt;\(u_w\)&lt;/span&gt;，在计算结束后，这两个向量会非常相似，通常取这两个向量的平均得到词向量。{note end}&lt;/p&gt;
&lt;p&gt;那么对于任意指定的中心词 &lt;span class="math"&gt;\(c\)&lt;/span&gt; 和相应的上下文词 &lt;span class="math"&gt;\(o\)&lt;/span&gt;，就有条件概率&lt;/p&gt;
&lt;div class="math"&gt;$$P(o|c)=\frac{\exp(u_o^Tv_c)}{\sum_{w\in V}\exp(u_w^Tv_c)}$$&lt;/div&gt;
&lt;p&gt;该条件概率同时也表示当两个词的向量点积越大，两个词临近的概率 &lt;span class="math"&gt;\(P(o|c)\)&lt;/span&gt; 越大，这正是 word2vec 的基本思想。该式可以与 softmax 函数类比：&lt;/p&gt;
&lt;div class="math"&gt;$$\mathrm{softmax}(x_i)=\frac{\exp(x_i)}{\sum_{j=1}^n\exp(x_j)}=p_i$$&lt;/div&gt;
&lt;p&gt;其本质就是将中心词 &lt;span class="math"&gt;\(c\)&lt;/span&gt; 和上下文词 &lt;span class="math"&gt;\(o\)&lt;/span&gt; 的相似性 &lt;span class="math"&gt;\(u_o^Tv_c\)&lt;/span&gt; 转化为&lt;dot&gt;概率&lt;/dot&gt;形式（非负且和为 1）。&lt;/p&gt;
&lt;p&gt;在得到 &lt;span class="math"&gt;\(P(o|c)\)&lt;/span&gt; 后，就可以采用梯度下降的方法实现 &lt;span class="math"&gt;\(\min J(\theta)\)&lt;/span&gt;，所以需要计算每个目标词 &lt;span class="math"&gt;\(v_c\)&lt;/span&gt; 的 &lt;span class="math"&gt;\(\frac{\partial}{\partial v_c}\log P(o|c)\)&lt;/span&gt;，推导过程如下：&lt;/p&gt;
&lt;div class="math"&gt;$$\begin{align}
    \frac{\partial}{\partial v_c}\log P(o|c)&amp;amp;=\frac{\partial}{\partial v_c}\log\frac{\exp(u_o^Tv_c)}{\sum_{w\in V}\exp(u_w^Tv_c)}\\
    &amp;amp;=\frac{\partial}{\partial v_c}\left[\log \exp(u_o^Tv_c)-\log\sum_{w\in V}\exp(u_w^Tv_c)\right]\\
    &amp;amp;=\frac{\partial}{\partial v_c}u_o^Tv_c-\frac{\partial}{\partial v_c}\log\sum_{w\in V}\exp(u_w^Tv_c)
\end{align}$$&lt;/div&gt;
&lt;p&gt;注意 &lt;span class="math"&gt;\(v_c\)&lt;/span&gt; 为向量，由向量求导法则 &lt;span class="math"&gt;\(\frac{\mathrm{d}Ax}{\mathrm{d}x}=A^T\)&lt;/span&gt;，可以得到&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{align}
    \frac{\partial}{\partial v_c}\log P(o|c)&amp;amp;=u_o-\frac{\partial}{\partial v_c}\log\sum_{w\in V}\exp(u_w^Tv_c)\\
    &amp;amp;=u_o-\frac{1}{\sum_{w\in V}\exp(u_w^Tv_c)}\left[\frac{\partial}{\partial v_c}\sum_{x\in V}\exp(u_x^Tv_c)\right]\\
    &amp;amp;=u_o-\frac{1}{\sum_{w\in V}\exp(u_w^Tv_c)}\sum_{x\in V}\frac{\partial}{\partial v_c}\exp(u_x^Tv_c)\\
    &amp;amp;=u_o-\frac{1}{\sum_{w\in V}\exp(u_w^Tv_c)}\sum_{x\in V}\exp(u_x^Tv_c)u_x\\
    &amp;amp;=u_o-\sum_{x\in V}\frac{\exp(u_x^Tv_c)}{\sum_{w\in V}\exp(u_w^Tv_c)}u_x\\
    &amp;amp;=u_o-\sum_{x\in V}P(x|c)u_x
\end{align}
$$&lt;/div&gt;
&lt;p&gt;实际上 &lt;span class="math"&gt;\(\sum_{x\in V}P(x|c)u_x\)&lt;/span&gt; 就是 &lt;span class="math"&gt;\(u_x\)&lt;/span&gt; 的期望，使用 softmax 的好处就在于能将最优化问题转化为最小化形如「观察值 &amp;ndash; 预测值」的误差。&lt;/p&gt;
&lt;hr/&gt;
&lt;h2 id="references"&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://web.stanford.edu/class/archive/cs/cs224n/cs224n.1214/" rel="noopener" target="_blank"&gt;CS224n: Natural Language Processing with Deep Learning&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="碎碎念"></category><category term="NLP"></category><category term="CS224n"></category></entry><entry><title>文献总结｜DRlinker：使用深度强化学习优化连接片段设计</title><link href="https://leonis.cc/sui-sui-nian/2022-12-18-summary-doi.org/10.1021/acs.jcim.2c00982.html" rel="alternate"></link><published>2022-12-18T00:00:00+08:00</published><updated>2022-12-18T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2022-12-18:/sui-sui-nian/2022-12-18-summary-doi.org/10.1021/acs.jcim.2c00982.html</id><summary type="html">&lt;p&gt;本文介绍于 2022 年发表在 Journal of Chemical Information and Modeling 上的一篇文章，文章原标题为 DRlinker: Deep Reinforcement Learning for Optimization in Fragment Linking Design，文章是对 SyntaLinker 的改进，在原有结构的基础上引入了强化学习策略，使模型在完成分子连接的任务以外，还能使模型根据设定的任务生成满足约束的新分子。&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;i class="fa fa-external-link"&gt;&lt;/i&gt; &lt;a href="https://doi.org/10.1021/acs.jcim.2c00982" rel="noopener" target="_blank"&gt;doi.org/10.1021/acs.jcim.2c00982&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本文介绍于 2022 年发表在 &lt;em&gt;Journal of Chemical Information and Modeling&lt;/em&gt; 上的一篇文章，文章原标题为 DRlinker: Deep Reinforcement Learning for Optimization in Fragment Linking Design，文章是对 SyntaLinker 的改进，在原有结构的基础上引入了强化学习策略，使模型在完成分子连接的任务以外，还能使模型根据设定的任务生成满足约束的新分子。&lt;/p&gt;
&lt;h2 id="fang-fa"&gt;方法&lt;/h2&gt;
&lt;h3 id="mo-xing"&gt;模型&lt;/h3&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8280?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8280?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;文章从 SyntaLinker 分子连接模型受到启发，同样使用了强大的 Transformer 模型，但与之不同的是 DRlinker 还引入了强化学习的策略。使用 ChEMBL 数据训练 Transformer，得到先验模型，先验模型能够根据输入的分子片段给出新分子。接着引入基于策略的强化学习，通过打分函数等优化方法训练先验模型，得到代理模型。&lt;/p&gt;
&lt;p&gt;也就是说，代理模型与先验模型具有相同的结构，先验模型首先初始化了代理模型，接着代理模型的强化学习策略使其输出满足打分函数的约束，所以最终的模型可以根据输入的分子片段给出满足指定约束的新分子。&lt;/p&gt;
&lt;h3 id="shu-ju"&gt;数据&lt;/h3&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8281?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8281?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;由于 DRlinker 是对 SyntaLinker 的改进，所使用的数据也与 SyntaLinker 一致，数据都来源于 ChEMBL 数据库，处据处理方法也一致。从 ChEMBL 数据库得到的分子数据首先使用 Lipinski 五规则、假阳性化合物和 SA 分数等标准过滤掉其中不具有类药性的分子，接着使用 MMP 算法将分子切分为片段。&lt;/p&gt;
&lt;p&gt;训练方法也与 SyntaLinker 一致，将切分的分子片段组合为 「片段 1，连接部分，片段 2，分子」的四部分数据，令 Transformer 模型完成将「片段 1，片段 2」转为分「分子」的 seq2seq 任务。&lt;/p&gt;
&lt;h3 id="da-fen-han-shu"&gt;打分函数&lt;/h3&gt;
&lt;p&gt;DRlinker 输出满足约束的新分子并完成不同任务是通过指定不同的打分函数决定的，打分函数决定了模型中强化学习过程中训练的方向，指产生的分子偏向于目标分子。&lt;/p&gt;
&lt;p&gt;为了评估 DRlinker 完成不同任务的表现，文章中使用了以下几个打分函数：&lt;/p&gt;
&lt;h4&gt;连接部分长度&lt;/h4&gt;
&lt;div class="math"&gt;$$\begin{equation}
    \mathcal{R}(m)_\mathrm{LinkerLen}=
    \begin{cases}
        \max\left(0,1-\frac{1}{a}|\mathrm{LinkerLen}(m)-\mathrm{Target}|\right)&amp;amp;,\ \mathrm{if\ valid}\\
        0&amp;amp;,\ \mathrm{if\ invalid}
    \end{cases}
\end{equation}$$&lt;/div&gt;
&lt;p&gt;其中 &lt;span class="math"&gt;\(\alpha\)&lt;/span&gt; 是参数，&lt;span class="math"&gt;\(m\)&lt;/span&gt; 是生成的分子。&lt;/p&gt;
&lt;h4&gt;log P&lt;/h4&gt;
&lt;div class="math"&gt;$$\begin{equation}
    \mathcal{R}(m)_{\log P}=
    \begin{cases}
        \max\left(0,1-\frac{1}{a}|\log P(m)-\mathrm{Target}|\right)&amp;amp;,\ \mathrm{if\ valid}\\
        0&amp;amp;,\ \mathrm{if\ invalid}
    \end{cases}
\end{equation}$$&lt;/div&gt;
&lt;h4&gt;生物活性&lt;/h4&gt;
&lt;div class="math"&gt;$$\begin{equation}
    \mathcal{R}(m)_\mathrm{activity}=
    \begin{cases}
        P_\mathrm{active}(m)&amp;amp;,\ \mathrm{if\ valid}\\
        0&amp;amp;,\ \mathrm{if\ invalid}
    \end{cases}
\end{equation}$$&lt;/div&gt;
&lt;p&gt;&lt;span class="math"&gt;\(P_\mathrm{active}\)&lt;/span&gt; 是 JAK3 活性的活性预测模型，通过随机森林预测分子活性。&lt;/p&gt;
&lt;h4&gt;多目标约束&lt;/h4&gt;
&lt;div class="math"&gt;$$\begin{equation}
    \mathcal{R}(m)_\mathrm{QED\&amp;amp;SA}=
    \begin{cases}
        \max(0,\mathrm{QED}(m)-0.1\times\mathrm{SA}(m))&amp;amp;,\ \mathrm{if\ valid}\\
        0&amp;amp;,\ \mathrm{if\ invalid}
    \end{cases}
\end{equation}$$&lt;/div&gt;
&lt;p&gt;多目标约束用于评估模型针对多个目标进行优化时的表现。&lt;/p&gt;
&lt;h2 id="jie-guo_1"&gt;结果&lt;/h2&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8282?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8282?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h4&gt;连接部分长度&lt;/h4&gt;
&lt;p&gt;指定模型生成连接部分长度为 5 和 10 的新分子，结果为 subplot a，可以看出与 SyntaLinker 和 DeLinker 相比，DRLinker 生成的分子分布更加集中在 5 和 10，DRLinker 能够更加准确地生成目标分子。这是由于 SyntaLinker 不具有强化学习策略，是通过在训练数据连接部分长度为 5 的分子中添加例如 &lt;code&gt;L_5&lt;/code&gt; 的前缀标记，利用 Transformer 的自注意力机制分配权重，使生成分子连接部分的长度与 &lt;code&gt;L_n&lt;/code&gt; 的前缀标记相关。使用这种方法虽然能使分子大致符合目标，但显然是不能使分子准确满足目标。&lt;/p&gt;
&lt;h4&gt;log P&lt;/h4&gt;
&lt;p&gt;指定模型分别生成 &lt;span class="math"&gt;\(\log P\)&lt;/span&gt; 为 1、2 和 3 的分子，分子分布为 subplot b，可以从先验模型生成分子到代理模型生成分子的分布中看出，经过强化学习，模型生成分子能够满足约束，集中在任务指定的 &lt;span class="math"&gt;\(\log P\)&lt;/span&gt; 附近。subplot c 列举了模型生成的分子，也可以看出，随着目标 &lt;span class="math"&gt;\(\log P\)&lt;/span&gt; 增大，生成分子的连接部分具有更多的芳香基团等疏水基团。&lt;/p&gt;
&lt;h4&gt;生物活性与多目标约束&lt;/h4&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8284?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8284?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;使用活性预测模型的预测活性作为打分函数，可以指定生成活性较高的新分子，使用 RDKit 的评估指标分析生成分子，可以看出在生成的分子在满足合法性、新颖性等要求的同时，相对于 SyntaLinker 活性还有所提升（Impv）。&lt;/p&gt;
&lt;p&gt;此外还可以使用优化 QED 和 SA 两种目标的打分函数，生成分子的 QED 与 SA 都有相应的提高，达到了使生成分子满足多目标约束的目的。&lt;/p&gt;
&lt;p&gt;以上两种应用都不是通过指定要求的目标生成分子，而是指定了优化目标，可以理解为一种优化分子结构的方式，这是 SyntaLinker 所不具有的功能。&lt;/p&gt;
&lt;h2 id="zong-jie"&gt;总结&lt;/h2&gt;
&lt;p&gt;DRlinker 在 SyntaLinker 的基础上引入了强化学习策略，使模型能够根据脂定的打分函数生成满足目标约束的分子，从实验结果来看，模型不仅能够使生成的分子满足单一目标，还能满足多目标的约束。但强化学习的策略也存在一定问题，例如必须要根据目标构造打分函数，打分函数不同也会造成结果不同，打分函数没有严格的标准而经验成分较多等等。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-mml-chtml.js';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="碎碎念"></category><category term="Literature Summary"></category><category term="CADD"></category><category term="Transformer"></category><category term="RL"></category></entry><entry><title>机器翻译框架 OpenNMT 入门：快速上手</title><link href="https://leonis.cc/sui-sui-nian/2022-12-16-opennmt-tutorial-quickstart.html" rel="alternate"></link><published>2022-12-16T00:00:00+08:00</published><updated>2022-12-16T00:00:00+08:00</updated><author><name>Leo</name></author><id>tag:leonis.cc,2022-12-16:/sui-sui-nian/2022-12-16-opennmt-tutorial-quickstart.html</id><summary type="html">&lt;p&gt;拆解项目代码的时候发现使用到了 onmt 这个古怪东西，查阅资料后才知道这是一个自然机器翻译的框架，是自然语言处理中常用的工具。但是相关资料又太少，于是不得不照着文档一点一点啃，最后留下了这篇笔记。&lt;/p&gt;</summary><content type="html">&lt;p&gt;拆解项目代码的时候发现使用到了 &lt;code&gt;onmt&lt;/code&gt; 这个古怪东西，查阅资料后才知道这是一个自然机器翻译的框架，是自然语言处理中常用的工具。但是相关资料又太少，于是不得不照着文档一点一点啃，最后留下了这篇笔记。&lt;/p&gt;
&lt;p&gt;OpenNMT 官方描述该框架为 an open source neural machine translation system，点进 &lt;a href="https://opennmt.net/" rel="noopener" target="_blank"&gt;OpenNMT 的官网&lt;/a&gt;可以看到更多资料，因此也不需要我多描述。总结一下就是，OpenNMT 是搭建自然语言处理模型的开源框架，其中自然包括常见的 RNN 和 Transformer 等模型。如果在自然语言处理方面有需要，OpenNMT 绝对是一个轻量有效的框架。&lt;/p&gt;
&lt;p&gt;OpenNMT 的中文学习资料较少，于是我只能参考&lt;a href="https://opennmt.net/OpenNMT-py/main.html" rel="noopener" target="_blank"&gt;官方文档&lt;/a&gt;学习。在这篇笔记中，我会把文档中的模型都试验一遍（希望别🕊️），记录下整个过程或许能帮助到需要的人。&lt;/p&gt;
&lt;h2 id="zhun-bei-gong-zuo"&gt;准备工作&lt;/h2&gt;
&lt;p&gt;首先介绍一下我的运行环境，我的设备搭载一块 &lt;code&gt;GTX 1080&lt;/code&gt; GPU，系统为 &lt;code&gt;Ubuntu 20.04&lt;/code&gt;，需要提前在设备上安装好 CUDA，我使用 Anaconda 配置 Python 环境。&lt;/p&gt;
&lt;p&gt;{note begin}OpenNMT 不支持过旧的 GPU，之前在 &lt;code&gt;GTX 970&lt;/code&gt; 的设备上就无法训练模型，这个问题可能除了换设备无解😭{note end}&lt;/p&gt;
&lt;h2 id="kuai-su-shang-shou"&gt;快速上手&lt;/h2&gt;
&lt;h3 id="an-zhuang-opennmt"&gt;安装 OpenNMT&lt;/h3&gt;
&lt;p&gt;OpenNMT 有 PyTorch 与 TensorFlow 两个版本，PyTorch 在环境搭建上方便很多，所以我选择 PyTorch 版本。先创建虚拟环境，再直接通过 &lt;code&gt;pip&lt;/code&gt; 安装 OpenNMT-py，Python 版本为 &lt;code&gt;3.9&lt;/code&gt;，OpenNMT-py 为 &lt;code&gt;3.0.2&lt;/code&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-sh"&gt;# 创建虚拟环境
conda create -n nlp python==3.9
# 激活虚拟环境
conda activate nlp
# 安装 OpenNMT
pip install OpenNMT-py==3.0.2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;{note begin}国内直连 PyPI 的速度可能很慢，可以使用清华源，命令为 &lt;code&gt;pip install -i https://pypi.tuna.tsinghua.edu.cn/simple {some-package}&lt;/code&gt;，将其中的 &lt;code&gt;{some-package}&lt;/code&gt; 替换为需要安装的包名称。{note end}&lt;/p&gt;
&lt;p&gt;直接安装 &lt;code&gt;OpenNMT-py&lt;/code&gt; 很有可能会有问题，主要原因是 Pytorch 与 CUDA 版本不匹配。可以用 &lt;code&gt;nvcc -V&lt;/code&gt; 查询 CUDA 版本，再在 &lt;a href="https://pytorch.org/get-started/previous-versions/" rel="noopener" target="_blank"&gt;Pytorch 官网&lt;/a&gt;找到相应的版本。例如我的 CUDA 版本为 &lt;code&gt;11.4&lt;/code&gt;，那么就需要重新安装以下版本的包解决依赖问题：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-sh"&gt;pip install torch==1.12.1+cu113 torchvision==0.13.1+cu113 torchaudio==0.12.1 --extra-index-url https://download.pytorch.org/whl/cu113
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id="zhun-bei-shu-ju"&gt;准备数据&lt;/h3&gt;
&lt;p&gt;快速上手一节搭建的是一个简单的双语翻译模型，因此需要准备两种语言的数据，分别为源语言&lt;code&gt;src&lt;/code&gt; 和目标语言 &lt;code&gt;tgt&lt;/code&gt;，数据文件中每行包含一句话，以空格分隔不同的词。再考虑到训练集和验证集，那么一共需要 4 种数据文件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;src-train.txt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tgt-train.txt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;src-val.txt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tgt-val.txt&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;{note begin}可以想象到，如果处理的是英语、法语等以空格分隔单词的语言，只需要将文本数据处理为每行一句话的格式即可。但对于汉语、日语等不以特殊标记分隔词语的语言，数据需要经过额外的分词步骤后才可以使用。{note end}&lt;/p&gt;
&lt;p&gt;官方提供了英语-德语的数据文件，可以直接下载：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-sh"&gt;wget https://s3.amazonaws.com/opennmt-trainingdata/toy-ende.tar.gz
tar xf toy-ende.tar.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;也可以到 &lt;a href="https://github.com/OpenNMT/OpenNMT-py/tree/master/data" rel="noopener" target="_blank"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt; OpenNMT-py/data/&lt;/a&gt; 在线查看数据长什么样子。&lt;/p&gt;
&lt;p&gt;接着通过 &lt;code&gt;vim toy_en_de.yaml&lt;/code&gt; 在目录下创建 &lt;code&gt;.yaml&lt;/code&gt; 配置文件，内容为&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-yaml"&gt;# toy_en_de.yaml

## Where the samples will be written
save_data: toy-ende/run/example
## Where the vocab(s) will be written
src_vocab: toy-ende/run/example.vocab.src
tgt_vocab: toy-ende/run/example.vocab.tgt
# Prevent overwriting existing files in the folder
overwrite: False

# Corpus opts:
data:
    corpus_1:
        path_src: toy-ende/src-train.txt
        path_tgt: toy-ende/tgt-train.txt
    valid:
        path_src: toy-ende/src-val.txt
        path_tgt: toy-ende/tgt-val.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;创建文件后的文件结构为&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-sh"&gt;.
&amp;boxvr;&amp;boxh;&amp;boxh; toy-ende
&amp;boxv;   &amp;boxvr;&amp;boxh;&amp;boxh; src-test.txt
&amp;boxv;   &amp;boxvr;&amp;boxh;&amp;boxh; src-train.txt
&amp;boxv;   &amp;boxvr;&amp;boxh;&amp;boxh; src-val.txt
&amp;boxv;   &amp;boxvr;&amp;boxh;&amp;boxh; tgt-test.txt
&amp;boxv;   &amp;boxvr;&amp;boxh;&amp;boxh; tgt-train.txt
&amp;boxv;   &amp;boxur;&amp;boxh;&amp;boxh; tgt-val.txt
&amp;boxur;&amp;boxh;&amp;boxh; toy_en_de.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;设置完成后，运行以下命令开始构建词库：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-sh"&gt;onmt_build_vocab -config toy_en_de.yaml -n_sample 10000
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其中 &lt;code&gt;n_sample&lt;/code&gt; 设定了从语料中获取多少行的数据用于构建词库。&lt;/p&gt;
&lt;p&gt;{note begin}若使用虚拟环境，需要进入虚拟环境后才能运行上述命令，若使用 Anaconda，也需要先激活环境。Pytorch 与 CUDA 版本不匹配会导致 &lt;code&gt;undefined symbol: cublasLtGetStatusString, version libcublasLt.so&lt;/code&gt; 错误。{note end}&lt;/p&gt;
&lt;h3 id="xun-lian-mo-xing"&gt;训练模型&lt;/h3&gt;
&lt;p&gt;训练模型也十分简单，在 &lt;code&gt;.yaml&lt;/code&gt; 文件中追加以下内容：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-yaml"&gt;# Vocabulary files that were just created
src_vocab: toy-ende/run/example.vocab.src
tgt_vocab: toy-ende/run/example.vocab.tgt

# Train on a single GPU
world_size: 1
gpu_ranks: [0]

# Where to save the checkpoints
save_model: toy-ende/run/model
save_checkpoint_steps: 500
train_steps: 1000
valid_steps: 500
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;使用 &lt;code&gt;onmt_train -config toy_en_de.yaml&lt;/code&gt; 开始训练，该配置会生成默认的 2 层具有 500 个隐藏单元的 LSTM 模型。&lt;/p&gt;
&lt;h3 id="mo-xing-yu-ce"&gt;模型预测&lt;/h3&gt;
&lt;p&gt;使用类似的命令进行模型预测，模型预测能够将文本文件中的内容翻译并保存到输出文件中：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;onmt_translate -model toy-ende/run/model_step_1000.pt -src toy-ende/src-test.txt -output toy-ende/pred_1000.txt -gpu 0 -verbose
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;上面的命令使用了训练得到的模型 &lt;code&gt;toy-ende/run/model_step_1000.pt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;预测 &lt;code&gt;toy-ende/src-test.txt&lt;/code&gt; 测试集数据&lt;/li&gt;
&lt;li&gt;将结果输出到 &lt;code&gt;toy-ende/pred_1000.txt&lt;/code&gt;，&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-gpu&lt;/code&gt; 指定了使用的 GPU&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-verbose&lt;/code&gt; 指定在终端中输出每个步骤的详细结果&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;使用 &lt;code&gt;head -n 2 toy-ende/src-test.txt&lt;/code&gt; 和 &lt;code&gt;head -n 2 toy-ende/pred_1000.txt&lt;/code&gt; 查看一下预测结果：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-txt"&gt;# test
Orlando Bloom and Miranda Kerr still love each other
Actors Orlando Bloom and Model Miranda Kerr want to go their separate ways .

# pred
Die &amp;lt;unk&amp;gt; der &amp;lt;unk&amp;gt; der &amp;lt;unk&amp;gt; , die die &amp;lt;unk&amp;gt; der &amp;lt;unk&amp;gt; &amp;hellip;&amp;hellip;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;由于训练时间很短，数据集很小，预测结果不会好，再加上不认识德语，也无法判断结果的优劣，所以接下来尝试在更大的中文语料上进行翻译任务。&lt;/p&gt;
&lt;h2 id="wen-yan-fan-yi_1"&gt;文言翻译&lt;/h2&gt;
&lt;p&gt;B 站上有一个展示 OpenNMT 的&lt;a href="https://www.bilibili.com/video/BV1NL4y1t73c/?spm_id_from=333.337.search-card.all.click&amp;amp;vd_source=a5a1b5dd5c760997f9e16b7806d64651" rel="noopener" target="_blank"&gt;视频&lt;/a&gt;，实在很不错。视频中展示的翻译任务是将白话译为文言，不仅直观而且十分有趣，我觉得特别适合用来入门，作者的代码也公开在 &lt;a href="https://github.com/qhduan/notebook_gist/blob/master/%E7%BF%BB%E8%AF%91%E5%8F%A4%E6%96%87.ipynb" rel="noopener" target="_blank"&gt;GitHub&lt;/a&gt; 上，可以和本文相互参照，本文中的代码也可以在 &lt;a href="https://github.com/Tseing/OpenNMT-wenyan" rel="noopener" target="_blank"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt; Tseing/OpenNMT-wenyan &lt;/a&gt; 找到。&lt;/p&gt;
&lt;h3 id="zhun-bei-shu-ju_1"&gt;准备数据&lt;/h3&gt;
&lt;p&gt;白话文与文言文的平行语料来自于 &lt;a href="https://github.com/NiuTrans/Classical-Modern" rel="noopener" target="_blank"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt; NiuTrans/Classical-Modern&lt;/a&gt;，包含了大量内容：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-txt"&gt;# Classical-Modern/source/
元史  北齐书  南齐书  后汉书  太平广记  宋史    新五代史  旧五代史  明史  梁书      汉书              辽史  陈书  魏书
北史  南史    史记    周书    宋书      徐霞客  新唐书    旧唐书    晋书  水经注全  短篇章和资治通鉴  金史  隋书
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;下载数据后可以先用 &lt;code&gt;head Classical-Modern/source/史记&lt;/code&gt; 与 &lt;code&gt;head Classical-Modern/target/史记翻译&lt;/code&gt; 查看一下语料：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-txt"&gt;# 史记
後为太常，坐法当死，赎免为庶人。
上曰：剑，人之所施易，独至今乎？
然终不自明也。
然亦无所毁。

# 史记翻译
因为触犯法律判处死刑，纳米粟入官赎罪后成了平民。
景帝说：剑是人们所喜爱之物，往往用来送人或交换他物，难道你能保存到现在吗？
说过后他终究不再做其他辩解。
然后也没有讲别人的什么坏话。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;原始语料是将文言翻译为白话，因此 &lt;code&gt;source&lt;/code&gt; 中存储了原文，&lt;code&gt;target&lt;/code&gt; 中存储了翻译，每行一句话，两个文件一一对应。我们需要预处理数据，将所有文本都作为数据集。&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-py"&gt;import os

source_root = 'Classical-Modern/source'
target_root = 'Classical-Modern/target'

for f in os.listdir(source_root):
    print("processing " + f)
    source_file = os.path.join(source_root, f)
    target_file = os.path.join(target_root, f + '翻译')

    # 统计各文本中行数
    with open(source_file, "r", encoding="utf-8") as source_f:
        source_len = sum(1 for _ in source_f)
    with open(target_file, "r", encoding="utf-8") as target_f:
        target_len = sum(1 for _ in target_f)

    # 对比平行语料行数，确保一致
    assert source_len == target_len
    try:
        with open('dataset/source_raw.txt', "a+", encoding="utf-8") as source_f:
            source_f.write(open(source_file, "r", encoding="utf-8").read())
        with open('dataset/target_raw.txt', "a+", encoding="utf-8") as target_f:
            target_f.write(open(target_file, "r", encoding="utf-8").read())
    except FileNotFoundError:
        os.mkdir('dataset')
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;检查一下处理的结果：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-txt"&gt;# dataset/source_raw.txt
密计不行。
使者利金，遂相许。
遣说诸小贼，所至辄降，让始敬焉，召与计事。
宇文温每谓密曰：不杀元真，公难未已。

# dataset/target_raw.txt
李密的意见没有被采纳。
押送的人贪图金钱，便满口答应。
派人游说小股义军，被劝说的人都归顺了翟让，翟让开始看重了他，叫他同自己一起讨论重大问题。
宇文温常对李密说：不杀邴元真，您的祸害就不会排除。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;接下来要对文本分词，对于文言文来说，单字词的占比非常高，将每个单字作为一个词就是一种比较方便的分词方法，所以在每个字符后插入空格即可。而白话文中有大量的双字词，甚至三字词、四字词，必须使用专门的分词引擎，这里我使用了 &lt;a href="http://thulac.thunlp.org/" rel="noopener" target="_blank"&gt;THULAC&lt;/a&gt;，直接通过 &lt;code&gt;pip install thualac&lt;/code&gt; 就能安装。&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-py"&gt;import thulac

# 对文言文本分词
with open('dataset/source_raw.txt', 'r', encoding='utf-8') as f:
    # 目标是 白话-&amp;gt;文言，因此将文言作为目标 target.txt
    with open('dataset/target.txt', 'w+', encoding='utf-8') as s:
        print("separating wenyan text...")
        while True:
            line = f.readline()
            if line:
                line_seq = " ".join([char for char in line])
                s.write(line_seq)
            else:
                break

# 对白话文本分词，将白话作为源语言 source.txt
print("separating modern text...")
sep_model = thulac.thulac(seg_only=True)
sep_model.cut_f('dataset/target_raw.txt', 'dataset/source.txt')
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;使用 &lt;code&gt;thulac&lt;/code&gt; 首先要加载分词模型，&lt;code&gt;seg_only&lt;/code&gt; 指定只分词，不输出词性&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cut_f(input, output)&lt;/code&gt; 用于对文件 &lt;code&gt;input&lt;/code&gt; 分词，并将结果保存到 &lt;code&gt;output&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;{note begin}使用 thulac 处理文件时一般会输出 &lt;code&gt;UnicodeDecodeError&lt;/code&gt; 错误，主要是读取文件时的编码错误，是 thulac 本身的一个 bug，请看下文的解决方法&lt;del&gt;（也可能官方修好了）&lt;/del&gt;。&lt;/p&gt;
&lt;p&gt;找到错误信息中的 &lt;code&gt;site-packages\thulac\__init__.py&lt;/code&gt; 文件，第 187 行与第 188 行的代码为&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-py"&gt;input_f = open(input_file, 'r')
output_f = open(output_file, 'w')
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;将其修改为&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-py"&gt;input_f = open(input_file, 'r', encoding='utf-8')
output_f = open(output_file, 'w', encoding='utf-8')
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;{note end}&lt;/p&gt;
&lt;p&gt;同样再检查一下处理的结果：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-txt"&gt;# dataset/source.txt
李密 的 意见 没有 被 采纳 。
押送 的 人 贪图 金钱 ， 便 满口答应 。
派 人 游说 小 股义军 ， 被 劝说 的 人 都 归顺 了 翟让 ， 翟让 开始 看重 了 他 ， 叫 他 同 自己 一起 讨论 重大 问题 。
宇文 温常 对 李密 说 ： 不 杀 邴元真 ， 您 的 祸害 就 不 会 排除 。

# dataset/target.txt
密 计 不 行 。
使 者 利 金 ， 遂 相 许 。
遣 说 诸 小 贼 ， 所 至 辄 降 ， 让 始 敬 焉 ， 召 与 计 事 。
宇 文 温 每 谓 密 曰 ： 不 杀 元 真 ， 公 难 未 已 。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;分词结果虽然有错误，但总体效果还可以，最后将全部文本划分为训练集与验证集。由于文本数据非常大，不适合读取后转换为列表进行操作，我写了一个划分 &lt;code&gt;.txt&lt;/code&gt; 文本的脚本，可以在 GitHub 上找到，代码不复杂，就不展开介绍了。划分数据集后的文件结构与 OpenNMT 要求的数据一致，就可以直接使用了。&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-sh"&gt;dataset
&amp;boxvr;&amp;boxh;&amp;boxh; src-train.txt
&amp;boxvr;&amp;boxh;&amp;boxh; src-val.txt
&amp;boxvr;&amp;boxh;&amp;boxh; source.txt
&amp;boxvr;&amp;boxh;&amp;boxh; source_raw.txt
&amp;boxvr;&amp;boxh;&amp;boxh; target.txt
&amp;boxvr;&amp;boxh;&amp;boxh; target_raw.txt
&amp;boxvr;&amp;boxh;&amp;boxh; tgt-train.txt
&amp;boxur;&amp;boxh;&amp;boxh; tgt-val.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id="gou-jian-ci-ku"&gt;构建词库&lt;/h3&gt;
&lt;p&gt;同样创建 &lt;code&gt;.yaml&lt;/code&gt; 配置文件，内容为&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-yaml"&gt;# wenyan.yaml

## Where the samples will be written
save_data: run/wenyan
## Where the vocab(s) will be written
src_vocab: run/wenyan.vocab.src
tgt_vocab: run/wenyan.vocab.tgt
src_vocab_size: 200000
tgt_vocab_size: 200000
overwrite: True

# Corpus opts:
data:
    corpus_1:
        path_src: dataset/src-train.txt
        path_tgt: dataset/tgt-train.txt
    valid:
        path_src: dataset/src-val.txt
        path_tgt: dataset/tgt-val.txt

# Train on a single GPU
world_size: 1
gpu_ranks: [0]
queue_size: 100
bucket_size: 2048

# Train batch
batch_size: 32
# Validation batch
valid_batch_size: 16

# Where to save the checkpoints
save_model: run/model
save_checkpoint_steps: 10000
train_steps: 1000000
valid_steps: 10000
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;queue_size&lt;/code&gt; 为读取数据的消息队列大小&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bucket_size&lt;/code&gt; 为读取数据的缓冲区大小，用于避免无法实时读取数据&lt;/li&gt;
&lt;li&gt;&lt;code&gt;batch_size&lt;/code&gt; 为训练过程中处理的批大小&lt;/li&gt;
&lt;li&gt;&lt;code&gt;valid_batch_size&lt;/code&gt; 为验证过程中处理的批大小&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class="language-sh"&gt;onmt_build_vocab -config wenyan.yaml -n_sample -1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;同样使用该命令开始构建词库，将 &lt;code&gt;-n_sample&lt;/code&gt; 指定为 &lt;code&gt;-1&lt;/code&gt; 能让模型使用整个数据集的数据构建词库。可以使用 &lt;code&gt;head run/wenyan.vocab.src&lt;/code&gt; 查看一下构建的词库：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-txt"&gt;，      2041007
。      920182
的      700401
不      279935
、      224914
了      195770
是      176242
他      175822
在      156216
说      143227
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id="xun-lian-mo-xing_1"&gt;训练模型&lt;/h3&gt;
&lt;p&gt;使用 &lt;code&gt;onmt_train -config wenyan.yaml&lt;/code&gt; 开始训练模型。&lt;/p&gt;
&lt;p&gt;由于数据集很大，训练模型需要非常长的时间，中途可能训练中断或卡死。由于在训练过程中保存了 &lt;code&gt;checkpoints&lt;/code&gt;，也不需要重头训练，可以从保存的断点继续训练。可以使用以下的自动化脚本，将其保存为 &lt;code&gt;train.py&lt;/code&gt;，就可以通过 &lt;code&gt;python train.py&lt;/code&gt; 自动继续训练。&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-py"&gt;import os

model_root = 'run/wenyan'
try:
    checkpoints = [x for x in os.listdir(model_root) if x.endswith('.pt')]
except FileNotFoundError:
    os.mkdir(model_root)
    checkpoints = [x for x in os.listdir(model_root) if x.endswith('.pt')]

last_checkpoint = None
if len(checkpoints) &amp;gt; 0:
    checkpoints = sorted(checkpoints, key=lambda x: int(x[:-3].split('_')[-1]))
    last_checkpoint = checkpoints[-1]
    last_checkpoint = os.path.join(model_root, last_checkpoint)

if last_checkpoint is not None:
    print('last_checkpoint', last_checkpoint, os.path.exists(last_checkpoint))
    if isinstance(last_checkpoint, str) and os.path.exists(last_checkpoint):
        # 中断后继续训练使用
        os.system('onmt_train -config wenyan.yaml --train_from="%s"' % last_checkpoint)
    else:
        os.system('onmt_train -config wenyan.yaml')
else:
    os.system('onmt_train -config wenyan.yaml')
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在 &lt;code&gt;.yaml&lt;/code&gt; 文件中添加 &lt;code&gt;log_file&lt;/code&gt; 可以将日志文件保存到相应目录，这里我没有添加，直接用终端中的输出数据分析。&lt;/p&gt;
&lt;p&gt;&lt;div class="lightgallery"&gt;&lt;a data-sub-html="n" href="https://storage.live.com/items/4D18B16B8E0B1EDB!8277?authkey=ALYpzW-ZQ_VBXTU" rel="noopener" target="_blank"&gt;&lt;img alt="n" src="https://storage.live.com/items/4D18B16B8E0B1EDB!8277?authkey=ALYpzW-ZQ_VBXTU"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;ACC 和 PPL 是自然语言处理中常用的指标，当然还有更好用的 BELU 等指标。可以看出训练过程收敛得非常快，PPL 迅速下降，ACC 也在第 20 个模型后保持稳定了，检查一下日志文件发现果然在第 23 个模型后学习率变成 0 了。这就说明不需要指定那么多的训练步骤，降低到 300000 可能是比较合适的。&lt;/p&gt;
&lt;h3 id="mo-xing-yu-ce_1"&gt;模型预测&lt;/h3&gt;
&lt;p&gt;那么就选最后一个模型作为最终用于预测的模型，将其他模型全部删除。&lt;/p&gt;
&lt;p&gt;{note begin}可以在 &lt;code&gt;.yaml&lt;/code&gt; 文件中通过参数 &lt;code&gt;keep_checkpoint&lt;/code&gt; 指定需要保存的模型数量，在训练过程中会自动删去多余的模型，节省存储空间。{note end}&lt;/p&gt;
&lt;p&gt;在目录中新建一个文本 &lt;code&gt;input.txt&lt;/code&gt;，写入需要翻译的语句，每行一句话：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-txt"&gt;这样的事情是很难令人相信的。
传说西北方有一座海岛，居住着神仙，留下这部书。
可惜这本书的字已经看不清了。
后来皇帝下旨找遍了天下具有智识的儒生。
命令大臣在几十年里翻遍了所有的藏书。
最后确定封面上写着《算法：C语言实现》。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;{warn begin}每句话以换行（&lt;code&gt;\n&lt;/code&gt;）分隔，注意最后一行不能有空行，否则会报错。{warn end}&lt;/p&gt;
&lt;p&gt;接着需要对输入文本分词，同样使用 &lt;code&gt;thulac&lt;/code&gt;，新建一个 &lt;code&gt;input_sep.py&lt;/code&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-py"&gt;import thulac

sep_model = thulac.thulac(seg_only=True)
sep_model.cut_f('input.txt', 'input_sep.txt')
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;运行 &lt;code&gt;python input_sep.py&lt;/code&gt; 完成分词后，使用以下命令开始翻译：&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-sh"&gt;onmt_translate --model 'run/model_final.pt' --src input_sep.txt --output output.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;使用 &lt;code&gt;cat output.txt&lt;/code&gt; 就可以看到输出了，结果非常生草🤣&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-txt"&gt;如 此 者 ， 难 信 也 。
传 西 北 有 一 海 岛 ， 居 神 仙 ， 留 此 书 。
惜 此 书 已 不 明 矣 。
后 诏 遍 遍 天 下 有 知 儒 生 。
命 大 臣 数 十 年 ， 尽 有 书 藏 。
最 后 定 上 书 《 法 术 法 》 。
&lt;/code&gt;&lt;/pre&gt;
&lt;hr/&gt;
&lt;h2 id="references_1"&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://opennmt.net/OpenNMT-py/main.html" rel="noopener" target="_blank"&gt;OpenNMT-py Documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://arabelatso.github.io/2021/01/03/OpenNMT-Doc/" rel="noopener" target="_blank"&gt;OpenNMT 2.0.0rc1 使用手册 - Arabela's Blog&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.bilibili.com/video/BV1NL4y1t73c/" rel="noopener" target="_blank"&gt;开源神经机器翻译-OpenNMT使用介绍 - 哔哩哔哩&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="碎碎念"></category><category term="OpenNMT"></category><category term="NLP"></category><category term="Python"></category></entry></feed>